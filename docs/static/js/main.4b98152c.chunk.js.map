{"version":3,"sources":["utils/colLookup.js","utils/dataFunction.js","utils/findDates.js","utils/geojsonArrayBuffer.js","utils/getArrayCSV.js","utils/getCartogramValues.js","utils/getCartogramCenter.js","utils/getCols.js","utils/getCSV.js","utils/getDataForBins.js","utils/getDataForCharts.js","utils/getDataForLisa.js","utils/getGeoidIndex.js","utils/getJson.js","utils/getJsonPure.js","utils/getCurrentWuuid.js","utils/getLisaValues.js","utils/getParseCSV.js","config/index.js","utils/getURLParams.js","utils/getVarId.js","utils/loadJson.js","utils/mapFunction.js","utils/mergeData.js","actions/index.js","components/bottomPanel.js","components/tooltip.js","components/twoWeekLineChart.js","config/svg.js","components/dataPanel.js","styled_components/index.js","components/slider.js","components/dock.js","components/draggable.js","components/infoBox.js","components/binsList.js","components/legend.js","components/mainLineChart.js","components/map.js","components/mapTooltipContent.js","components/navbar.js","components/notificationBox.js","components/variablePanel.js","components/tooltipPopper.js","components/preloader.js","components/scaleable.js","components/topPanel.js","App.js","constants/defaults.js","reducers/index.js","registerServiceWorker.js","index.js"],"names":["colLookup","columns","dataset","table","property","indexOf","dataFn","numeratorData","denominatorData","dataParams","nProperty","nIndex","nRange","dProperty","dIndex","dRange","nType","dType","scale","undefined","findDates","data","i","length","Date","parse","slice","geojsonArrayBuffer","a","arrayBuffer","getArrayCSV","url","arrToInt","arr","map","d","fetch","then","response","ok","text","Promise","reject","status","split","row","tempData","getCartogramValues","gda_proxy","cartogramData","cartogram","tempObj","value","getCartogramCenter","x","y","keys","Object","dataLength","getColumns","names","rtn","d3","getCSV","getDataForBins","tableData","numerator","denominator","n","tempIndex","tempDIndex","unshift","getDataForCharts","startIndex","dates","countCol","sumCol","name","features","j","sum","date","push","getDataForLisa","order","t0","performance","now","tempDict","tempNIndex","properties","GEOID","console","log","getGeoidIndex","geoidOrder","indexOrder","getJson","getJsonPure","responseFromJson","clone","abResponse","ab","getCurrentWuuid","selectedDataset","w","CreateQueenWeights","get_uid","getLisaValues","geoids","all_zeros","clusters","sig","lisa","local_moran","map_uuid","w_uuid","parseVecDouble","significances","joinCol","accumulate","selectedJoinColumn","forEach","colOption","hasOwnProperty","indexStart","vals","values","tempArr","getParseCSV","colorScales","fixedScales","bins","breaks","Math","pow","colors","white","black","darkgray","gray","buttongray","lightgray","yellow","lightblue","pairedColors","count","qualtitiveScale","dataPresets","plainName","geojson","csvs","joinCols","tableNames","tooltipInfo","Choropleth","NaturalBreaksFixed","NaturalBreaks","BoxMap","Hotspot","LocalMoran","NotSig","HighHigh","LowLow","HighLow","LowHigh","PovChldPrc","IncRt","MedianHouseholdIncome","FdInsPrc","UnEmplyPrc","UnInPrc","PrmPhysRt","PrevHospRt","RsiSgrBlckRt","SvrHsngPrbRt","Over65YearsPrc","AdObPrc","AdDibPrc","SmkPrc","ExcDrkPrc","DrOverdMrtRt","LfExpRt","SlfHlthPrc","SeverityIndex","PredictedDeaths","PredictedDeathsInterval","healthfactor","healthcontext","healthlife","Hypersegregated","href","target","rel","BlackBelt","TestingCapacity","USCongress","BinModes","legacyVariableOrder","legacyOverlayOrder","legacyResourceOrder","legacySourceOrder","getURLParams","params","URLmapParams","URLcurrentData","URLcurrentVariable","URLviewState","overlay","resource","variable","method","mapType","source","coords","round","latitude","longitude","zoom","vizType","getVarId","currentData","loadJson","ReadGeojsonMap","json","geoidIndex","mapFn","val","maptype","column","includes","mergeData","featureCollection","featureCollectionJoinCol","joinData","joinDataNames","joinDataCol","dataDict","colNumCheck","parseInt","Number","isInteger","cols","merged","merge","setCurrentData","type","payload","setDate","setVariableParams","setMapParams","setSelectionData","appendSelectionData","setVariableName","setAnchorEl","anchorEl","setPanelState","setNotification","info","BottomDrawer","styled","div","BottomPanel","useDispatch","panelState","useSelector","state","useState","bottomMargin","setBottomMargin","window","addEventListener","document","querySelector","offsetHeight","getChartHeight","bottom","chart","TooltipContainer","button","process","Tooltip","props","dispatch","id","onMouseEnter","event","currentTarget","onMouseLeave","LineContainer","CustomizedDot","cx","cy","index","color","angle","width","height","fill","viewBox","points","transform","TwoWeekLineChart","colorScale","domain","range","schema","delta","lineColor","start","hide","dataKey","stroke","strokeWidth","isAnimationActive","dot","pctChange","calcAngle","settings","className","r","report","rx","selectRect","DataPanelContainer","otherPanels","ReportWrapper","ReportContainer","expanded","ReportSection","span","ExpandSelect","FormControl","DataPanel","storedData","currDateIndex","startDateIndex","selectionKeys","selectionIndex","cases","deaths","predictions","chr_health_factors","chr_life","chr_health_context","testing","vaccinesAdmin","setExpanded","parsePredictedDate","list","performOperation","dataArray","operation","totalPopulation","reducer","accumulator","currentValue","reduce","aggregateProperty","specialCase","selection","selectionPop","aggregateTimeseries","aggregate2WeekTimeSeries","lookbackPeriod","day","aggregateDataFunction","variables","Select","labelId","onChange","MenuItem","key","toLocaleString","toFixed","dataObj","returnStr","aggregateQualitative","f","onClick","StyledDropDown","component","StyledDropDownNoLabel","BinsContainer","Grid","SliderContainer","PlayPauseButton","Button","LineSlider","Slider","RangeSlider","DateTitle","h3","InitialDate","p","EndDate","DateSelectorContainer","DateSlider","mapParams","currentVariable","timerId","setTimerId","customRange","setCustomRange","rangeSelectVal","setRangeSelectVal","valuetext","formatDate","rawDate","getDate","toLocaleDateString","year","month","style","display","container","spacing","padding","item","xs","InputLabel","htmlFor","displayEmpty","inputProps","disabled","null","1","7","Switch","checked","binMode","rate","interval","setInterval","o","clearInterval","handlePlayPause","newValue","tempRange","min","step","max","valueLabelDisplay","rIndex","rRange","getAriaValueText","valueLabelFormat","aria-labelledby","DockContainer","DockButton","isActive","Dock","handlePanelButton","panel","title","lineChart","tutorial","DragContainer","DragButton","CollapseButton","Draggable","open","defaultX","X","setX","defaultY","Y","setY","isDragging","setIsDragging","listener","e","prevWidth","movementX","prevHeight","movementY","touchListener","targetTouches","clientX","clientY","removeListener","removeEventListener","removeTouchListener","useEffect","left","top","zIndex","z","content","onMouseDown","onTouchStart","InfoContainer","active","PanelContainer","position","panelCount","Panel","DotsContainer","Dot","Arrow","svg","InfoBox","panelOpen","panelPosition","setPanelPosition","panels","subtitle","dangerouslySetInnerHTML","__html","prev","BinsList","splice","bin","LegendContainer","LegendTitle","BinLabels","binLength","firstBinZero","BinBars","Legend","fixedScale","backgroundColor","ChartContainer","StyledSwitch","ChartTitle","monthNames","ul","li","millionFormatter","thousandFormatter","dateFormatter","tempDate","getMonth","CustomTick","labelFormatter","getStartDate","getEndDate","CustomTooltip","background","borderRadius","boxShadow","textShadow","fontWeight","floor","MainLineChart","chartData","logChart","setLogChart","strokeOpacities","setStrokeOpacities","handleChange","rangeIncrement","maximum","increment","returnArray","parsedData","summarizedData","tempSum","summarizeChartData","maximums","array","maxVals","tempVal","getMax","dateRange","years","startDate","endDate","dateArray","getUTCFullYear","yearStr","dateString","getDateRange","margin","right","activeTooltipIndex","ticks","tick","fontSize","fontFamily","yAxisId","allowDataOverflow","marginTop","orientation","x1","x2","fillOpacity","strokeOpacity","bounds","fitBounds","innerWidth","innerHeight","hawaiiBounds","alaskaBounds","ICON_MAPPING","hospital","clinic","MAPBOX_ACCESS_TOKEN","defaultMapStyle","fromJS","MAP_STYLE","MapContainer","HoverDiv","NavInlineButton","shareNotification","MapGeocoder","Geocoder","MapButtonContainer","infoPanel","ShareURL","input","IndicatorBox","Map","View","storedGeojson","storedLisaData","storedCartogramData","urlParams","hoverInfo","setHoverInfo","highlightGeog","setHighlightGeog","mapStyle","setMapStyle","currLisaData","setCurrLisaData","lat","lon","bearing","pitch","viewState","setViewState","setViewStates","useCallback","viewId","currentViewStates","main","setCartogramData","currVarId","setCurrVarId","hospitalData","setHospitalData","clinicData","setClinicData","storedCenter","setStoredCenter","shared","setShared","multipleSelect","setMultipleSelect","choroplethInteractive","setChoroplethInteractive","boxSelect","setBoxSelect","boxSelectDims","setBoxSelectDims","SHARED_GEOID","localStorage","getItem","SHARED_VIEW","JSON","prevView","transitionDuration","transitionInterpolator","FlyToInterpolator","view","tempLayers","defaultLayers","get","layer","setIn","set","center","roundedCenter","mapRef","useRef","deckRef","handleShare","shareData","location","navigator","share","copyText","select","setSelectionRange","execCommand","setTimeout","handleMapHover","object","Layers","GeoJsonLayer","visible","pickable","stroked","filled","wireframe","extruded","opacity","material","getFillColor","GetFillColor","getElevation","scale3D","GetHeight","onHover","dataName","state_abbr","NAME","GeoidList","findIndex","setItem","stringify","current","tempArray","geogIndex","getLineColor","lineWidthScale","getLineWidth","lineWidthMinPixels","lineWidthMaxPixels","parameters","depthTest","updateTriggers","IconLayer","iconAtlas","iconMapping","getIcon","getPosition","Longitude","Latitude","sizeUnits","getSize","sizeMinPixels","sizeMaxPixels","PolygonLayer","getPolygon","ScatterplotLayer","getRadius","radius","find","TextLayer","getTextAnchor","getAlignmentBaseline","maxWidth","wordBreak","getText","GlobeView","controller","resolution","MapView","repeat","insetMap","ox","oy","removeListeners","handleBoxSelect","pageX","pageY","pickObjects","layerIds","onKeyDown","ctrlKey","shiftKey","onKeyUp","onMouseUp","layers","ref","initialViewState","dragRotate","dragPan","doubleClickZoom","touchZoom","touchRotate","keyboard","scrollZoom","views","reuseMaps","preventStyleDiffing","mapboxApiAccessToken","onViewportChange","onLoad","loaded","positionOptions","enableHighAccuracy","trackUserLocation","onGeolocate","handleGeolocate","marginBottom","transition","pointerEvents","MapTooltipContent","testing_ccpt","testing_tcap","testing_wk_pos","caseN","deathN","testingN","criteria","state_name","Address","Address_2","City","State","Zipcode","testing_status","address","city","st_abbr","phone","NavItems","NavBar","src","paddingRight","Notification","CloseTutorial","NotificationBox","notification","VariablePanelContainer","StyledButtonGroup","ButtonGroup","TwoUp","ControlsContainer","ListSubheader","VariablePanel","getGzipAndCentroids","gzipUrl","centroidsUrl","all","getGzipData","centroids","flows","storedMobilityData","PresetVariables","CountyVariables","StateVariables","var","handleVariable","tempParams","customScale","handleVizTypeButton","newDataSet","FormLabel","RadioGroup","aria-label","nBins","FormControlLabel","control","Radio","label","data-val","TooltipContentDiv","Popper","Popover","Boolean","disablePortal","modifiers","flip","enabled","preventOverflow","boundariesElement","PreloaderContainer","Preloader","isHidden","setIsHidden","alt","ResizeButton","notScaleable","Scaleable","defaultWidth","setWidth","defaultHeight","setHeight","currXYPos","setCurrXYPos","minHeight","minWidth","parentNode","TopDrawer","TopPanel","App","defaultXLong","defaultWidthLong","mapLoaded","set_gda_proxy","loadData","csvPromises","csv","result","ColNames","tempDates","binData","nb","custom_breaks","load","storeData","columnNames","storeGeojson","currDate","variableParams","binIndex","updateBins","paramsDict","queryString","search","URLSearchParams","decodeURI","jsgeoda","geoda","newGeoda","dateIndex","tempId","storeCartogramData","INITIAL_STATE","geodaProxy","storedCSV","currentMethod","currentOverlay","currentResource","activeGeoid","storedRange","currentGeoid","sidebarData","action","colDataObj","geoDataObj","mapParamsDataObj","datesDataObj","variableParamsDataObj","panelsDataObj","variableParamsExDataObj","panelsExDataObj","binsVariableParams","binsMapParams","geoid","obj","geojsonObj","lisaObj","cartoObj","centroidsObj","proxy","datesObj","currentDataFn","fn","colObj","binsObj","use3D","dateObj","paramObj","storedIndex","mapParamObj","panelsObj","appendedChartData","appendedSelectionNames","appendedSelectionIndex","removedSelectionNames","tempRemoveIndex","removedSelectionIndex","urlMapParamsObj","isLocalhost","hostname","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","catch","error","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","WebFont","google","families","ReactDOM","render","getElementById","URL","origin","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.4b98152c.chunk.js","sourcesContent":["const colLookup = (columns, dataset, table, property) => {\r\n    try {\r\n        return columns[dataset][table].indexOf(property); \r\n    } catch {\r\n        return null;\r\n    }\r\n}\r\nexport default colLookup;","// branchless variant\r\n// const dataFn = (numeratorData, numeratorProperty, index, range, denominatorData, denominatorProperty, denominatorIndex, denominatorRange, scale)  => {\r\n\r\nimport { min } from \"lodash\";\r\n\r\n//     return (\r\n//       (\r\n//         (\r\n//           (\r\n//             (numeratorData[index]||numeratorData[numeratorProperty])\r\n//             -\r\n//             ((range!==null)&&(numeratorData[index-range]))\r\n//           )\r\n          \r\n//           /\r\n//           (range+(range===null))\r\n//         )\r\n//       /\r\n//         (\r\n//           (\r\n//             (\r\n//               (denominatorData[denominatorIndex]||denominatorData[denominatorProperty])\r\n//               -\r\n//               ((denominatorRange!==null)&&(denominatorData[denominatorIndex-denominatorRange]))\r\n//             )\r\n//             /\r\n//             (denominatorRange+(denominatorRange===null))\r\n//           )\r\n//           ||\r\n//             (denominatorData[denominatorProperty])\r\n//           || \r\n//           1\r\n//         )\r\n//       )\r\n//       *\r\n//       scale\r\n//     )\r\n// }\r\n\r\n// export default dataFn;\r\n\r\nconst dataFn = (numeratorData, denominatorData, dataParams)  => {\r\n  const { \r\n    nProperty, nIndex, nRange,\r\n    dProperty, dIndex, dRange, \r\n    nType, dType,\r\n    scale\r\n  } = dataParams;\r\n  \r\n  if (numeratorData === undefined) {\r\n    return null;\r\n  } else if ((nProperty !== null && numeratorData[nProperty] === undefined) && (nIndex !== null && numeratorData[nIndex] === undefined)){\r\n    return null;\r\n  } else if (nType ==='time-series' && dType === 'time-series') {\r\n    if (nRange === null & dRange === null) {\r\n      return (\r\n        (numeratorData[nIndex])\r\n        /\r\n        (denominatorData[dIndex])\r\n        *scale   \r\n      )\r\n\r\n    } else {\r\n      return (\r\n        ((numeratorData[nIndex]-numeratorData[nIndex-nRange])/nRange)\r\n        /\r\n        ((denominatorData[dIndex]-denominatorData[dIndex-dRange])/dRange)\r\n        *scale   \r\n      )\r\n    }\r\n  } else if (dProperty===null&&nRange===null){ // whole count or number -- no range, no normalization\r\n    return (numeratorData[nProperty]||numeratorData[nIndex])*scale\r\n  } else if (dProperty===null&&nRange!==null){ // range number, daily or weekly count -- no normalization\r\n    return (numeratorData[nIndex]-numeratorData[nIndex-nRange])/nRange*scale\r\n  } else if (dProperty!==null&&nRange===null){ // whole count or number normalized -- no range\r\n    return (numeratorData[nProperty]||numeratorData[nIndex])/(denominatorData[dProperty]||denominatorData[dIndex])*scale\r\n  } else if (dProperty!==null&&nRange!==null&&dRange===null){ // range number, daily or weekly count, normalized to a single value\r\n    return (\r\n      (numeratorData[nIndex]-numeratorData[nIndex-nRange])/nRange)/(denominatorData[dProperty]||denominatorData[dIndex]\r\n        )*scale\r\n  // } else if (dProperty!==null&&nRange!==null&&dRange!==null){ // range number, daily or weekly count, normalized to a range number, daily or weekly count\r\n  //   console.log('getting the right col')\r\n  //   return (\r\n  //     (numeratorData[nIndex]-numeratorData[nIndex-nRange])/nRange)\r\n  //     /\r\n  //     ((denominatorData[dIndex]-denominatorData[dIndex-dIndex])/dIndex)\r\n  //     *scale\r\n  } else {      \r\n    return 0;\r\n  }\r\n}\r\n\r\nexport default dataFn;","const findDates = (data) => {\r\n    for (let i = 0; i < data.length; i++) {\r\n      if (Date.parse(data[i])) return [data.slice(i,),i]\r\n    }\r\n    return;\r\n}\r\n\r\nexport default findDates","const geojsonArrayBuffer = async (data) => {\r\n    const arrayBuffer = await data.arrayBuffer()\r\n\r\n    return arrayBuffer;\r\n}\r\n\r\nexport default geojsonArrayBuffer;","const getArrayCSV = async (url) => {\r\n    const arrToInt = (arr) => arr.map(d => +d);\r\n    const tempData = await fetch(url).then(response => {\r\n            return response.ok ? response.text() : Promise.reject(response.status);\r\n        }).then(data => {\r\n            let rows = data.split(\"\\n\");\r\n            return rows.map(row => arrToInt(row.split(\",\")))\r\n        })\r\n\r\n    return tempData;\r\n}\r\n\r\nexport default getArrayCSV","const getCartogramValues = (gda_proxy, dataset, data ) => {\r\n    let cartogramData = gda_proxy.cartogram(dataset, data)\r\n    let tempObj = {}\r\n    for (let i=0; i<cartogramData.length; i++){\r\n        cartogramData[i].value = data[i]\r\n        tempObj[i] = cartogramData[i]\r\n    }\r\n    return tempObj;\r\n}\r\n\r\nexport default getCartogramValues;","const getCartogramCenter = (cartogramData) => {\r\n    let x = 0;\r\n    let y = 0;\r\n    let keys = Object.keys(cartogramData)\r\n    let dataLength = keys.length\r\n\r\n    for (let i=0; i<dataLength; i++) {\r\n        x += cartogramData[keys[i]]['position'][0];\r\n        y += cartogramData[keys[i]]['position'][1];\r\n    };\r\n    return [x/dataLength, y/dataLength]\r\n}\r\n\r\nexport default getCartogramCenter;","const getColumns = (data, names) => {\r\n    let rtn = {};\r\n\r\n    for (let i=0; i < data.length; i++) {\r\n        rtn[names[i]] = data[i][1]\r\n    }\r\n\r\n    return rtn;\r\n}\r\n\r\nexport default getColumns;","import * as d3 from 'd3-dsv';\r\n\r\nasync function getCSV(url){\r\n    const tempData = await fetch(url)\r\n      .then(response => {\r\n        return response.ok ? response.text() : Promise.reject(response.status);\r\n      }).then(text => {\r\n        let data = d3.csvParse(text, d3.autoType)\r\n        \r\n        return data\r\n      })\r\n    \r\n      return tempData\r\n}\r\n\r\nexport default getCSV","import dataFn from './dataFunction';\r\n// this function loops through the current data set and provides data for GeodaJS to create custom breaks \r\nconst getDataForBins = (tableData, dataParams) => {\r\n\r\n    const { numerator, nProperty, nIndex, denominator, dType, dIndex} = dataParams;\r\n    if (tableData[0][denominator] == undefined) return;\r\n    // declare empty array for return variables\r\n    let rtn = [];\r\n\r\n    // length of data table to loop through\r\n    let n = tableData.length;\r\n\r\n    // this checks if the bins generated should be dynamic (generating for each date) or fixed (to the most recent date)\r\n    if (nIndex === null && nProperty === null) {\r\n        // if fixed, get the most recent date\r\n        let tempIndex = tableData[0][numerator].length-1;\r\n        // if the denominator is time series data (eg. deaths / cases this week), make the indices the same (most recent)\r\n        let tempDIndex = dType === 'time-series' ? tableData[0][denominator].length-1 : dIndex;\r\n        // loop through, do appropriate calculation. add returned value to rtn array\r\n        while (n>0) {\r\n            n--;\r\n            rtn.unshift(dataFn(tableData[n][numerator], tableData[n][denominator], {...dataParams, nIndex:tempIndex, dIndex: tempDIndex})||0)\r\n        }\r\n    } else {\r\n       while (n>0) {\r\n            n--;\r\n            rtn.unshift(dataFn(tableData[n][numerator], tableData[n][denominator], dataParams)||0)\r\n        }\r\n    }\r\n    return rtn;   \r\n}\r\nexport default getDataForBins","const getDataForCharts = (data, table, startIndex, dates, name=null) => {\r\n    let features = Object.keys(data);\r\n    let n = startIndex;\r\n    let rtn = []\r\n    let j = -7;\r\n\r\n    let countCol;\r\n    let sumCol;\r\n    \r\n    if (name===null) {\r\n        countCol = 'count'\r\n        sumCol = 'sum'\r\n    } else {\r\n        countCol = name + ' Daily Count'\r\n        sumCol = name + ' Total Cases'\r\n    }\r\n    \r\n    while (n<data[features[0]][table].length) {\r\n        let tempObj = {};\r\n        let sum = 0;\r\n        let i = 0;\r\n\r\n        while (i<features.length) {\r\n            if (data[features[i]][table]!== undefined) sum += data[features[i]][table][n]\r\n            // tempObj[`n${i}`] = data[features[i]][table][n]\r\n            i++;\r\n        }\r\n        tempObj[sumCol] = sum\r\n        // dates[n-startIndex]\r\n        tempObj.date = dates[n-startIndex]\r\n        if (j<0) {\r\n            tempObj[countCol] = sum\r\n        } else {\r\n            tempObj[countCol] = (sum - rtn[j][sumCol])/7\r\n        }\r\n        rtn.push(tempObj);\r\n        n++;\r\n        j++;\r\n    }\r\n    \r\n    return rtn;\r\n\r\n}\r\n\r\nexport default getDataForCharts","import dataFn from './dataFunction';\r\n\r\n// this function loops through the current data set and provides data for GeodaJS to create custom breaks \r\nconst getDataForLisa = (tableData, dataParams, order) => {\r\n    let t0 = performance.now() // logging performance\r\n    \r\n    const { numerator, nProperty, nIndex, denominator, dType, dIndex} = dataParams;\r\n\r\n    // declare empty array for return variables\r\n    let tempDict = {};\r\n\r\n    // length of data table to loop through\r\n    let n = tableData.length;\r\n\r\n    // this checks if the bins generated should be dynamic (generating for each date) or fixed (to the most recent date)\r\n    if (nIndex === null && nProperty === null) {\r\n        // if fixed, get the most recent date\r\n        let tempNIndex = tableData[0][denominator].length-1;\r\n        \r\n        // if the denominator is time series data (eg. deaths / cases this week), make the indices the same (most recent)\r\n        let tempDIndex = dType === 'time-series' ? tableData[0][denominator].length-1 : dIndex;\r\n\r\n        // loop through, do appropriate calculation. add returned value to rtn array\r\n        while (n>0) {\r\n            n--;\r\n            tempDict[tableData[n].properties.GEOID] = dataFn(tableData[n][numerator], tableData[n][denominator], {...dataParams, nIndex:tempNIndex, dIndex: tempDIndex})||0\r\n        }\r\n    } else {\r\n       while (n>0) {\r\n            n--;\r\n            tempDict[tableData[n].properties.GEOID] = dataFn(tableData[n][numerator], tableData[n][denominator], dataParams)||0\r\n        }\r\n    }\r\n    \r\n    let rtn = [];\r\n\r\n    n = 0;\r\n    let keys = Object.keys(order)\r\n    while (n<keys.length) {\r\n        rtn.push(tempDict[order[keys[n]]]);\r\n        n++;\r\n    }\r\n\r\n    console.log(performance.now() - t0);\r\n\r\n    return rtn;\r\n    \r\n}\r\nexport default getDataForLisa","const getGeoidIndex = (features) => {\r\n    let geoidOrder = {};\r\n    let indexOrder = {};\r\n    let i = 0\r\n    while (i<features.length) {\r\n        geoidOrder[features[i].properties.GEOID] = i\r\n        indexOrder[i] = features[i].properties.GEOID\r\n        i++;\r\n    }\r\n\r\n    return {geoidOrder, indexOrder};\r\n}\r\nexport default getGeoidIndex","import { getJsonPure, geojsonArrayBuffer } from '../utils';\r\n\r\n// async function getJson(url, gda_proxy){\r\n//     const tempData = await fetch(url).then(response => {\r\n//       const responseFromJson = response.clone();        \r\n//       const data = loadGeojsonToGeoda(responseFromJson, url, gda_proxy).then(\r\n//         () =>\r\n//           {\r\n//             return response.json()\r\n//           }\r\n//       )\r\n//       return data;\r\n//     }).then(data => {\r\n//       console.log('loaded json')\r\n//       return {\r\n//         data: data,\r\n//         geoidIndex: getGeoidIndex(data.features)\r\n//       }\r\n//     });        \r\n//     return tempData;\r\n// }\r\n\r\nconst getJson = async (url) => {\r\n  const response = await getJsonPure(url)\r\n  const responseFromJson = response.clone();        \r\n  const abResponse = await geojsonArrayBuffer(responseFromJson);\r\n  return { response, ab: abResponse }\r\n}\r\n\r\nexport default getJson;\r\n","const getJsonPure = async (url) => {\r\n    const tempData = await fetch(url).then(response => {\r\n      return response //.json();\r\n    })      \r\n    return tempData;\r\n}\r\n\r\nexport default getJsonPure;","const getCurrentWuuid = (gda_proxy, selectedDataset) => {\r\n    var w = gda_proxy.CreateQueenWeights(selectedDataset, 1, 0, 0);\r\n\r\n    return {\r\n      'map_uuid': selectedDataset,\r\n      'w': w,\r\n      'w_uuid': w.get_uid()\r\n    };\r\n}\r\n\r\nexport default getCurrentWuuid","import getCurrentWuuid from './getCurrentWuuid.js';\r\n\r\nconst getLisaValues = (gda_proxy, dataset, data, geoids) => {\r\n  let w = getCurrentWuuid(gda_proxy, dataset);\r\n  let all_zeros = true;\r\n  for (let i=0; i<data.length; ++i) { \r\n    if (data[i] !== 0)\r\n      all_zeros = false;\r\n  }\r\n  let clusters = [];\r\n  let sig = [];\r\n\r\n  if (all_zeros) {\r\n    for (let i=0; i<data.length; ++i) { \r\n      clusters.push(0);\r\n      sig.push(0);\r\n    }\r\n  } else {\r\n    var lisa = gda_proxy.local_moran(w.map_uuid, w.w_uuid, data);\r\n    clusters = gda_proxy.parseVecDouble(lisa.clusters());\r\n    sig = gda_proxy.parseVecDouble(lisa.significances());\r\n  }\r\n  console.log(w.w_uuid)\r\n  console.log(w.map_uuid)\r\n  return clusters;\r\n}\r\n\r\nexport default getLisaValues;","import * as d3 from 'd3-dsv';\r\nimport { findDates } from '../utils';\r\n\r\nasync function getParseCSV(url, joinCol, accumulate){\r\n    const tempData = await fetch(url)\r\n      .then(response => {\r\n        return response.ok ? response.text() : Promise.reject(response.status);\r\n      }).then(text => {\r\n        let data = d3.csvParse(text, d3.autoType)\r\n        let rtn = {};\r\n        let n = data.length;\r\n        let selectedJoinColumn;\r\n        \r\n        joinCol.forEach(colOption => {\r\n          if (data[0].hasOwnProperty(colOption)) selectedJoinColumn = colOption;\r\n        })\r\n\r\n        if (accumulate) {\r\n          let indexStart = findDates(Object.keys(data[0]))[1]\r\n          while (n>0){\r\n            n--;\r\n            let vals = Object.values(data[n])\r\n            let tempArr = [];\r\n            let i = indexStart;\r\n            let j = 0;\r\n            while (i<vals.length) {\r\n              if (i===indexStart) {\r\n                tempArr.push(vals[i])\r\n              } else {\r\n                tempArr.push(vals[i]+tempArr[j])\r\n                j++;\r\n              }\r\n              i++;\r\n            }\r\n            for (let i = 0; i < indexStart; i++) {\r\n              tempArr.unshift(vals[i])\r\n            }\r\n            rtn[data[n][selectedJoinColumn]] = tempArr\r\n          }\r\n        } else {\r\n          while (n>0){\r\n            n--;\r\n            rtn[data[n][selectedJoinColumn]] = Object.values(data[n])\r\n          }\r\n        }\r\n        return [rtn, Object.keys(data[0])]\r\n      });\r\n    return tempData;\r\n}\r\n\r\nexport default getParseCSV","export const colorScales = {\r\n    'natural_breaks': [\r\n        [240,240,240],\r\n        [255,255,204],\r\n        [255,237,160],\r\n        [254,217,118],\r\n        [254,178,76],\r\n        [253,141,60],\r\n        [252,78,42],\r\n        [227,26,28],\r\n        [177,0,38],\r\n    ],\r\n    'lisa': [\r\n        [255,255,255],\r\n        [255,0,0],\r\n        [0,0,255],\r\n        [167, 173, 249],\r\n        [244, 173, 168],\r\n        // [70, 70, 70],\r\n        // [153, 153, 153]\r\n    ],\r\n    'hinge15_breaks': [\r\n        [1, 102, 94],\r\n        [90, 180, 172],\r\n        [199, 234, 229],\r\n        [246, 232, 195],\r\n        [216, 179, 101],\r\n        [140, 81, 10],\r\n    ],    \r\n    'uninsured':[\r\n        [240,240,240],\r\n        [247,252,253],\r\n        [224,236,244],\r\n        [191,211,230],\r\n        [158,188,218],\r\n        [140,150,198],\r\n        [140,107,177],\r\n        [136,65,157],\r\n        [129,15,124],\r\n        // [77,0,75],\r\n      ],\r\n    'over65':[\r\n        [240,240,240],\r\n        [247,252,240],\r\n        [224,243,219],\r\n        [204,235,197],\r\n        [168,221,181],\r\n        [123,204,196],\r\n        [78,179,211],\r\n        [43,140,190],\r\n        [8,104,172],\r\n        // [8,64,129],\r\n    ],\r\n    'lifeExp':[\r\n        [240,240,240],\r\n        [247,252,240],\r\n        [224,243,219],\r\n        [204,235,197],\r\n        [168,221,181],\r\n        [123,204,196],\r\n        [78,179,211],\r\n        [43,140,190],\r\n        [8,104,172],\r\n        // [8,64,129],\r\n    ],\r\n    'forecasting': [\r\n        [239, 239, 239],\r\n        [254,232,200],\r\n        [253,187,132],\r\n        [227,74,51],\r\n    ],\r\n    'testing' : [\r\n        [240,240,240],\r\n        [13,8,135],\r\n        [92,1,166],\r\n        [156,23,158],\r\n        [203,70,121],\r\n        [237,121,83],\r\n        [253,180,47],\r\n        [240,249,33],\r\n      ],\r\n      'testingCap':[\r\n        [240,240,240],\r\n        [247,251,255],\r\n        [222,235,247],\r\n        [198,219,239],\r\n        [158,202,225],\r\n        [107,174,214],\r\n        [66,146,198],\r\n        [33,113,181],\r\n        [8,81,156],\r\n        [8,48,107],\r\n      ],\r\n      'vaccination':[\r\n        [240,240,240],\r\n        [252, 251, 253],\r\n        [238, 236, 245],\r\n        [217, 216, 234],\r\n        [188, 188, 219],\r\n        [158, 155, 201],\r\n        [129, 123, 185],\r\n        [106, 81, 164],\r\n        [84, 40, 143],\r\n      ]\r\n}\r\n\r\nexport const fixedScales = {\r\n    'testing': {\r\n        bins: ['No Data','<3%','5%','10%','15%','20%','>25%'],\r\n        breaks:[0,.03,.05,.10,.15,.20,.25,Math.pow(10, 12)]\r\n    },\r\n    'testingCap': {\r\n        bins: ['No Data','<50','100','150','200','250','300','350','>400'],\r\n        breaks:[0,50,100,150,200,250,300,350,400,Math.pow(10, 12)]\r\n    },\r\n    'lisa':{\r\n        bins: [\"Not significant tooltip:NotSig\", \"High-High tooltip:HighHigh\", \"Low-Low tooltip:LowLow\", \"Low-High  tooltip:LowHigh\", \"High-Low  tooltip:HighLow\"] //\"Undefined\", \"Isolated\"\r\n    },\r\n    'forecasting': {\r\n        bins: ['N/A','Low', 'Medium', 'High'],\r\n        breaks:[1,2,3,4]\r\n\r\n    }\r\n}\r\n\r\nexport const colors = {\r\n    white: '#ffffff',\r\n    black: '#00000',\r\n    darkgray:'#1a1a1a',\r\n    gray:'#2b2b2b',\r\n    buttongray: '#f5f5f5',\r\n    lightgray: '#d8d8d8',\r\n    yellow: '#FFCE00',\r\n    lightblue: '#A1E1E3',\r\n    pairedColors: {\r\n        count: [\r\n            '#1f78b4',\r\n            '#33a02c',\r\n            '#e31a1c',\r\n            '#ff7f00',\r\n            '#6a3d9a',\r\n            '#b15928'\r\n        ],\r\n        sum: [\r\n            '#a6cee3',\r\n            '#b2df8a',\r\n            '#fb9a99',\r\n            '#fdbf6f',\r\n            '#cab2d6',\r\n            '#ffff99'\r\n        ]\r\n    },\r\n    qualtitiveScale: [\r\n        '#8dd3c7',\r\n        '#ffffb3',\r\n        '#bebada',\r\n        '#fb8072',\r\n        '#80b1d3',\r\n        '#fdb462',\r\n        '#b3de69',\r\n        '#fccde5',\r\n        '#d9d9d9',\r\n        '#bc80bd',\r\n        '#ccebc5',\r\n        '#ffed6f',\r\n    ]\r\n}\r\n\r\nexport const defaultData = 'county_usfacts.geojson';\r\n\r\nexport const dataPresets = {\r\n    'county_usfacts.geojson': {\r\n        plainName: 'USA Facts County',\r\n        geojson: 'county_usfacts.geojson', \r\n        csvs: ['covid_confirmed_usafacts','covid_deaths_usafacts', 'berkeley_predictions', 'chr_health_context', 'chr_life', 'chr_health_factors'], \r\n        joinCols: ['GEOID', ['FIPS','fips','countyFIPS']], \r\n        tableNames: ['cases','deaths', 'predictions', 'chr_health_context', 'chr_life', 'chr_health_factors',],\r\n        accumulate: []\r\n    },\r\n    'county_1p3a.geojson': {\r\n        plainName: '1Point3Acres County',\r\n        geojson: 'county_1p3a.geojson', \r\n        csvs: ['covid_confirmed_1p3a','covid_deaths_1p3a', 'berkeley_predictions', 'chr_health_context', 'chr_life', 'chr_health_factors'], \r\n        joinCols: ['GEOID', ['FIPS','fips','countyFIPS', 'GEOID']], \r\n        tableNames: ['cases','deaths', 'predictions', 'chr_health_context', 'chr_life', 'chr_health_factors'],\r\n        accumulate: ['covid_confirmed_1p3a','covid_deaths_1p3a']\r\n    },\r\n    'county_nyt.geojson': {\r\n        plainName: 'New York Times County',\r\n        geojson: 'county_nyt.geojson', \r\n        csvs: ['covid_confirmed_nyt', 'covid_deaths_nyt', 'berkeley_predictions', 'chr_health_context', 'chr_life', 'chr_health_factors'], \r\n        joinCols: ['GEOID', ['FIPS','fips','countyFIPS']], \r\n        tableNames: ['cases', 'deaths', 'predictions', 'chr_health_context', 'chr_life', 'chr_health_factors'],\r\n        accumulate: []\r\n    },\r\n    'state_1p3a.geojson': {\r\n        plainName: '1Point3Acres State',\r\n        geojson: 'state_1p3a.geojson', \r\n        csvs: ['covid_confirmed_1p3a_state','covid_deaths_1p3a_state', 'chr_health_context_state', 'chr_life_state', 'chr_health_factors_state', 'covid_testing_1p3a_state', 'covid_wk_pos_1p3a_state', 'covid_tcap_1p3a_state', 'covid_ccpt_1p3a_state', 'vaccine_admin_cdc_1p3a_state', 'vaccine_dist_cdc_1p3a_state'], \r\n        joinCols: ['GEOID', ['FIPS','fips','countyFIPS', 'GEOID']], \r\n        tableNames: ['cases', 'deaths', 'chr_health_context', 'chr_life', 'chr_health_factors', 'testing', 'testing_wk_pos', 'testing_tcap', 'testing_ccpt', 'vaccinesAdmin', 'vaccinesDist'],\r\n        accumulate: ['covid_confirmed_1p3a_state','covid_deaths_1p3a_state']\r\n    },\r\n    'state_usafacts.geojson': {\r\n        plainName: 'USA Facts State',\r\n        geojson: 'state_usafacts.geojson', \r\n        csvs: ['covid_confirmed_usafacts_state','covid_deaths_usafacts_state', 'chr_health_context_state', 'chr_life_state', 'chr_health_factors_state', 'covid_testing_usafacts_state', 'covid_wk_pos_usafacts_state', 'covid_tcap_usafacts_state', 'covid_ccpt_usafacts_state'], \r\n        joinCols: ['GEOID', ['FIPS','fips','stateFIPS']], \r\n        tableNames: ['cases', 'deaths', 'chr_health_context', 'chr_life', 'chr_health_factors', 'testing', 'testing_wk_pos', 'testing_tcap', 'testing_ccpt'],\r\n        accumulate: []\r\n    },\r\n    'state_nyt.geojson': {\r\n        plainName: 'New York Times State',\r\n        geojson: 'state_nyt.geojson', \r\n        csvs: ['covid_confirmed_nyt_state','covid_deaths_nyt_state', 'chr_health_context_state', 'chr_life_state', 'chr_health_factors_state', 'covid_testing_1p3a_state', 'covid_wk_pos_1p3a_state', 'covid_tcap_1p3a_state', 'covid_ccpt_1p3a_state', 'vaccine_admin_cdc_nyt_state', 'vaccine_dist_cdc_nyt_state'], \r\n        joinCols: ['GEOID', ['FIPS','fips','countyFIPS']], \r\n        tableNames: ['cases', 'deaths', 'chr_health_context', 'chr_life', 'chr_health_factors', 'testing', 'testing_wk_pos', 'testing_tcap', 'testing_ccpt','vaccinesAdmin', 'vaccinesDist'],\r\n        accumulate: []\r\n    },\r\n    'global_jhu.geojson': {\r\n        plainName: 'John Hopkins University (Global)',\r\n        geojson: 'global_jhu.geojson', \r\n        csvs: ['covid_confirmed_jhu','covid_deaths_jhu'], \r\n        joinCols: ['GEOID', ['UID']], \r\n        tableNames: ['cases', 'deaths'],\r\n        accumulate: []\r\n    },\r\n    'cdc.geojson': {\r\n        plainName: 'Center for Disease Control County',\r\n        geojson: 'cdc.geojson', \r\n        csvs: ['covid_confirmed_cdc','covid_deaths_cdc', 'chr_health_context', 'chr_life', 'chr_health_factors', 'covid_testing_cdc', 'covid_wk_pos_cdc', 'covid_tcap_cdc', 'covid_ccpt_cdc'], \r\n        joinCols: ['GEOID', ['FIPS']], \r\n        tableNames: ['cases', 'deaths', 'chr_health_context', 'chr_life', 'chr_health_factors', 'testing', 'testing_wk_pos', 'testing_tcap', 'testing_ccpt'],\r\n        accumulate: []\r\n    }\r\n}\r\n\r\nexport const tooltipInfo = {\r\n  Choropleth: <p>A thematic map used to represent data through various shading patterns on predetermined geographic areas (counties, state).</p>,\r\n  NaturalBreaksFixed: <p>A nonlinear algorithm used to group observations such that the within-group homogeneity is maximized for the latest date, bins fixed over time</p>,\r\n  NaturalBreaks: <p>A nonlinear algorithm used to group observations such that the within-group homogeneity is maximized for every day, bins change over time</p>,\r\n  BoxMap: <p>Mapping counterpart of the idea behind a box plot</p>,\r\n  Hotspot: <p>A map showing statisically significant spatial cluster and outlier locations, color coded by type.</p>,\r\n  LocalMoran: <p>Local Moran used to identify local clusters and outliers</p>,\r\n  NotSig:\t<p>Area was not statistically signficant as a spatial cluster core or outlier using given parameters.</p>,\r\n  HighHigh: <p>Hot Spot Cluster: area with high values, neighbored by areas with high values</p>,\r\n  LowLow: <p>Cold Spot Cluster: area with low values, neighbored by areas with low values</p>,\r\n  HighLow: <p>Hot Outlier: area with high values, neighbored by areas with low values</p>,\r\n  LowHigh: <p>Low-High\tCold Outlier: area with low values, neighbored by areas with high values</p>,\r\n  PovChldPrc: <p>Percentage of children under age 18 living in poverty</p>,\r\n  IncRt: <p>Ratio of household income at the 80th percentile to income at the 20th percentile</p>,\r\n  MedianHouseholdIncome: <p>The income where half of households in a county earn more and half of households earn less</p>,\r\n  FdInsPrc: <p>Percentage of population who lack adequate access to food</p>,\r\n  UnEmplyPrc: <p>Percentage of population age 16 and older unemployed but seeking work</p>,\r\n  UnInPrc: <p>Percentage of people under age 65 without insurance</p>,\r\n  PrmPhysRt: <p>Ratio of population to primary care physicians</p>,\r\n  PrevHospRt: <p>Rate of hospital stays for ambulatory-care sensitive conditions per 100,000 Medicare enrollees</p>,\r\n  RsiSgrBlckRt: <p>Index of dissimilarity where higher values indicate greater residential segregation between Black and White county residents</p>,\r\n  SvrHsngPrbRt: <p>Percentage of households with at least 1 of 4 housing problems: overcrowding, high housing costs, lack of kitchen facilities, or lack of plumbing facilities</p>,\r\n  Over65YearsPrc: <p>Percentage of people ages 65 and older</p>,\r\n  AdObPrc: <p>Percentage of the adult population (age 20 and older) that reports a body mass index (BMI) greater than or equal to 30 kg/m2</p>,\r\n  AdDibPrc: <p>Percentage of adults aged 20 and above with diagnosed diabetes</p>,\r\n  SmkPrc: <p>Percentage of adults who are current smokers</p>,\r\n  ExcDrkPrc: <p>Percentage of adults reporting binge or heavy drinking</p>,\r\n  DrOverdMrtRt: <p>Number of drug poisoning deaths per 100,000 population</p>,\r\n  LfExpRt: <p>Average number of years a person can expect to live</p>,\r\n  SlfHlthPrc: <p>Percentage of adults reporting fair or poor health</p>,\r\n  SeverityIndex: <p>Indicates the severity of the local covid-19 outbreak, based on cumulative and predicted deaths</p>,\r\n  PredictedDeaths: <p>Predicted number of deaths for a county</p>,\r\n  PredictedDeathsInterval: <p>Margin of error for predicted death counts for a county </p>,\r\n  healthfactor:<p>Health factors represent those things we can modify to improve community conditions and the length and quality of life for residents</p>,\r\n  healthcontext: <p>Community Health Context reflects the existing health behaviors and demographics of individuals in the community that are influenced by the opportunities to live long and well</p>,\r\n  healthlife:<p>Length and Quality of Life reflects the physical and mental well-being of residents within a community through measures representing how long and how well residents live</p>,\r\n  Hypersegregated: <p>American metropolitan areas where black residents experience hypersegregation, see <a href=\"https://www.princeton.edu/news/2015/05/18/hypersegregated-cities-face-tough-road-change\" target=\"_blank\" rel=\"noopener noreferrer\">here</a></p>,\r\n  BlackBelt: <p>Southern US counties that were at least 40% Black or African American in the 2000 Census, see <a href=\"https://en.wikipedia.org/wiki/Black_Belt_in_the_American_South\" target=\"_blank\" rel=\"noopener noreferrer\">here</a></p>,\r\n  TestingCapacity: <p>New screening (e.g., antigen) and diagnostic (e.g., PCR) testing per capita rates by date. The suggested threshold is >150 daily tests per 100k people.</p>,\r\n  USCongress: <p>Find your representative <a href=\"https://www.govtrack.us/\" target=\"_blank\" rel=\"noopener noreferrer\">here</a></p>,\r\n  BinModes: <p>Fixed bins represent data relative to the most recent date and show a consistent color scale.<br/> Dynamic bins change over time and generate new color scales based on the selected date.</p>\r\n};\r\n\r\nexport const legacyVariableOrder = {\r\n    'state_usafacts.geojson': [\r\n        'Confirmed Count',\r\n        'Confirmed Count per 100K Population',\r\n        'Confirmed Count per Licensed Bed',\r\n        'Death Count',\r\n        'Death Count per 100K Population',\r\n        'Death Count/Confirmed Count',\r\n        'Daily New Confirmed Count',\r\n        'Daily New Confirmed Count per 100K Pop',\r\n        '7-Day Average Daily New Confirmed Count',\r\n        '7-Day Average Daily New Confirmed Count per 100K Pop',\r\n        'Daily New Death Count',\r\n        'Daily New Death Count per 100K Pop',\r\n        'Forecasting (5-Day Severity Index)',\r\n        '7 Day Testing Positivity Rate %',\r\n        '7 Day Testing Capacity',\r\n        '7 Day Confirmed Cases per Testing %',\r\n    ],      \r\n    'county_1p3a.geojson': [\r\n        'Confirmed Count',\r\n        'Confirmed Count per 100K Population',\r\n        'Confirmed Count per Licensed Bed',\r\n        'Death Count',\r\n        'Death Count per 100K Population',\r\n        'Death Count/Confirmed Count',\r\n        'Daily New Confirmed Count',\r\n        'Daily New Confirmed Count per 100K Pop',\r\n        '7-Day Average Daily New Confirmed Count',\r\n        '7-Day Average Daily New Confirmed Count per 100K Pop',\r\n        'Daily New Death Count',\r\n        'Daily New Death Count per 100K Pop',\r\n        'Forecasting (5-Day Severity Index)',\r\n        'Uninsured % (Community Health Factor)',\r\n        'Over 65 Years % (Community Health Context)',\r\n        'Life expectancy (Length and Quality of Life)'\r\n    ],\r\n    'county_usfacts.geojson': [\r\n        'Confirmed Count',\r\n        'Confirmed Count per 100K Population',\r\n        'Confirmed Count per Licensed Bed',\r\n        'Death Count',\r\n        'Death Count per 100K Population',\r\n        'Death Count/Confirmed Count',\r\n        'Daily New Confirmed Count',\r\n        'Daily New Confirmed Count per 100K Pop',\r\n        '7-Day Average Daily New Confirmed Count',\r\n        '7-Day Average Daily New Confirmed Count per 100K Pop',\r\n        'Daily New Death Count',\r\n        'Daily New Death Count per 100K Pop',\r\n        'Forecasting (5-Day Severity Index)',\r\n        'Uninsured % (Community Health Factor)',\r\n        'Over 65 Years % (Community Health Context)',\r\n        'Life expectancy (Length and Quality of Life)'\r\n    ]\r\n}\r\n\r\nexport const legacyOverlayOrder = [\r\n    'native_american_reservations',\r\n    'segregated_cities',\r\n    'blackbelt',\r\n    'uscongressional_districts'\r\n]\r\n\r\nexport const legacyResourceOrder = [\r\n  'clinic',\r\n  'hospital',\r\n  'clinic-hospitals'\r\n]\r\n\r\nexport const legacySourceOrder = [\r\n    'county_usfacts.geojson', \r\n    'county_1p3a.geojson', \r\n    'state_usafacts.geojson'\r\n]\r\n\r\n","import { legacyOverlayOrder, legacyResourceOrder, legacySourceOrder, legacyVariableOrder } from '../config';\r\n\r\nconst getURLParams = (params) => {\r\n\r\n    let { URLmapParams, URLcurrentData, URLcurrentVariable, URLviewState } = params;\r\n    \r\n    let overlay = URLmapParams.overlay ? `&ovr=${legacyOverlayOrder.indexOf(URLmapParams.overlay)}` : '';\r\n    let resource = URLmapParams.resource ? `&res=${legacyResourceOrder.indexOf(URLmapParams.resource)}` : '';\r\n    let variable = URLcurrentVariable !== \"7-Day Average Daily New Confirmed Count\" ? `&var=${legacyVariableOrder[URLcurrentData].indexOf(URLcurrentVariable)}` : '';\r\n    let method = URLmapParams.mapType !== 'natural_breaks' ? `&mthd=${URLmapParams.mapType}` : '';\r\n    let source = URLcurrentData !== 'county_usfacts.geojson' ? `&src=${legacySourceOrder.indexOf(URLcurrentData)}` : '';\r\n    let coords = `?lat=${Math.round(URLviewState.latitude*1000)/1000}&lon=${Math.round(URLviewState.longitude*1000)/1000}&z=${Math.round(URLviewState.zoom*10)/10}`;\r\n    let date =  '' //`&dt=${selectedDate}`;\r\n    let cartogram = URLmapParams.vizType === \"cartogram\" ? `&cartogram=true` : '';\r\n  \r\n    return `${coords}${overlay}${resource}${variable}${method}${source}${date}${cartogram}&v=1`\r\n}\r\n\r\nexport default getURLParams;","const getVarId = (currentData, dataParams) => {\r\n    return `${currentData}-${dataParams.numerator}-${dataParams.nIndex}-${dataParams.nRange}-${dataParams.denominator}-${dataParams.dProperty}-${dataParams.dIndex}-${dataParams.dRange}-${dataParams.scale}`\r\n}\r\n\r\nexport default getVarId;","import { getJson, getGeoidIndex } from '../utils';\r\n\r\nconst loadJson = async (url, gda_proxy) => {\r\nconst data = getJson(url).then(values => {\r\n    gda_proxy.ReadGeojsonMap(url.split('/').slice(-1,)[0], values.ab);\r\n    return values.response.json().then(\r\n    data => {\r\n        return {\r\n        data: data,\r\n        geoidIndex: getGeoidIndex(data.features)\r\n        }\r\n    })\r\n})\r\nreturn data;\r\n}\r\n\r\nexport default loadJson;","const mapFn = (val, bins, colors, maptype, column) => {\r\n  if (val === null) {\r\n    return null;\r\n  } else if (maptype === \"natural_breaks\") {\r\n    if (val === 0 || (val === -1 && column.includes('testing'))) return colors[0];\r\n\r\n    for (let i=1; i<bins.length; i++) {\r\n      if (val < bins[i]) {\r\n        return colors[i]\r\n      }\r\n    }\r\n    return colors[0];\r\n  } else if (maptype.includes(\"hinge\")) {\r\n    \r\n    if (val === null) return [0,0,0,0];\r\n    \r\n    for (let i=1; i<bins.length; i++) {\r\n      if (val < bins[i]) {\r\n        return colors[i-1]\r\n      }\r\n    }\r\n    return colors[0];\r\n  }\r\n}\r\n\r\nexport default mapFn","import { merge } from 'lodash';\r\n\r\nconst mergeData = (featureCollection, featureCollectionJoinCol, joinData, joinDataNames, joinDataCol) => {\r\n    // declare parent dictionaries\r\n    let features = {}\r\n    let dataDict = {}\r\n    \r\n    // declare and prep feature collection object\r\n    let i = featureCollection.features.length;\r\n    let colNumCheck = parseInt(featureCollection.features[0].properties[featureCollectionJoinCol])\r\n    if (Number.isInteger(colNumCheck)) {\r\n      while (i>0) {\r\n        i--;\r\n        features[parseInt(featureCollection.features[i].properties[featureCollectionJoinCol])] = featureCollection.features[i];\r\n        dataDict[parseInt(featureCollection.features[i].properties[featureCollectionJoinCol])] = {};\r\n      }\r\n    } else {\r\n      while (i>0) {\r\n        i--;\r\n        features[featureCollection.features[i].properties[featureCollectionJoinCol]] = featureCollection.features[i];\r\n        dataDict[featureCollection.features[i].properties[featureCollectionJoinCol]] = {};\r\n      }\r\n    }\r\n  \r\n    // // declare data objects\r\n    // for (let n=0; n < joinDataNames.length; n++) {\r\n    //   dataDict[`${joinDataNames[n]}`] = {}\r\n    // }\r\n  \r\n    // loop through data and add to dictionaries\r\n    let n = joinData.length;\r\n    while (n>0) {\r\n      n--;\r\n      let cols = Object.keys(joinData[n][0]);\r\n      i = cols.length;\r\n      while (i>0) {\r\n        i--;\r\n        try {\r\n          dataDict[cols[i]][joinDataNames[n]] = joinData[n][0][cols[i]]\r\n        } catch {}\r\n      }\r\n    }\r\n    \r\n    // // use lodash to merge data\r\n    let merged = merge(features, dataDict)\r\n    // for (let n=1; n < joinDataNames.length; n++){\r\n    //   merged = merge(merged, dataDict[joinDataNames[n]])\r\n    // }\r\n    \r\n    // clean data\r\n    let rtn = [];\r\n    let keys = Object.keys(merged)\r\n    \r\n    for (let i = 0; i < keys.length; i++) {\r\n      // if (Object.keys(merged[keys[i]]).length == (joinDataNames.length+baseColumnLength)) rtn.push(merged[keys[i]])\r\n      rtn.push(merged[keys[i]])\r\n    }\r\n\r\n    return rtn;\r\n}\r\n\r\nexport default mergeData;","// These actions are part of the verbose boilerplate of redux\r\n// As part of the Flux architecture, these connect the dispatch from a component to the reducers\r\n\r\n// set active GEOID \r\n// currently not used\r\nexport const setGeoid = (geoid) => {\r\n    return {\r\n        type: 'SET_GEOID',\r\n        payload: {\r\n            geoid\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataLoad = ( load ) => {\r\n    return {\r\n        type: 'DATA_LOAD',\r\n        payload: {\r\n            load\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataLoadExisting = ( load ) => {\r\n    return {\r\n        type: 'DATA_LOAD_EXISTING',\r\n        payload: {\r\n            load\r\n        }\r\n    }\r\n}\r\n\r\nexport const setNewBins = ( load ) => {\r\n    return {\r\n        type: 'SET_NEW_BINS',\r\n        payload: {\r\n            load\r\n        }\r\n    }\r\n}\r\n\r\n// main store for map and tabular data\r\nexport const storeData = (data, name) => {\r\n    return {\r\n        type: 'SET_STORED_DATA',\r\n        payload: {\r\n            data,\r\n            name\r\n        }   \r\n    }\r\n}\r\n\r\n// store GEOJSON and pseudo-hash table\r\nexport const storeGeojson = (data, name) => {\r\n    return {\r\n        type: 'SET_STORED_GEOJSON',\r\n        payload: {\r\n            data,\r\n            name\r\n        }   \r\n    }\r\n}\r\n\r\nexport const storeMobilityData = (data) => {\r\n    return {\r\n        type: 'SET_STORED_MOBILITY_DATA',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// store lisa values with specific variable combination\r\nexport const storeLisaValues = (data, name) => {\r\n    return {\r\n        type: 'SET_STORED_LISA_DATA',\r\n        payload: {\r\n            data,\r\n            name\r\n        }   \r\n    }\r\n}\r\n\r\n// store cartogra data, just like lisa\r\nexport const storeCartogramData = (data, name) => {\r\n    return {\r\n        type: 'SET_STORED_CARTOGRAM_DATA',\r\n        payload: {\r\n            data,\r\n            name\r\n        }   \r\n    }\r\n}\r\n\r\n// sets the name of the current data set, usually a geojson\r\nexport const setCurrentData = (data) => {\r\n    return {\r\n        type: 'SET_CURRENT_DATA',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// not used -- this stored the Geoda Proxy, but was a bad idea\r\nexport const setGeodaProxy = (proxy) => {\r\n    return {\r\n        type: 'SET_GEODA_PROXY',\r\n        payload: {\r\n            proxy\r\n        }\r\n    }\r\n}\r\n\r\n// stores parsed centroid data \r\nexport const setCentroids = (data, name) => {\r\n    return {\r\n        type: 'SET_CENTROIDS',\r\n        payload: {\r\n            data,\r\n            name\r\n        }\r\n    }\r\n}\r\n\r\n// stores valid dates in current data set\r\nexport const setDates = (data, name) => {\r\n    return {\r\n        type: 'SET_DATES',\r\n        payload: {\r\n            data,\r\n            name\r\n        }\r\n    }\r\n}\r\n\r\n// not used -- stores the current data parsing function in the store\r\nexport const setDataFunction = (fn) => {\r\n    return {\r\n        type: 'SET_DATA_FUNCTION',\r\n        payload: {\r\n            fn\r\n        }\r\n    }\r\n}\r\n\r\n// stores a pseudo-hash table or lookup table\r\n// the data attached to the geojson is stored in arrays / list,\r\n// so a lookup table is needed to find the key-value pairs\r\nexport const setColumnNames = (data, name) => {\r\n    return {\r\n        type: 'SET_COLUMN_NAMES',\r\n        payload: {\r\n            data,\r\n            name\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// sets the current date as text\r\nexport const setDate = (date) => {\r\n    return {\r\n        type: 'SET_CURR_DATE',\r\n        payload: {\r\n            date\r\n        }\r\n    }\r\n}\r\n\r\n// sets the index of the date within the current dataset(s)\r\nexport const setDateIndex = (index) => {\r\n    return {\r\n        type: 'SET_DATE_INDEX',\r\n        payload: {\r\n            index\r\n        }\r\n    }\r\n}\r\n\r\n// the first valid date in the main data columns (cases, deaths, etc.)\r\nexport const setStartDateIndex = (index) => {\r\n    return {\r\n        type: 'SET_START_DATE_INDEX',\r\n        payload: {\r\n            index\r\n        }\r\n    }\r\n}\r\n\r\n// stores the current bins (bin names / descriptions)\r\n// and breaks (numerical breaks)\r\nexport const setBins = (bins, breaks) => {\r\n    return {\r\n        type: 'SET_BINS',\r\n        payload: {\r\n            bins,\r\n            breaks\r\n        }\r\n    }\r\n}\r\n\r\n// not used -- set map to 3d\r\nexport const set3D = () => {\r\n    return {\r\n        type: 'SET_3D'\r\n    }\r\n}\r\n\r\n// loads data for the data/info sidebar\r\nexport const setDataSidebar = ( data ) => {\r\n    return {\r\n        type: 'SET_DATA_SIDEBAR',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// increments the date by 1, for use with the animation\r\nexport const incrementDate = ( index ) => {\r\n    return {\r\n        type: 'INCREMENT_DATE',\r\n        payload: {\r\n            index\r\n        }\r\n    }\r\n}\r\n\r\n// sets the variables parameters (index and range, numerator, denominator, etc.)\r\nexport const setVariableParams = ( params ) => {\r\n    return {\r\n        type: 'SET_VARIABLE_PARAMS',\r\n        payload: {\r\n            params\r\n        }\r\n    }\r\n}\r\n\r\n// sets the map parameters (color mode, viz type, etc.)\r\nexport const setMapParams = ( params ) => {\r\n    return {\r\n        type: 'SET_MAP_PARAMS',\r\n        payload: {\r\n            params\r\n        }\r\n    }\r\n}\r\n\r\n// loads in chart data from current data\r\nexport const setSelectionData = ( data ) => {\r\n    return {\r\n        type: 'SET_SELECTION_DATA',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// adds to current chart data from current data\r\nexport const appendSelectionData = ( data ) => {\r\n    return {\r\n        type: 'APPEND_SELECTION_DATA',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// removes from current chart data from current data\r\nexport const removeSelectionData = ( data ) => {\r\n    return {\r\n        type: 'REMOVE_SELECTION_DATA',\r\n        payload: {\r\n            data\r\n        }\r\n    }\r\n}\r\n\r\n// sets current text-based variable name (eg. Death Count)\r\nexport const setVariableName = ( name ) => {\r\n    return {\r\n        type: 'SET_VARIABLE_NAME',\r\n        payload: {\r\n            name\r\n        }\r\n    }\r\n}\r\n\r\n// sets the anchor element for the inforational tooltip\r\nexport const setAnchorEl = ( anchorEl ) => {\r\n    return {\r\n        type: 'SET_ANCHOR_EL',\r\n        payload: {\r\n            anchorEl\r\n        }\r\n    }\r\n}\r\n\r\n// sets the left, right, and dock panel states\r\nexport const setPanelState = ( params ) => {\r\n    return {\r\n        type: 'SET_PANELS',\r\n        payload: {\r\n            params\r\n        }\r\n    }\r\n}\r\n\r\nexport const setMapLoaded = ( loaded ) => {\r\n    return {\r\n        type: 'SET_MAP_LOADED',\r\n        payload: {\r\n            loaded\r\n        }\r\n    }\r\n}\r\n\r\nexport const setNotification = ( info ) => {\r\n    return {\r\n        type: 'SET_NOTIFICATION',\r\n        payload: {\r\n            info\r\n        }\r\n    }\r\n}\r\n\r\nexport const setUrlParams = ( load ) => {\r\n    return {\r\n        type: 'SET_URL_PARAMS',\r\n        payload: {\r\n            load\r\n        }\r\n    }\r\n}","// this components houses the slider, legend, and bottom dock chart\r\nimport React, { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport styled from 'styled-components';\r\n\r\nimport { Legend } from '../components';\r\nimport { setPanelState } from '../actions';\r\nimport { colors } from '../config';\r\n\r\n// helper function to get dock offset\r\nconst getChartHeight = () => { try { return document.querySelector('#main-chart-container').offsetHeight} catch { return 0} }\r\n\r\n// Styled components\r\nconst BottomDrawer = styled.div`\r\n    position: fixed;\r\n    bottom:0;\r\n    left:50%;\r\n    background:${colors.gray};\r\n    transform:translateX(-50%);\r\n    width:38vw;\r\n    max-width: 500px;\r\n    box-sizing: border-box;\r\n    padding:0 0 5px 0;\r\n    margin:0;\r\n    box-shadow: 0px 0px 5px rgba(0,0,0,0.7);\r\n    border-radius:0.5vh 0.5vh 0 0;\r\n    transition:250ms all;\r\n    hr {\r\n        opacity:0.5;\r\n    }\r\n    @media (max-width:1024px){\r\n        width:50vw;\r\n        div {\r\n            padding-bottom:5px;\r\n        }\r\n        #binModeSwitch {\r\n            position:absolute !important;\r\n            right: 10px !important;\r\n            top: 10px !important;\r\n        }\r\n        #dateRangeSelector {\r\n            position:absolute !important;\r\n            left: 66% !important;\r\n            transform:translateX(-50%) !important;\r\n            top: 10px !important;\r\n        }\r\n    }\r\n    \r\n    @media (max-width:768px){\r\n    \r\n        width:100%;\r\n        max-width:100%;\r\n        padding:0;\r\n        left:0;\r\n        transform:none;\r\n    }\r\n    @media (max-width:750px) and (orientation: landscape) {\r\n        // bottom all the way down for landscape phone\r\n    }\r\n`\r\n\r\nconst BottomPanel = () => {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const panelState = useSelector(state => state.panelState);\r\n\r\n    // offset for the bottom panel based on the chart height, \r\n    // managed through props via styled-components\r\n    const [bottomMargin, setBottomMargin] = useState(0);\r\n\r\n    const handleResize = () => setBottomMargin(getChartHeight())\r\n    window.addEventListener(\"resize\", handleResize);\r\n    \r\n    return (\r\n        <BottomDrawer bottom={panelState.chart ? 0 : bottomMargin }>\r\n            <Legend />\r\n            {/* <DateSlider /> */}\r\n            {/* <hr />\r\n            <MainLineChart />\r\n            <OpenCloseButton onClick={handleBottomOpen} bottom={panelState.chart ? 5 : bottomMargin}>\r\n                <svg version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\r\n                    <g transform=\"translate(50 50) scale(0.69 0.69) rotate(0) translate(-50 -50)\">\r\n                        <path d=\"M38,33.8L23.9,47.9c-1.2,1.2-1.2,3.1,0,4.2L38,66.2l4.2-4.2l-9-9H71v17c0,0.6-0.4,1-1,1H59v6h11\r\n                        c3.9,0,7-3.1,7-7V30c0-3.9-3.1-7-7-7H59v6h11c0.6,0,1,0.4,1,1v17H33.2l9-9L38,33.8z\"/>\r\n                    </g>\r\n                </svg>\r\n                <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\r\n                    <g>\r\n                        <path d=\"M52.5,21.4c-1.9,0-3.6,1.3-4.1,3.1L37.9,63.7l-6.4-11.1c-1.2-2-3.7-2.7-5.7-1.5c-0.3,0.2-0.6,0.4-0.9,0.7\r\n                            L10.1,66.6c-1.7,1.6-1.7,4.2-0.2,5.9c1.6,1.7,4.2,1.7,5.9,0.2c0.1,0,0.1-0.1,0.1-0.1L27,61.5l8.7,15.1c1.2,2,3.7,2.7,5.7,1.5\r\n                            c0.9-0.6,1.6-1.5,1.9-2.5l9.1-33.9l4.6,17.2c0.6,2.2,2.9,3.5,5.1,2.9c1.1-0.3,2-1,2.5-1.9l10.4-18l8.9,9.4c1.6,1.7,4.2,1.8,5.9,0.3\r\n                            s1.8-4.2,0.3-5.9c0,0-0.1-0.1-0.1-0.1L77.3,32.1c-1.6-1.7-4.2-1.8-5.9-0.2c-0.3,0.3-0.6,0.6-0.8,1L62.5,47l-6-22.5\r\n                            C56,22.7,54.4,21.4,52.5,21.4L52.5,21.4z\"/>\r\n                    </g>\r\n                </svg>\r\n\r\n            </OpenCloseButton> */}\r\n        </BottomDrawer>\r\n    )\r\n\r\n}\r\n\r\nexport default BottomPanel","import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport styled from 'styled-components';\r\nimport { setAnchorEl } from '../actions';\r\n\r\nconst TooltipContainer = styled.button`\r\n    width:12.5px;\r\n    height:12.5px;\r\n    background:url('${process.env.PUBLIC_URL}/assets/img/info.png');\r\n    background-repeat: no-repeat;\r\n    background-size: cover;\r\n    outline:none;\r\n    border:none;\r\n    padding:0;\r\n    margin:4px;\r\n`\r\n\r\nconst Tooltip = (props) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleMouseOver = (event) => {\r\n        dispatch(setAnchorEl(event.currentTarget))\r\n    }\r\n\r\n    const handleMouseLeave = () => {\r\n        dispatch(setAnchorEl(null))\r\n    }\r\n\r\n    return (\r\n        <TooltipContainer id={props.id} key={props.id} onMouseEnter={handleMouseOver} onMouseLeave={handleMouseLeave} />\r\n    )\r\n}\r\n\r\nexport default Tooltip","import React from 'react';\r\nimport {\r\n    LineChart, Line, YAxis\r\n} from 'recharts';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3-scale';\r\n\r\nconst LineContainer = styled.div`\r\n    display:inline;\r\n    padding:0;\r\n    margin:0;\r\n    align-self:flex-start;\r\n`\r\n\r\nconst CustomizedDot = (props) => {\r\n    const {\r\n      cx, cy, index, color, angle\r\n    } = props;\r\n    if (index === 13) {\r\n      return (\r\n        <svg x={cx - 10} y={cy - 10} width={20} height={20} fill={color} viewBox=\"0 0 500 500\" >\r\n\t\t    <polygon points=\"50,125 50,375 375,250\" transform={`rotate(${angle} 250 250)`}  />\r\n\t  </svg>\r\n      );\r\n    }\r\n  \r\n    return null;\r\n  };\r\n\r\nconst TwoWeekLineChart = ( props ) => {\r\n    \r\n    // map data into object\r\n    let data = props.data.map(d => {\r\n        return {val: d/props.data[0]}\r\n    })\r\n    \r\n    let schemas = {\r\n        'cases/deaths': ['green', 'yellow', 'red'],\r\n        'testingCap': ['#f7fbff', '#f7fbff', '#08306b'],\r\n        'testingPos': ['#0d0887', '#cb4679', '#f0f921'],\r\n    }\r\n    \r\n    // colors derived from green - yellow - red diverging scale\r\n    const colorScale = d3.scaleLinear()\r\n        .domain([0, 0.5, 1])\r\n        .range(schemas[props.schema])\r\n\r\n    // change over past two weeks\r\n    const delta = props.data[13] - props.data[0]\r\n\r\n    const lineColor = (delta, start) => {\r\n        let pctChange = delta/start\r\n        return colorScale(pctChange + 0.5);\r\n    }\r\n\r\n    const calcAngle = (delta, start) => {\r\n        let pctChange = delta/start;\r\n        if (pctChange >= 0.5) {\r\n            return -60\r\n        } else if (pctChange <= -0.5) {\r\n            return 60\r\n        } else { \r\n            return pctChange*-1*60\r\n        }\r\n    }\r\n\r\n    return (\r\n        <LineContainer>\r\n            <LineChart data={data} width={60} height={30}>\r\n                <YAxis domain={['dataMin', 'dataMax']}  hide={true} />\r\n                <Line \r\n                    type=\"linear\" \r\n                    dataKey=\"val\" \r\n                    stroke={lineColor(delta, props.data[0])}\r\n                    strokeWidth={2} \r\n                    isAnimationActive={false}\r\n                    dot={\r\n                        <CustomizedDot color={lineColor(delta, props.data[0])} angle={calcAngle(delta, props.data[12])} />\r\n                        }\r\n                />\r\n            </LineChart>\r\n        </LineContainer>\r\n    );\r\n}\r\n\r\nexport default TwoWeekLineChart;\r\n  ","export const compact = <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 19.6 32\">\r\n        <path d=\"M1,0h17.6c0.6,0,1,0.5,1,1v3.1c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1V1C0,0.5,0.4,0,1,0z\"/>\r\n        <path d=\"M1,9h17.6c0.6,0,1,0.5,1,1v3.1c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1V10C0,9.4,0.4,9,1,9z\"/>\r\n        <path d=\"M1,17.9h17.6c0.6,0,1,0.5,1,1V22c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1v-3.1C0,18.4,0.4,17.9,1,17.9z\"/>\r\n        <path d=\"M1,26.9h17.6c0.6,0,1,0.5,1,1V31c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1v-3.1C0,27.3,0.4,26.9,1,26.9z\"/>\r\n    </svg>\r\n\r\nexport const expand = <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 19.6 32\" >\r\n        <path d=\"M1,0h17.6c0.6,0,1,0.5,1,1v3.1c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1V1C0,0.5,0.4,0,1,0z\"/>\r\n        <path d=\"M1,9h17.6c0.6,0,1,0.5,1,1v21c0,0.6-0.4,1-1,1H1c-0.6,0-1-0.5-1-1V10C0,9.4,0.4,9,1,9z\"/>\r\n    </svg>\r\n\r\nexport const settings = <svg viewBox=\"0 0 50 50\">\r\n            <circle className=\"cls-1\" cx=\"25.43\" cy=\"24.63\" r=\"15.4\" transform=\"translate(-3.28 3.92) rotate(-8.28)\"/>\r\n            <path className=\"cls-2\" d=\"M28.87,47.49l-7.07,0L22,41.58a17.18,17.18,0,0,0,6.74,0Z\"/>\r\n            <path className=\"cls-2\" d=\"M28.84,7.68a17.18,17.18,0,0,0-6.74,0l-.16-5.89H29Z\"/>\r\n            <path className=\"cls-2\" d=\"M44,38.35l-5,5L35,39a17.33,17.33,0,0,0,4.78-4.76Z\"/>\r\n            <path className=\"cls-2\" d=\"M15.85,10.22A17.19,17.19,0,0,0,11.07,15L6.8,10.92l5-5Z\"/>\r\n            <path className=\"cls-2\" d=\"M48.27,21.17l0,7.08-5.88-.19a17.23,17.23,0,0,0,0-6.75Z\"/>\r\n            <path className=\"cls-2\" d=\"M8.45,21.2a17.37,17.37,0,0,0,0,6.74l-5.89.16,0-7.08Z\"/>\r\n            <path className=\"cls-2\" d=\"M39.12,6l5,5-4.29,4a17.43,17.43,0,0,0-4.75-4.78Z\"/>\r\n            <path className=\"cls-2\" d=\"M11,34.2A17.16,17.16,0,0,0,15.75,39L11.7,43.25l-5-5Z\"/>\r\n    </svg>\r\n\r\nexport const report = <svg viewBox=\"0 0 50 50\">\r\n        <rect x=\"0.03\" y=\"0.19\" width=\"49.93\" height=\"3.85\" rx=\"1\"/>\r\n        <rect x=\"0.03\" y=\"8.4\" width=\"46.19\" height=\"3.85\" rx=\"1\"/>\r\n        <rect x=\"0.03\" y=\"21.12\" width=\"49.93\" height=\"3.85\" rx=\"1\"/>\r\n        <rect x=\"0.03\" y=\"29.58\" width=\"49.93\" height=\"3.85\" rx=\"1\"/><rect x=\"0.03\" y=\"38.04\" width=\"43.69\" height=\"3.85\" rx=\"1\"/>\r\n        <rect x=\"0.03\" y=\"46.15\" width=\"49.93\" height=\"3.85\" rx=\"1\"/>\r\n    </svg>\r\n\r\nexport const chart = <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\r\n        <g>\r\n            <path d=\"M52.5,21.4c-1.9,0-3.6,1.3-4.1,3.1L37.9,63.7l-6.4-11.1c-1.2-2-3.7-2.7-5.7-1.5c-0.3,0.2-0.6,0.4-0.9,0.7\r\n                L10.1,66.6c-1.7,1.6-1.7,4.2-0.2,5.9c1.6,1.7,4.2,1.7,5.9,0.2c0.1,0,0.1-0.1,0.1-0.1L27,61.5l8.7,15.1c1.2,2,3.7,2.7,5.7,1.5\r\n                c0.9-0.6,1.6-1.5,1.9-2.5l9.1-33.9l4.6,17.2c0.6,2.2,2.9,3.5,5.1,2.9c1.1-0.3,2-1,2.5-1.9l10.4-18l8.9,9.4c1.6,1.7,4.2,1.8,5.9,0.3\r\n                s1.8-4.2,0.3-5.9c0,0-0.1-0.1-0.1-0.1L77.3,32.1c-1.6-1.7-4.2-1.8-5.9-0.2c-0.3,0.3-0.6,0.6-0.8,1L62.5,47l-6-22.5\r\n                C56,22.7,54.4,21.4,52.5,21.4L52.5,21.4z\"/>\r\n        </g>\r\n    </svg>\r\n\r\nexport const info =  <svg viewBox=\"0 0 100 100\" x=\"0px\" y=\"0px\">\r\n        <g>\r\n            <path d=\"M 62.0763 27.4552 C 64.0258 25.642 65 23.4406 65 20.8589 C 65 18.2815 64.0258 16.0809 62.0763 14.2511 C 60.1273 12.4207 57.7859 11.5 55.0413 11.5 C 52.3076 11.5 49.9438 12.4207 47.9833 14.2511 C 46.0343 16.0809 45.0487 18.2815 45.0487 20.8589 C 45.0487 23.4406 46.0343 25.642 47.9833 27.4552 C 49.9438 29.2682 52.3076 30.178 55.0413 30.178 C 57.7859 30.178 60.1273 29.2682 62.0763 27.4552 ZM 57.5841 88.0802 C 61.1017 86.4348 62.9616 83.3419 61.1353 81.9274 C 60.0823 81.1132 58.7041 82.4604 57.6963 82.4604 C 55.5343 82.4604 54.0103 82.1065 53.1367 81.3939 C 52.2518 80.6754 51.8261 79.3446 51.8261 77.3796 C 51.8261 76.5942 51.9493 75.4433 52.2182 73.9213 C 52.487 72.395 52.8007 71.0302 53.1367 69.8404 L 57.3153 55.0418 C 57.7073 53.683 57.9988 52.1893 58.1554 50.5672 C 58.301 48.9276 58.3798 47.7935 58.3798 47.1533 C 58.3798 44.0378 57.2817 41.5004 55.0971 39.5465 C 52.9237 37.5991 49.8094 36.6159 45.7765 36.6159 C 43.5361 36.6159 41.1501 36.9472 38.652 37.8117 C 33.7564 39.5293 34.8432 43.7968 35.9296 43.7968 C 38.1364 43.7968 39.6152 44.1722 40.3995 44.9193 C 41.1837 45.6604 41.5868 46.9796 41.5868 48.8828 C 41.5868 49.9269 41.4413 51.1007 41.1947 52.3689 C 40.9369 53.6381 40.635 54.9909 40.2541 56.4111 L 36.053 71.2659 C 35.6947 72.8267 35.4253 74.2246 35.2463 75.4648 C 35.0784 76.7058 35 77.9187 35 79.1091 C 35 82.1578 36.12 84.6722 38.3716 86.6596 C 40.6238 88.6528 44.0854 90.5 48.1405 90.5 C 50.7731 90.5 54.537 89.518 57.5841 88.0802 Z\">\r\n            </path>\r\n        </g>\r\n    </svg>\r\n\r\nexport const verticalGrip = <svg viewBox=\"0 0 12.1 50\" >\r\n        <rect width=\"2.4\" height=\"50\"/>\r\n        <rect x=\"4.9\" width=\"2.4\" height=\"50\"/>\r\n        <rect x=\"9.8\" width=\"2.4\" height=\"50\"/>\r\n    </svg>\r\n\r\nexport const selectRect = <svg viewBox=\"0 0 100 100\">\r\n    <g transform=\"translate(50 50) scale(0.69 0.69) rotate(0) translate(-50 -50)\">\r\n        <svg\r\n            fill=\"#000000\"\r\n            viewBox=\"0 0 8.4666665 8.4666669\"\r\n        >\r\n            <g transform=\"translate(0,-288.53333)\">\r\n                <path\r\n                    d=\"m 0.52916618,289.0625 v 1.05833 H 1.0583328 v -0.52916 h 0.5291667 v -0.52917 z m 1.58750012,0 v 0.52917 h 1.0583333 v -0.52917 z m 1.5875,0 v 0.52917 h 1.0583333 v -0.52917 z m 1.5875,0 v 0.52917 h 1.0583333 v -0.52917 z m 1.5875,0 v 0.52917 H 7.408333 v 0.52916 H 7.9374996 V 289.0625 Z M 0.52916618,290.65 v 1.05833 H 1.0583328 V 290.65 Z m 6.87916682,0 v 1.05833 H 7.9374996 V 290.65 Z m -6.87916682,1.5875 v 1.05833 H 1.0583328 v -1.05833 z m 6.87916682,0 v 1.05833 h 0.5291666 v -1.05833 z m -6.87916682,1.5875 v 1.05833 H 1.0583328 V 293.825 Z m 6.87916682,0 v 1.05833 H 7.9374996 V 293.825 Z m -6.87916682,1.5875 v 1.05833 H 1.5874995 v -0.52916 H 1.0583328 v -0.52917 z m 6.87916682,0 v 0.52917 H 6.8791663 v 0.52916 h 1.0583333 v -1.05833 z m -5.2916667,0.52917 v 0.52916 h 1.0583333 v -0.52916 z m 1.5875,0 v 0.52916 h 1.0583333 v -0.52916 z m 1.5875,0 v 0.52916 h 1.0583333 v -0.52916 z\"\r\n                ></path>\r\n            </g>\r\n        </svg>\r\n    </g>\r\n    </svg>\r\n","// This components formats the data for the selected geography\r\n// and displays it in the right side panel.\r\n\r\nimport React, {useState} from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport styled from 'styled-components';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\n\r\nimport Tooltip from './tooltip';\r\nimport TwoWeekChart from './twoWeekLineChart';\r\nimport { setPanelState } from '../actions';\r\nimport {dataFn, colLookup} from '../utils';\r\nimport { colors } from '../config';\r\nimport { compact, expand, report, verticalGrip} from '../config/svg';\r\n\r\n// Styled components CSS\r\nconst DataPanelContainer = styled.div`\r\n  display: ${props => props.dataLength === 0 ? 'none' : 'initial'};\r\n  position:fixed;\r\n  min-width:250px;\r\n  right:0;\r\n  top:50px;\r\n  overflow-x:visible;\r\n  height:calc(100vh - 50px);\r\n  background-color: ${colors.gray}fa;\r\n  box-shadow: -2px 0px 5px rgba(0,0,0,0.7);\r\n  padding:20px;\r\n  box-sizing: border-box;\r\n  transition:250ms all;\r\n  font: 'Lato', sans-serif;\r\n  color: white;\r\n  font-size:100%;\r\n  padding:0;\r\n  z-index:5;\r\n  transform: translateX(100%);\r\n  &.open {\r\n    transform:none;\r\n  }\r\n  @media (max-width:1024px) {\r\n    min-width:50vw;\r\n  }  \r\n  @media (max-width:600px) {\r\n    width:100%;\r\n    left:0;\r\n    transform:translateX(-100%);\r\n    z-index:51;\r\n    &.open {\r\n      transform:none;\r\n    }\r\n    display: ${props => (props.otherPanels || props.dataLength === 0) ? 'none' : 'initial'};\r\n  }\r\n  button#showHideRight {\r\n    position:absolute;    \r\n    right:calc(100% - 20px);\r\n    top:20px;\r\n    width:40px;\r\n    height:40px;\r\n    padding:0;\r\n    margin:0;\r\n    background-color: ${colors.gray};\r\n    box-shadow: 0px 0px 6px rgba(0,0,0,1);\r\n    outline:none;\r\n    border:none;\r\n    cursor: pointer;\r\n    transition:500ms all;\r\n    svg {\r\n      width:15px;\r\n      height:15px;\r\n      margin:12.5px 0 0 0;\r\n      @media (max-width:600px){\r\n        width:20px;\r\n        height:20px;\r\n        margin:5px;\r\n      }\r\n      fill:white;\r\n      transform:rotate(180deg);\r\n      transition:500ms all;\r\n    }\r\n    :after {\r\n      opacity:0;\r\n      font-weight:bold;\r\n      color:white;\r\n      position: relative;\r\n      top:-17px;\r\n      transition:500ms all;\r\n      content: 'Report';\r\n      right:50px;\r\n      z-index:4;\r\n    }  \r\n    &.hidden {\r\n      right:100%;\r\n      svg {\r\n        transform:rotate(0deg);\r\n      }\r\n      :after {\r\n        opacity:1;\r\n      }\r\n    }\r\n    @media (max-width:768px){\r\n      top:120px;\r\n    }\r\n    @media (max-width:600px) {\r\n      left:100%;\r\n      width:30px;\r\n      height:30px;\r\n      top:180px;\r\n      &.hidden svg {\r\n        transform:rotate(0deg);\r\n      }\r\n      :after {\r\n        display:none;\r\n      }\r\n      &.active {\r\n        left:90%;\r\n      }\r\n      &.active svg {\r\n        transform:rotate(90deg);\r\n      }\r\n    }\r\n  }\r\n  \r\n\r\n  div {\r\n    div {\r\n      p {\r\n        line-height:1.5;\r\n        margin:0;\r\n        display:inline-block;\r\n      }\r\n    }\r\n  }\r\n  h2 {\r\n    padding:15px 0 5px 0;\r\n    margin:0;\r\n    display:inline-block;\r\n    max-width:200px;\r\n  }\r\n  h6 {\r\n    padding:0 0 15px 0;\r\n    margin:0;\r\n    a {\r\n      color:${colors.yellow};\r\n      text-decoration:none;\r\n    }\r\n  }\r\n  .extraPadding {\r\n    padding-bottom:20vh;\r\n  }\r\n`\r\n\r\nconst ReportWrapper = styled.div`\r\n  height:100vh;\r\n  overflow-y:scroll;\r\n`\r\n\r\nconst ReportContainer = styled.div`\r\n    padding:5px 0 0 30px;\r\n    box-sizing:border-box;\r\n    overflow-x:visible;\r\n    // display:flex;\r\n    // flex-direction:column;\r\n    // flex-wrap:wrap;\r\n    // width:500px;\r\n    // columns:${props => props.cols} 250px;\r\n    // column-gap:10px;\r\n    // display:inline-block;\r\n    h3 {\r\n      font-size:${props => props.expanded ? '150%' : '100%'};\r\n      display:${props => props.expanded ? 'block' : 'inline'};\r\n      margin:${props => props.expanded ? '0': '0 15px 0 0'};\r\n      padding:${props => props.expanded ? '0 0 15px 0 !important': '0'};\r\n      &:before {\r\n        content: ': ';\r\n        display: ${props => props.expanded ? 'none' : 'initial'};\r\n      }\r\n      &:after {\r\n        content:\" \";\r\n        white-space:pre;\r\n        height:0;\r\n        display: ${props => props.expanded ? 'none' : 'block'};\r\n      }\r\n    }\r\n    div.numberChartContainer {\r\n      width:100%;\r\n      display:${props => props.expanded ? 'flex' : 'inline'};\r\n      align-items: center;\r\n    }\r\n    div.numberContainer {\r\n      display:${props => props.expanded ? 'flex' : 'inline'};\r\n    }\r\n    .bigOnly {\r\n      display: ${props => props.expanded ? 'initial' : 'none'};\r\n    }\r\n    \r\n`\r\n\r\nconst ReportSection = styled.span`\r\n    padding-right:20px;\r\n    box-sizing:border-box;\r\n    // width:100%;\r\n    // display:inline-block;\r\n    padding: 0;\r\n    margin: 0;\r\n`\r\n\r\nconst ExpandSelect = styled(FormControl)`\r\n  outline:none;\r\n  border:none;\r\n  position:absolute !important;\r\n  right:25px;\r\n  top:15px;\r\n  div.MuiInputBase-root:before {\r\n    display:none !important;\r\n  }\r\n  div.MuiInputBase-root:after {\r\n    display:none !important;\r\n  }\r\n  svg {\r\n    path {\r\n      fill:white;\r\n    }\r\n  }\r\n\r\n`\r\nconst ResizeButton = styled.button`\r\n    position:absolute;\r\n    left:5px;\r\n    bottom:50%;\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    transform: translateY(-50%);\r\n    cursor:grab;\r\n    width:10px;\r\n    padding:0;\r\n    margin:0;\r\n    height:20px;\r\n    svg {\r\n      width:15px;\r\n      height:30px;\r\n      fill:white;\r\n    }\r\n    @media (max-width:1024px) {\r\n      display:none;\r\n    }\r\n`\r\n\r\nconst DataPanel = () => {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const storedData = useSelector(state => state.storedData);\r\n  // name of current data set\r\n  const currentData = useSelector(state => state.currentData);\r\n  // current date and index\r\n  const currDateIndex = useSelector(state => state.dataParams.nIndex);\r\n  const startDateIndex = useSelector(state => state.startDateIndex);\r\n  const dates = useSelector(state => state.dates);\r\n  const selectionKeys = useSelector(state => state.selectionKeys);\r\n  const selectionIndex = useSelector(state => state.selectionIndex);\r\n  // panels open/close state\r\n  const panelState = useSelector(state => state.panelState);\r\n  //column names\r\n  const cols = useSelector(state => state.cols);\r\n\r\n  // de-structure sidebarData, which houses selected geography data\r\n  const datasetList = ['properties', 'cases', 'deaths', 'predictions',\r\n    'chr_health_factors', 'chr_life', 'chr_health_context',\r\n    'testing_ccpt', 'testing_tcap', 'testing_wk_pos', 'testing', 'vaccinesAdmin']\r\n  const [ properties, cases, deaths, predictions,\r\n    chr_health_factors, chr_life, chr_health_context,\r\n    testing_ccpt, testing_tcap, testing_wk_pos, testing, vaccinesAdmin\r\n  ] = datasetList.map(dataset => {\r\n    if (storedData[currentData] === undefined) {\r\n      return false \r\n    } else {\r\n      return storedData[currentData][0].hasOwnProperty(dataset)\r\n    }\r\n  });\r\n\r\n  const [expanded, setExpanded] = useState(true)\r\n  const [width, setWidth] = useState(250);\r\n  const [colCount, setColCount] = useState(1);\r\n  const [currXPos, setCurrXPos] = useState(false);\r\n\r\n  // helper for predictions data\r\n  const parsePredictedDate = (list) => `${list.slice(-2,)[0]}/${list.slice(-1,)[0]}`\r\n\r\n  // handles panel open/close\r\n  const handleOpenClose = () => panelState.info ? dispatch(setPanelState({info:false})) : dispatch(setPanelState({info:true}))\r\n  \r\n  const listener = (e) => {\r\n    setWidth(prevWidth => {\r\n      if ((prevWidth - (window.innerWidth-e.screenX) < 25) && (prevWidth - (window.innerWidth-e.screenX) > -25)){\r\n        return prevWidth;\r\n      } else if ((window.innerWidth-e.screenX) < 300) {\r\n        setColCount(1);\r\n        return 300;\r\n      } else {\r\n        setColCount(Math.floor((window.innerWidth-e.screenX)/300));\r\n        return window.innerWidth-e.screenX\r\n      }\r\n    })\r\n  }\r\n\r\n  const touchListener = (e) => {\r\n      setWidth(prev => (e?.targetTouches[0]?.clientX-currXPos) || prev)\r\n  }\r\n\r\n  const removeListener = () => {\r\n      window.removeEventListener('mousemove', listener)\r\n      window.removeEventListener('mouseup', removeListener)\r\n  }\r\n\r\n  const removeTouchListener = () => {\r\n      window.removeEventListener('touchmove', touchListener);\r\n      window.removeEventListener('touchend', removeTouchListener);\r\n  }\r\n\r\n  const handleDown = () => {\r\n      window.addEventListener('mousemove', listener)\r\n      window.addEventListener('mouseup', removeListener)\r\n  }\r\n\r\n  const handleTouch = (e) => {\r\n      setCurrXPos(+e.target.parentNode.parentNode.parentNode.style.left.slice(0,-2))\r\n      window.addEventListener('touchmove', touchListener)\r\n      window.addEventListener('touchend', removeTouchListener)\r\n  }\r\n\r\n  // DRY issue -- refactor these functions\r\n\r\n  const performOperation = (dataArray, operation, totalPopulation) => {\r\n    const reducer = (accumulator, currentValue) => accumulator + currentValue;\r\n    switch(operation) {\r\n      case 'sum':\r\n        return dataArray.reduce(reducer)\r\n      case 'average':\r\n        return dataArray.reduce(reducer)/dataArray.length\r\n      case 'weighted_average':\r\n        return Math.round(dataArray.reduce(reducer)/totalPopulation*100)/100\r\n      default:\r\n        return null\r\n    }\r\n  } \r\n\r\n  const aggregateProperty = (dataset, property, operation, specialCase=null) => {\r\n    let dataArray; \r\n    let totalPopulation = 0;\r\n\r\n    if (operation === 'weighted_average') {\r\n      dataArray = selectionIndex.map(selection => {\r\n        let selectionPop = storedData[currentData][selection]['properties']['population'];\r\n        totalPopulation+=selectionPop;\r\n        if (specialCase === 'pcp') try { return parseInt(storedData[currentData][selection][dataset][property].split(':')[0])*selectionPop } catch { return 0}\r\n        return storedData[currentData][selection][dataset][property]*selectionPop\r\n      })\r\n    } else {\r\n      dataArray = selectionIndex.map(selection => storedData[currentData][selection][dataset][property]);\r\n    }\r\n\r\n    return performOperation(dataArray, operation, totalPopulation);\r\n  }\r\n\r\n  const aggregateTimeseries = (dataset, index, operation) => {\r\n    let dataArray; \r\n    let totalPopulation = 0;\r\n\r\n    if (operation === 'weighted_average') {\r\n      dataArray = selectionIndex.map(selection => {\r\n        let selectionPop = storedData[currentData][selection]['properties']['population'];\r\n        totalPopulation+=selectionPop;\r\n        return storedData[currentData][selection][dataset].slice(index,)[0]*selectionPop\r\n      })\r\n    } else {\r\n      dataArray = selectionIndex.map(selection => storedData[currentData][selection][dataset].slice(index,)[0]);\r\n    }\r\n\r\n    return performOperation(dataArray, operation, totalPopulation);\r\n  }\r\n\r\n  const aggregate2WeekTimeSeries = (dataset, index, operation) => {\r\n    let lookbackPeriod = []\r\n    for (let i=-13;i<1;i++) {\r\n      lookbackPeriod.push(index+i)\r\n    }\r\n    let rtn = lookbackPeriod.map(day => aggregateTimeseries(dataset, day, operation))\r\n\r\n    return rtn;\r\n  }\r\n  \r\n  const aggregateDataFunction = (numerator, denominator, params, operation) => {\r\n    \r\n    let dataArray; \r\n    let totalPopulation = 0;\r\n\r\n    if (operation === 'weighted_average') {\r\n      dataArray = selectionIndex.map(selection => {\r\n        let selectionPop = storedData[currentData][selection]['properties']['population'];\r\n        totalPopulation+=selectionPop;\r\n        return dataFn(storedData[currentData][selection][numerator], storedData[currentData][selection][denominator], params)*selectionPop\r\n      })\r\n    } else {\r\n      dataArray = selectionIndex.map(selection => dataFn(storedData[currentData][selection][numerator], storedData[currentData][selection][denominator], params));\r\n    }\r\n\r\n    return performOperation(dataArray, operation, totalPopulation);\r\n  }\r\n\r\n  const handleExpandContract = (event) => {\r\n    setExpanded(event.target.value)\r\n  }\r\n\r\n  \r\n\r\n  const aggregateQualitative = (dataset, property) => {\r\n    let dataArray = selectionIndex.map(selection => storedData[currentData][selection][dataset][property]);\r\n    let dataObj = {}\r\n    for (let i=0; i<dataArray.length; i++){\r\n      if (dataObj[dataArray[i]] === undefined) {\r\n        dataObj[dataArray[i]] = 1\r\n      } else {\r\n        dataObj[dataArray[i]] += 1\r\n      }\r\n    }\r\n\r\n    let returnStr = [];\r\n\r\n    for (let i=0; i<Object.keys(dataObj).length; i++){\r\n      returnStr.push(`${[Object.keys(dataObj)[i]]}: ${Math.round(dataObj[Object.keys(dataObj)[i]]/dataArray.length*10000)/100}%`)\r\n    }\r\n\r\n    return returnStr;\r\n  }\r\n\r\n  return (\r\n    <DataPanelContainer className={panelState.info ? 'open' : ''} id=\"data-panel\"  otherPanels={panelState.variables} dataLength={selectionKeys.length}>\r\n      {properties &&  \r\n      <ExpandSelect>\r\n        <Select\r\n          labelId=\"demo-simple-select-label\"\r\n          id=\"demo-simple-select\"\r\n          value={null}\r\n          onChange={handleExpandContract}\r\n        >\r\n          <MenuItem value={true}>Expanded</MenuItem>\r\n          <MenuItem value={false}>Compact</MenuItem>\r\n        </Select>\r\n      </ExpandSelect>\r\n      }\r\n      <ReportWrapper>\r\n        <ReportContainer expanded={expanded}>\r\n          <ReportSection>\r\n            {(properties && selectionIndex.length < 4) && <h2>{selectionKeys.map((key, index) => index === selectionKeys.length-1 ? selectionKeys.length === 1 ? key : `and ${key}` : `${key}, `)}</h2>}\r\n            {(properties && selectionIndex.length >= 4) && <h2>{currentData.includes('county') ? 'Selected Counties' : 'Selected States'}</h2>}\r\n            <br/>\r\n          {(properties && selectionIndex.length) && \r\n              <span>\r\n                <h4>{dates[currentData][currDateIndex-startDateIndex]}</h4>\r\n                <p>Population</p>\r\n                <h3>{aggregateProperty('properties', 'population', 'sum').toLocaleString('en')}</h3>\r\n              </span>\r\n            }       \r\n          </ReportSection>\r\n          {(cases && deaths && selectionIndex.length) && \r\n              <ReportSection>\r\n                <p>Total Cases</p>\r\n                <div className=\"numberChartContainer\">\r\n                  <h3>{aggregateTimeseries('cases', currDateIndex, 'sum')?.toLocaleString('en')}</h3>\r\n                  {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('cases', currDateIndex, 'sum')} schema='cases/deaths'/>}\r\n                </div>\r\n                <p>Total Deaths </p>\r\n                <div className=\"numberChartContainer\">\r\n                  <h3>{aggregateTimeseries('deaths', -1, 'sum')?.toLocaleString('en')}</h3>\r\n                  {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('deaths', currDateIndex, 'sum')} schema='cases/deaths'/>}\r\n                </div>\r\n                <p>Cases per 100k Population</p>\r\n                <h3>{aggregateDataFunction('cases', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: null, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                <p>Deaths per 100k Population</p>\r\n                <h3>{aggregateDataFunction('deaths', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: null, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                <p>New Cases per 100k Population</p>\r\n                <h3>{aggregateDataFunction('cases', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: 1, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                <p>New Deaths per 100k Population</p>\r\n                <h3>{aggregateDataFunction('deaths', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: 1, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                <p>Licensed Hospital Beds</p>\r\n                <h3>{aggregateProperty('properties','beds','sum').toLocaleString('en')}</h3>\r\n                {/* <p>Cases per Bed: {dataFn(cases, null, cases.length-1, null, properties, 'beds', null, null, 1)?.toFixed(2)?.toLocaleString('en')}</p><br/> */}\r\n              </ReportSection>\r\n            }\r\n          {(testing && selectionIndex.length) &&\r\n              <ReportSection>\r\n                <h2>Testing</h2><br/>\r\n                <p>7-Day Positivity Rate</p>\r\n                <div className=\"numberChartContainer\">\r\n                  <h3>{Math.round(aggregateTimeseries('testing_wk_pos', currDateIndex, 'weighted_average')*100)}%</h3>\r\n                  {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('testing_wk_pos', currDateIndex, 'weighted_average')} schema='testingPos'/>}\r\n                </div>\r\n\r\n                <p>7-Day Testing Capacity<br className=\"bigOnly\"/> per 100k People</p>\r\n                <div className=\"numberChartContainer\">\r\n                  <h3>{Math.round(aggregateTimeseries('testing_tcap', currDateIndex, 'weighted_average')*100)/100}</h3>\r\n                  {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('testing_tcap', currDateIndex, 'weighted_average')} schema='testingCap'/>}\r\n                </div>\r\n\r\n                <p>Total Testing</p>\r\n                <h3>{aggregateTimeseries('testing', currDateIndex, 'sum')?.toLocaleString('en')}</h3>\r\n\r\n                <p>7-Day Confirmed Cases<br className=\"bigOnly\"/>  per Testing</p>\r\n                <h3>{Math.round(aggregateTimeseries('testing_ccpt', currDateIndex, 'weighted_average')?.toLocaleString('en')*100)}%</h3>\r\n\r\n                <p>Testing Criterion</p><br className=\"bigOnly\"/>\r\n                <h3>{aggregateQualitative('properties', 'criteria').map(f => <span>{f}<br/></span>)}</h3>\r\n              </ReportSection>\r\n            }\r\n            {(vaccinesAdmin && selectionIndex.length) &&\r\n                <ReportSection>\r\n                  <h2>COVID Vaccination</h2><br/>\r\n                  <h6>Source: <a href=\"https://covid.cdc.gov/covid-data-tracker/#vaccinations\" target=\"_blank\" rel=\"noopener noreferrer\">CDC COVID Data Tracker</a></h6>            \r\n                \r\n                  <p>Vaccines Administered</p>\r\n                  <div className=\"numberChartContainer\">\r\n                    <h3>{Math.round(aggregateTimeseries('vaccinesAdmin', currDateIndex, 'weighted_average'))?.toLocaleString('en')}</h3>\r\n                    {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('vaccinesAdmin', currDateIndex, 'weighted_average')} schema='testingPos'/>}\r\n                  </div>\r\n                  <p>Vaccines Administered<br className=\"bigOnly\"/> Per 100k Population</p>\r\n                  <h3>{aggregateDataFunction('vaccinesAdmin', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: null, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                  \r\n                  <p>Vaccines Distributed</p>\r\n                  <div className=\"numberChartContainer\">\r\n                    <h3>{Math.round(aggregateTimeseries('vaccinesDist', currDateIndex, 'weighted_average'))?.toLocaleString('en')}</h3>\r\n                    {expanded && <TwoWeekChart data={aggregate2WeekTimeSeries('vaccinesDist', currDateIndex, 'weighted_average')} schema='testingPos'/>}\r\n                  </div>\r\n\r\n                  <p>Vaccines Distributed<br className=\"bigOnly\"/>  Per 100k Population</p>\r\n                  <h3>{aggregateDataFunction('vaccinesDist', 'properties', {nProperty: null, nIndex: currDateIndex, nRange: null, dProperty: 'population', dIndex: null, dRange: null, scale: 100000}, 'weighted_average')?.toFixed(2).toLocaleString('en')}</h3>\r\n                \r\n                </ReportSection>\r\n              }\r\n          {(chr_health_factors && selectionIndex.length) && \r\n            <ReportSection>\r\n              <h2>Community Health Factors<Tooltip id=\"healthfactor\"/></h2>\r\n              <h6>Source: <a href=\"https://www.countyhealthrankings.org/\" target=\"_blank\" rel=\"noopener noreferrer\">County Health Rankings</a></h6>\r\n              <p>Children in poverty</p><Tooltip id=\"PovChldPrc\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'PovChldPrc'), 'weighted_average')}%</h3>\r\n              <p>Income inequality<Tooltip id=\"IncRt\"/></p>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'IncRt'), 'weighted_average')}</h3>\r\n\r\n              <p>Median household income</p><Tooltip id=\"MedianHouseholdIncome\"/>\r\n              <h3>${aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'MedianHouseholdIncome'), 'weighted_average').toLocaleString('en')}</h3>\r\n\r\n              <p>Food insecurity</p><Tooltip id=\"FdInsPrc\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'FdInsPrc'), 'weighted_average')}%</h3>\r\n\r\n              <p>Unemployment</p><Tooltip id=\"UnEmplyPrc\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'UnEmplyPrc'), 'weighted_average')}%</h3>\r\n\r\n              <p>Uninsured</p><Tooltip id=\"UnInPrc\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'UnInPrc'), 'weighted_average')}%</h3>\r\n\r\n              <p>Primary care physicians</p><Tooltip id=\"PrmPhysRt\"/>\r\n              <h3>{Math.round(aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'PrmPhysRt'), 'weighted_average', 'pcp'))}:1</h3>\r\n\r\n              <p>Preventable hospital stays</p><Tooltip id=\"PrevHospRt\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'PrevHospRt'), 'sum')}</h3>\r\n\r\n              <p>Residential segregation black/white</p>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'RsiSgrBlckRt'), 'weighted_average')}</h3>\r\n\r\n              <p>Severe housing problems</p><Tooltip id=\"SvrHsngPrbRt\"/>\r\n              <h3>{aggregateProperty('chr_health_factors', colLookup(cols, currentData, 'chr_health_factors', 'SvrHsngPrbRt'), 'weighted_average')}%</h3>\r\n            </ReportSection>\r\n          }\r\n          {(chr_health_context && selectionIndex.length) && \r\n              <ReportSection>\r\n                <h2>Community Health Context<Tooltip id=\"healthcontext\"/></h2>\r\n                <h6>Source: <a href=\"https://www.countyhealthrankings.org/\" target=\"_blank\" rel=\"noopener noreferrer\">County Health Rankings</a></h6>\r\n\r\n                <p>65 and older<Tooltip id=\"Over65YearsPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'Over65YearsPrc'), 'weighted_average')}%</h3>\r\n\r\n                <p>Adult obesity<Tooltip id=\"AdObPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'AdObPrc'), 'weighted_average')}%</h3>\r\n\r\n                <p>Diabetes prevalence<Tooltip id=\"AdDibPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'AdDibPrc'), 'weighted_average')}%</h3>\r\n\r\n                <p>Adult smoking<Tooltip id=\"SmkPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'SmkPrc'), 'weighted_average')}%</h3>\r\n\r\n                <p>Excessive drinking<Tooltip id=\"ExcDrkPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'ExcDrkPrc'), 'weighted_average')}%</h3>\r\n\r\n                <p>Drug overdose deaths<Tooltip id=\"DrOverdMrtRt\"/></p>\r\n                <h3>{aggregateProperty('chr_health_context', colLookup(cols, currentData, 'chr_health_context', 'DrOverdMrtRt'), 'sum')||0}</h3>\r\n\r\n              </ReportSection>\r\n            }\r\n          {(chr_life && selectionIndex.length) &&\r\n              <ReportSection expanded={expanded}>\r\n                <h2>Length &amp; Quality of Life<Tooltip id=\"healthlife\"/></h2>\r\n                <h6>Source: <a href=\"https://www.countyhealthrankings.org/\" target=\"_blank\" rel=\"noopener noreferrer\">County Health Rankings</a></h6>\r\n                \r\n                <p>Life expectancy<Tooltip id=\"LfExpRt\"/></p>\r\n                <h3>{aggregateProperty('chr_life', colLookup(cols, currentData, 'chr_life', 'LfExpRt'), 'weighted_average')}</h3>\r\n\r\n                <p>Self-rated health<Tooltip id=\"SlfHlthPrc\"/></p>\r\n                <h3>{aggregateProperty('chr_life', colLookup(cols, currentData, 'chr_life', 'SlfHlthPrc'), 'weighted_average')}%</h3>\r\n\r\n              </ReportSection>\r\n            }\r\n          {(predictions && cols[currentData] && cols[currentData].predictions && selectionIndex.length) && \r\n              <ReportSection>\r\n                <h2>Forecasting</h2><br/>            \r\n                <h6>Source: <a href=\"https://github.com/Yu-Group/covid19-severity-prediction/\" target=\"_blank\" rel=\"noopener noreferrer\">Yu Group at Berkeley</a></h6>            \r\n                \r\n                <p>5-Day Severity Index<Tooltip id=\"SeverityIndex\"/></p>\r\n                <h3> {['','Low','Medium','High'][Math.round(aggregateProperty('predictions', 1, 'weighted_average'))]}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[2].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 2, 'sum')*10)/10}</h3>\r\n              \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[4].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 4, 'sum')*10)/10}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[6].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 6, 'sum')*10)/10}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[8].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 8, 'sum')*10)/10}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[10].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 10, 'sum')*10)/10}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[12].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 12, 'sum')*10)/10}</h3>\r\n                \r\n                <p>Predicted Deaths by {parsePredictedDate(cols[currentData].predictions[14].split('_'))}<Tooltip id=\"PredictedDeaths\"/></p>\r\n                <h3>{Math.round(aggregateProperty('predictions', 14, 'sum')*10)/10}</h3>\r\n              \r\n              </ReportSection>\r\n            }\r\n          \r\n          <div className=\"extraPadding\"></div>\r\n          \r\n          {properties && <button onClick={handleOpenClose} id=\"showHideRight\" className={panelState.info ? 'active' : 'hidden'}>{report}</button>}\r\n          {/* {properties && <ResizeButton \r\n                  id=\"resize\"\r\n                  onMouseDown={handleDown}\r\n                  onTouchStart={handleTouch}\r\n                  style={{zIndex:10}}\r\n              >\r\n                  {verticalGrip}\r\n              </ResizeButton>} */}\r\n        </ReportContainer>\r\n      </ReportWrapper>\r\n    </DataPanelContainer>\r\n  );\r\n}\r\n\r\nexport default DataPanel;","import styled from 'styled-components';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { colors } from '../config';\r\n\r\nexport const StyledDropDown = styled(FormControl)`\r\n  padding:0 0 ${props => props.component === 'radios' ? '20' : '40'}px 0!important;\r\n  color:white;\r\n  padding:0;\r\n  margin: 0 10px 40px 0;\r\n  .MuiInputBase-root {\r\n    font-family: 'Lato', sans-serif;\r\n  }\r\n  .MuiFormLabel-root {\r\n    color: white;\r\n    font-family: 'Lato', sans-serif;\r\n  }\r\n  .Mui-focused {\r\n    color: white !important;\r\n  }\r\n  .MuiInput-underline:before {\r\n    border-bottom:1px solid rgba(255,255, 255, 0.42);\r\n  }\r\n  .MuiInput-underline:after {\r\n    border-bottom: 2px solid white\r\n  }\r\n  .MuiInputBase-root {\r\n    color: white;\r\n    .MuiSvgIcon-root {\r\n      color: rgba(255,255,255,0.54);\r\n    },\r\n    .MuiPopover-paper {\r\n      color:white;\r\n    }\r\n  }\r\n  .MuiFormGroup-root {\r\n    .MuiFormControlLabel-root{\r\n      color:white;\r\n      span {\r\n        font-family: 'Lato', sans-serif;\r\n      }\r\n      .MuiRadio-root {\r\n        color: rgba(255,255,255,0.54);\r\n      }\r\n    }\r\n  }\r\n  .MuiRadio-root {\r\n    color:white;\r\n  }\r\n  .MuiRadio-colorSecondary.Mui-checked {\r\n    color:white;\r\n  }\r\n  div.radioContainer {\r\n    display:block;\r\n      .MuiFormControlLabel-root {\r\n        margin-right:0;\r\n      }\r\n      button {\r\n        transform:translateY(4px);\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const StyledDropDownNoLabel = styled(StyledDropDown)`\r\n  .MuiFormLabel-root {\r\n    display:none;\r\n  }\r\n  padding:10px 0 5px 20px !important;\r\n  label + .MuiInput-formControl {\r\n    margin-top:0;\r\n  }\r\n`\r\n\r\nexport const SwitchContainer = styled(Grid)`\r\n  padding-top:4px !important;\r\n  p { \r\n    display: inline;\r\n    color:white;\r\n    transform:translateY(5px);\r\n  }\r\n  span.MuiSwitch-track {\r\n      background-color:${colors.buttongray};\r\n  }\r\n  .MuiSwitch-colorSecondary.Mui-checked {\r\n      color:${colors.lightblue};\r\n  }\r\n  .MuiSwitch-colorSecondary.Mui-checked + .MuiSwitch-track {\r\n      background-color: ${colors.lightblue};\r\n  }\r\n  .MuiSwitch-colorSecondary:hover {\r\n      background-color:${colors.lightblue}55;\r\n  }\r\n`\r\n\r\nexport const BinsContainer = styled.div`\r\n  padding-top:4px !important;\r\n  p { \r\n    display: inline;\r\n    color:white;\r\n    transform:translateY(5px);\r\n  }\r\n  span.MuiSwitch-track {\r\n      background-color:${colors.buttongray};\r\n  }\r\n  .MuiSwitch-colorSecondary.Mui-checked {\r\n      color:${colors.lightblue};\r\n  }\r\n  .MuiSwitch-colorSecondary.Mui-checked + .MuiSwitch-track {\r\n      background-color: ${colors.lightblue};\r\n  }\r\n  .MuiSwitch-colorSecondary:hover {\r\n      background-color:${colors.lightblue}55;\r\n  }\r\n`","import React, { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport styled from 'styled-components';\r\nimport { setDate, setVariableParams, incrementDate, setMapParams } from '../actions';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport { StyledDropDownNoLabel, BinsContainer } from '../styled_components';\r\nimport { Tooltip } from '../components';\r\n// import { getParseCSV, getJson, mergeData, colIndex, getDataForBins } from './utils';\r\n\r\nconst SliderContainer = styled.div`\r\n    color: white;\r\n    box-sizing:border-box;\r\n    padding:0 20px;\r\n    width:100%;\r\n`\r\n\r\nconst PlayPauseButton = styled(Button)`\r\n    background:none;\r\n    padding:0;\r\n    margin:0;\r\n    transform:translateY(16px);\r\n    @media (max-width: 600px) {\r\n        transform:translateY(18px);\r\n    }\r\n    svg {\r\n        width: 30px;\r\n        height:30px;\r\n        @media (max-width: 600px) {\r\n            width: 20px;\r\n            height:20px;\r\n        }\r\n        g {\r\n            fill: white;\r\n        },\r\n        path {\r\n            fill:white;\r\n        }\r\n    }\r\n    &.MuiButton-text {\r\n        padding:6px 0;\r\n    }\r\n`\r\n\r\nconst LineSlider = styled(Slider)`\r\n    transform:translateY(22px);\r\n    &.MuiSlider-root {\r\n        width:70%;\r\n        margin-left:13%;\r\n        box-sizing:border-box;\r\n        @media (max-width: 600px) {\r\n            width:50%;\r\n            margin-left:24%;\r\n        }\r\n    }\r\n    span.MuiSlider-rail {\r\n        color:white;\r\n        height:4px;\r\n    }\r\n    span.MuiSlider-track {\r\n        color:white;\r\n        height:4px;\r\n    }\r\n    span.MuiSlider-thumb {\r\n        color:white;\r\n        width:15px;\r\n        height:15px;\r\n        transform:translate(-1.5px, -1.5px);\r\n        .MuiSlider-valueLabel {\r\n            transform:translateY(-10px);\r\n            pointer-events:none;\r\n            font-size:15px;\r\n            span {\r\n                background: none;\r\n            }\r\n        }\r\n    }\r\n    // .MuiSlider-valueLabel span{\r\n    //     transform:translateX(-100%);        \r\n    // }\r\n    span.MuiSlider-thumb.MuiSlider-active {\r\n        box-shadow: 0px 0px 10px rgba(200,200,200,0.5);\r\n    }\r\n`\r\n\r\nconst RangeSlider = styled(Slider)`\r\n    box-sizing:border-box;\r\n    transform:translateY(22px);\r\n    &.MuiSlider-root {\r\n        width:70%;\r\n        margin-left:13%;\r\n        box-sizing:border-box;\r\n        @media (max-width: 600px) {\r\n            width:50%;\r\n            margin-left:24%;\r\n        }\r\n    }\r\n    span.MuiSlider-rail {\r\n        color:white;\r\n        height:4px;\r\n    }\r\n    span.MuiSlider-track {\r\n        color:white;\r\n        height:4px;\r\n    }\r\n    span.MuiSlider-thumb {\r\n        color:white;\r\n        .MuiSlider-valueLabel {\r\n            transform:translateY(0px);\r\n            pointer-events:none;\r\n            span {\r\n                background: none;\r\n            }\r\n        }\r\n    }\r\n    span.MuiSlider-thumb.MuiSlider-active: {\r\n        box-shadow: 0px 0px 10px rgba(200,200,200,0.5);\r\n    }\r\n`\r\n\r\nconst DateTitle = styled.h3`\r\n    width:100%;\r\n    font-size:1.05rem;\r\n    padding:10px 0 5px 0;\r\n    margin:0;\r\n    left:0;\r\n    text-align:center;\r\n    pointer-events:none;\r\n`\r\nconst InitialDate = styled.p`\r\n    position:absolute;\r\n    left:7%;\r\n    bottom:8px;\r\n    font-size:75%;\r\n    @media (max-width: 600px) {\r\n        bottom:0px;\r\n        left:12%;\r\n    }\r\n`\r\n\r\nconst EndDate = styled(InitialDate)`\r\n    left:initial;\r\n    right:10px;\r\n`\r\n\r\nconst DateSelectorContainer = styled(Grid)`\r\n    margin:0 18px -10px 0 !important;\r\n    display:flex;\r\n    justify-items: center;\r\n    justify-content: flex-end;\r\n    align-items:center;\r\n    @media (max-width: 450px) {\r\n        margin:0 18px 22px 0 !important;\r\n    }\r\n    .MuiFormControl-root {\r\n        padding: 0 0 0 20px !important; \r\n    }\r\n    span {\r\n        font-weight:bold;\r\n    }\r\n    #dateSelector {\r\n        position:absolute;\r\n        left:50%;\r\n        transform:translateX(-50%);\r\n        @media (max-width: 600px) {\r\n            transform:none;\r\n            left:20px;\r\n        }\r\n        @media (max-width: 450px) {\r\n            transform:none;\r\n            left:0px;\r\n        }\r\n    }\r\n    #binModeSwitch {\r\n        @media (max-width: 450px) {\r\n            transform:translateY(40px);\r\n        }\r\n        .MuiSwitch-root {\r\n            height:32px;\r\n            width:50px;\r\n            padding: 0,\r\n            display: 'flex',\r\n        }\r\n        .MuiButtonBase-root {\r\n            .MuiIconButton-label {\r\n                .MuiSwitch-thumb {\r\n                    height: 12px;\r\n                    width: 12px;\r\n                    transform:translateY(1px);\r\n                }\r\n            }   \r\n        }\r\n    }\r\n`\r\nconst DateSlider = () => {\r\n    const dispatch = useDispatch();  \r\n\r\n    const currentData = useSelector(state => state.currentData);\r\n    const dates = useSelector(state => state.dates);\r\n    const dataParams = useSelector(state => state.dataParams);\r\n    const startDateIndex = useSelector(state => state.startDateIndex);\r\n    const mapParams = useSelector(state => state.mapParams);\r\n    const currentVariable = useSelector(state => state.currentVariable);\r\n    \r\n    const [timerId, setTimerId] = useState(null);\r\n    const [customRange, setCustomRange] = useState(false);\r\n    const [rangeSelectVal, setRangeSelectVal] = useState(7);\r\n    \r\n    const handleChange = (event, newValue) => {\r\n\r\n        let tempRange = null;\r\n\r\n        if ((newValue - startDateIndex < 7) && (dataParams.nRange === 7)) tempRange = newValue-startDateIndex || 1\r\n\r\n        if (dataParams.nType === \"time-series\" && dataParams.dType === \"time-series\") {\r\n            dispatch(setVariableParams({nIndex: newValue, dIndex: newValue, nRange: tempRange || dataParams.nRange, dRange: tempRange || dataParams.nRange }))\r\n        } else if (dataParams.nType === \"time-series\") {\r\n            dispatch(setVariableParams({nIndex: newValue, nRange: tempRange || dataParams.nRange}))\r\n        } else if (dataParams.dType === \"time-series\") {\r\n            dispatch(setVariableParams({dIndex: newValue, dRange: tempRange  || dataParams.nRange }))\r\n        } else if (currentVariable.includes('Testing')){\r\n            dispatch(setVariableParams({nIndex: newValue}))\r\n        }\r\n        dispatch(setDate(dates[currentData][newValue]));\r\n    };\r\n\r\n    \r\n    const handleSwitch = () => {\r\n        if (mapParams.binMode === 'dynamic') {\r\n            dispatch(setMapParams({binMode:''}))\r\n        } else {\r\n            dispatch(setMapParams({binMode:'dynamic'}))\r\n        }\r\n    }\r\n    \r\n    // const handleBinChange = (event, newValue) => {\r\n    //     dispatch(setVariableParams(\r\n    //         {\r\n    //             binIndex: newValue \r\n    //         }\r\n    //     ))\r\n    // }\r\n    \r\n    const handleRangeChange = (event, newValue) => { \r\n        if (dataParams.dRange) {\r\n            dispatch(setVariableParams(\r\n                {\r\n                    nIndex: newValue[1], \r\n                    nRange: newValue[1]-newValue[0],\r\n                    rIndex: newValue[1], \r\n                    rRange: newValue[1]-newValue[0]\r\n                }\r\n            ))\r\n        } else {\r\n            dispatch(setVariableParams(\r\n                {\r\n                    nIndex: newValue[1], \r\n                    nRange: newValue[1]-newValue[0]\r\n                }\r\n            ))\r\n        }\r\n    }\r\n\r\n    const handlePlayPause = (timerId, rate, interval) => {\r\n        if (timerId === null) {\r\n            setTimerId(setInterval(o => dispatch(incrementDate(rate)), interval))\r\n        } else {\r\n            clearInterval(timerId);\r\n            setTimerId(null)\r\n        }\r\n    }\r\n    \r\n\r\n    const handleRangeButton = (event) => {\r\n        let val = event.target.value;\r\n\r\n        if (val === 'custom') { // if swapping over to a custom range, which will use a 2-part slider to scrub the range\r\n            setCustomRange(true)\r\n            if (dataParams.nType === \"time-series\" && dataParams.dType === \"time-series\") {\r\n                dispatch(setVariableParams({nRange: 30, dRange: 30}))\r\n            } else if (dataParams.nType === \"time-series\") {\r\n                dispatch(setVariableParams({nRange: 30}))\r\n            } else if (dataParams.dType === \"time-series\") {\r\n                dispatch(setVariableParams({dRange: 30}))\r\n            } \r\n        } else { // use the new value -- null for cumulative, 1 for daily, 7 for weekly\r\n            setCustomRange(false)\r\n            if (dataParams.nType === \"time-series\" && dataParams.dType === \"time-series\") {\r\n                dispatch(setVariableParams({nRange: val, dRange: val}))\r\n            } else if (dataParams.nType === \"time-series\") {\r\n                dispatch(setVariableParams({nRange: val}))\r\n            } else if (dataParams.dType === \"time-series\") {\r\n                dispatch(setVariableParams({dRange: val}))\r\n            }    \r\n        }\r\n        \r\n        setRangeSelectVal(val);\r\n    }\r\n\r\n    const valuetext = (value) => `${dates[currentData][value-startDateIndex].slice(0,-3)}`;\r\n    \r\n    const formatDate = (date) => {\r\n        const options = { year: 'numeric', month: 'long', day: 'numeric' };\r\n        let rawDate = new Date(date);\r\n        rawDate.setDate(rawDate.getDate() + 1);\r\n        return rawDate.toLocaleDateString('en-US', options);\r\n    }\r\n    \r\n    const cleanRanges = {\r\n        null: 'Cumulative',\r\n        1: 'Daily New',\r\n        7: '7-Day Average'\r\n    }\r\n\r\n    if (dates[currentData] !== undefined) {\r\n        return (\r\n            <SliderContainer style={{display: ((dataParams.nType === 'time-series' || currentVariable.includes('Testing')) ? 'initial' : 'none')}}>\r\n                <Grid container spacing={2} style={{display:'flex', padding: '0 0 10px 0'}}>\r\n                    {currentVariable.includes('Testing') && \r\n                        <DateSelectorContainer item xs={12}>\r\n                            <DateTitle>{formatDate(`${dates[currentData][dataParams.nIndex-startDateIndex]}`)}</DateTitle>\r\n                        </DateSelectorContainer>\r\n                    }\r\n                    {dataParams.nType !== 'characteristic' && \r\n                        <DateSelectorContainer item xs={12}>\r\n                            <StyledDropDownNoLabel id=\"dateSelector\">\r\n                                <InputLabel htmlFor=\"date-select\">Date Range</InputLabel>\r\n                                <Select  \r\n                                    id=\"date-select\"\r\n                                    value={''}\r\n                                    onChange={handleRangeButton}\r\n                                    displayEmpty\r\n                                    inputProps={{ 'aria-label': 'Without label' }}\r\n                                >\r\n                                    <MenuItem value=\"\" disabled style={{display:'none'}}>\r\n                                        {!customRange && <span>{formatDate(dates[currentData][dataParams.nIndex-startDateIndex])} ({cleanRanges[rangeSelectVal]})</span>}\r\n                                        {customRange && 'Custom Range'}\r\n                                    </MenuItem>\r\n                                    <MenuItem value={null} key={'cumulative'}>Cumulative</MenuItem>\r\n                                    <MenuItem value={1} key={'daily'}>Daily New</MenuItem>\r\n                                    <MenuItem value={7} key={'7-day-ave'}>7-Day Average</MenuItem>\r\n                                    <MenuItem value={'custom'} key={'customRange'}>Custom Range</MenuItem>\r\n                                </Select>\r\n                            </StyledDropDownNoLabel>\r\n\r\n                            <BinsContainer item xs={12} \r\n                                id=\"binModeSwitch\"\r\n                            >\r\n                                <Switch\r\n                                    checked={mapParams.binMode === 'dynamic'}\r\n                                    onChange={handleSwitch}\r\n                                    name=\"bin chart switch\"\r\n                                />\r\n                                <p>{mapParams.binMode === 'dynamic' ? 'Dynamic' : 'Fixed Bins'}<Tooltip id=\"BinModes\"/></p>\r\n                            </BinsContainer>\r\n                        </DateSelectorContainer>\r\n                    }\r\n                    \r\n                    \r\n                    <Grid item xs={1}>\r\n                        <PlayPauseButton id=\"playPause\" onClick={() => handlePlayPause(timerId, 1, 100)}>\r\n                            {timerId === null ? \r\n                                <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\" ><path d=\"M78.627,47.203L24.873,16.167c-1.082-0.625-2.227-0.625-3.311,0C20.478,16.793,20,17.948,20,19.199V81.27  c0,1.25,0.478,2.406,1.561,3.031c0.542,0.313,1.051,0.469,1.656,0.469c0.604,0,1.161-0.156,1.703-0.469l53.731-31.035  c1.083-0.625,1.738-1.781,1.738-3.031C80.389,48.984,79.71,47.829,78.627,47.203z\"></path></svg>\r\n                                : \r\n                                <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\r\n                                    <g transform=\"translate(50 50) scale(0.69 0.69) rotate(0) translate(-50 -50)\">\r\n                                        <g>\r\n                                            <path d=\"M22.4,0.6c3.4,0,6.8,0,10.3,0c6.5,0,11.8,5.3,11.8,11.8c0,25,0,50.1,0,75.2c0,6.5-5.3,11.8-11.8,11.8\r\n                                                c-3.4,0-6.8,0-10.3,0c-6.5,0-11.8-5.3-11.8-11.8c0-25.1,0-50.2,0-75.2C10.6,5.9,15.9,0.6,22.4,0.6z M22.4,6.5c3.4,0,6.8,0,10.3,0\r\n                                                c3.2,0,5.9,2.6,5.9,5.9c0,25,0,50.1,0,75.2c0,3.2-2.7,5.9-5.9,5.9c-3.4,0-6.8,0-10.3,0c-3.2,0-5.9-2.7-5.9-5.9\r\n                                                c0-25.1,0-50.2,0-75.2C16.5,9.1,19.2,6.5,22.4,6.5z M67.3,6.5c3.4,0,6.8,0,10.2,0s6,2.6,6,5.9c0,25,0,50.1,0,75.2\r\n                                                c0,3.2-2.7,5.9-6,5.9s-6.7,0-10.2,0c-3.3,0-5.9-2.7-5.9-5.9c0-25.1,0-50.2,0-75.2C61.4,9.1,64,6.5,67.3,6.5z M67.3,0.6\r\n                                                c3.4,0,6.8,0,10.2,0c6.5,0,11.8,5.3,11.8,11.8c0,25,0,50.1,0,75.2c0,6.5-5.3,11.8-11.8,11.8c-3.3,0-6.7,0-10.2,0\r\n                                                c-6.5,0-11.8-5.3-11.8-11.8c0-25.1,0-50.2,0-75.2C55.5,5.9,60.8,0.6,67.3,0.6z\"/>\r\n                                        </g>\r\n                                    </g>\r\n                                </svg>\r\n\r\n                            }\r\n                        </PlayPauseButton>\r\n                    </Grid>\r\n                    <Grid item xs={11}> {/* Sliders Grid Item */}\r\n                        {/* Main Slider for changing date */}\r\n                        {!customRange && \r\n                            <LineSlider \r\n                                value={dataParams.nIndex} \r\n                                // valueLabelDisplay=\"on\"\r\n                                onChange={handleChange} \r\n                                // getAriaValueText={valuetext}\r\n                                // valueLabelFormat={valuetext}\r\n                                // aria-labelledby=\"aria-valuetext\"\r\n                                min={startDateIndex}\r\n                                step={1}\r\n                                max={startDateIndex+dates[currentData].length-1}\r\n                        />}\r\n                        {/* Slider for bin date */}\r\n                        {/* {!customRange && \r\n                            <BinSlider \r\n                                value={dataParams.binIndex} \r\n                                valueLabelDisplay=\"auto\"\r\n                                onChange={handleBinChange} \r\n                                getAriaValueText={binValuetext}\r\n                                valueLabelFormat={binValuetext}\r\n                                aria-labelledby=\"aria-valuetext\"\r\n                                min={startDateIndex}\r\n                                step={1}\r\n                                max={startDateIndex+dates[currentData].length-1}\r\n                        />} */}\r\n                        {/* Slider for changing date range */}\r\n                        {customRange && <RangeSlider \r\n                            value={[dataParams.nIndex-dataParams.nRange, dataParams.nIndex]} \r\n                            valueLabelDisplay=\"on\"\r\n                            onChange={handleRangeChange} \r\n                            getAriaValueText={valuetext}\r\n                            valueLabelFormat={valuetext}\r\n                            aria-labelledby=\"aria-valuetext\"\r\n                            min={startDateIndex}\r\n                            step={1}\r\n                            max={startDateIndex+dates[currentData].length-1}\r\n                        />}\r\n                    </Grid>\r\n                    {!customRange && <InitialDate>{dates[currentData][0]}</InitialDate>}\r\n                    {!customRange && <EndDate>{dates[currentData][dates[currentData].length-1]}</EndDate>}\r\n                </Grid>\r\n            </SliderContainer>\r\n        );\r\n    } else {\r\n        return <SliderContainer />\r\n    }\r\n}\r\n\r\nexport default DateSlider","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport styled from 'styled-components';\r\nimport { chart, info } from '../config/svg';\r\nimport { colors } from '../config';\r\n\r\nimport { setPanelState } from '../actions';\r\n\r\nconst DockContainer = styled.div`\r\n    position:absolute;\r\n    left:calc(100% + 2px);\r\n    top:-2px;\r\n    display:flex;\r\n    @media (max-width:1024px) {\r\n        position:fixed;\r\n        display:block;\r\n        left:0px;\r\n        top:210px;\r\n    }\r\n    @media (max-width:600px) {\r\n        top:260px;\r\n    }\r\n`\r\n\r\nconst DockButton = styled.button`\r\n    background:${props => props.isActive ? colors.lightgray : colors.gray};\r\n    border:none;\r\n    outline:none;\r\n    padding:10px;\r\n    height:40px;\r\n    box-sizing:border-box;\r\n    font-family:'Lato', sans-serif;\r\n    font-weight:bold;\r\n    margin:2px 2px 0 0;\r\n    box-shadow: 2px 0px 5px rgba(0,0,0,0.7);\r\n    cursor:pointer;\r\n    border-radius: 5px;\r\n    transition:150ms transform, 150ms background;\r\n    font-size:115%;\r\n    display:inline-block;\r\n    svg {\r\n        width:20px;\r\n        height:20px;\r\n        fill:${props => props.isActive ? colors.darkgray : colors.white};\r\n    }\r\n    &:hover {\r\n        background:${props => props.isActive ? colors.white : colors.darkgray};\r\n        svg {\r\n            fill:${props => props.isActive ? colors.darkgray : colors.lightgray};\r\n        }\r\n    }\r\n    @media (max-width:1024px) {\r\n        height:40px;\r\n        width:40px;\r\n        margin-top:10px;\r\n        display:block;\r\n        border-radius:0;\r\n    }\r\n    \r\n    @media (max-width:600px) {\r\n        height:30px;\r\n        width:30px;\r\n        padding:0;\r\n        svg {\r\n            width:20px;\r\n            height:20px;\r\n        }\r\n    }\r\n`\r\n\r\nconst Dock = () => {\r\n    const panelState = useSelector(state => state.panelState);\r\n    const dispatch = useDispatch();\r\n    const handlePanelButton = (panel) => panelState[panel] ? dispatch(setPanelState({[panel]: false})) : dispatch(setPanelState({[panel]: true}))\r\n    return (\r\n        <DockContainer>\r\n            <DockButton\r\n                title=\"Show Line Chart\"\r\n                isActive={panelState.lineChart}\r\n                onClick={() => handlePanelButton('lineChart')}\r\n            >   \r\n                {chart}\r\n            </DockButton>\r\n            <DockButton\r\n                title=\"Show Tutorial\"\r\n                isActive={panelState.tutorial}\r\n                onClick={() => handlePanelButton('tutorial')}\r\n            >\r\n                {info}\r\n            </DockButton>\r\n        </DockContainer>\r\n    )\r\n} \r\n\r\nexport default Dock","import React, { useState, useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport styled from 'styled-components'\r\n\r\nimport { colors } from '../config';\r\nimport { setPanelState } from '../actions';\r\n\r\nconst DragContainer = styled.div`\r\n    position:fixed;\r\n    overflow:hidden;\r\n    background:${colors.gray};\r\n    padding:20px 20px 0 20px;\r\n    box-sizing: border-box;\r\n    box-shadow: 0px 0px 5px rgba(0,0,0,0.7);\r\n    border-radius: 0.5vh;\r\n    &.collapsed {\r\n        display:none;\r\n    };\r\n`\r\nconst DragButton = styled.button`\r\n    position:absolute;\r\n    left:0;\r\n    top:5px;\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    cursor:move;\r\n    svg {\r\n        fill:white;\r\n        width:20px;\r\n        height:20px;\r\n    }\r\n`\r\n\r\n\r\nconst CollapseButton = styled.button`\r\n    position: absolute;\r\n    top: 3px;\r\n    right: 5px;\r\n    font-size: 200%;\r\n    cursor: pointer;\r\n    padding:0;\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    color:white;\r\n    p {\r\n        font-size:50%;\r\n        display:inline;\r\n        font-family:'Montserrat', sans-serif;\r\n        line-height:1;\r\n    }\r\n    svg {\r\n        fill:white;\r\n        width:40px;\r\n        height:30px;\r\n    }\r\n`\r\n\r\nconst Draggable = (props) => {\r\n    const dispatch = useDispatch();\r\n    const open = useSelector(state => state.panelState[props.title]);\r\n\r\n    const [X, setX] = useState(props.defaultX);\r\n    const [Y, setY] = useState(props.defaultY);\r\n    const [isDragging, setIsDragging] = useState(false)\r\n\r\n    const listener = (e) => {\r\n        setX(prevWidth => prevWidth+e.movementX)\r\n        setY(prevHeight => prevHeight+e.movementY)\r\n    }\r\n\r\n    const touchListener = (e) => {\r\n        setX(e?.targetTouches[0]?.clientX-15)\r\n        setY(e?.targetTouches[0]?.clientY-15)\r\n    }\r\n\r\n    const removeListener = () => {\r\n        window.removeEventListener('mousemove', listener)\r\n        window.removeEventListener('mouseup', removeListener)\r\n        setIsDragging(false)\r\n    }\r\n\r\n    const removeTouchListener = () => {\r\n        window.removeEventListener('touchmove', touchListener);\r\n        window.removeEventListener('touchend', removeTouchListener);\r\n    }\r\n    \r\n    const handleDown = () => {\r\n        window.addEventListener('mousemove', listener)\r\n        window.addEventListener('mouseup', removeListener)\r\n        setIsDragging(true)\r\n    }\r\n\r\n    const handleTouch = () => {\r\n        window.addEventListener('touchmove', touchListener)\r\n        window.addEventListener('touchend', removeTouchListener)\r\n    }\r\n\r\n    const handleCollapse = () => dispatch(setPanelState({[props.title]: false}))\r\n\r\n    useEffect(() => {\r\n        setX(props.defaultX);\r\n        setY(props.defaultY);\r\n    },[open, props.defaultX, props.defaultY])\r\n\r\n    return (\r\n        <DragContainer style={{left:`${X}px`, top: `${Y}px`, zIndex: props.z || 1}} className={open ? '' : 'collapsed'} isDragging={isDragging}>\r\n            {props.content}\r\n            <DragButton \r\n                id=\"resize\"\r\n                onMouseDown={handleDown}\r\n                onTouchStart={handleTouch}\r\n                style={{zIndex:10}}\r\n            >\r\n                <svg viewBox=\"0 0 64 64\" x=\"0px\" y=\"0px\"><g><path d=\"M53.39,32.57a1.52,1.52,0,0,0-.33-1.63l-5.84-5.85a1.51,1.51,0,0,0-2.13,2.13l3.29,3.28H33.5V15.62l3.28,3.29a1.51,1.51,0,0,0,2.13-2.13l-5.85-5.84a1.5,1.5,0,0,0-2.12,0l-5.85,5.84a1.51,1.51,0,0,0,2.13,2.13l3.28-3.29V30.5H15.62l3.29-3.28a1.51,1.51,0,0,0-2.13-2.13l-5.84,5.85a1.5,1.5,0,0,0,0,2.12l5.84,5.85a1.51,1.51,0,0,0,2.13-2.13L15.62,33.5H30.5V48.38l-3.28-3.29a1.51,1.51,0,0,0-2.13,2.13l5.85,5.84a1.5,1.5,0,0,0,2.12,0l5.85-5.84a1.51,1.51,0,0,0-2.13-2.13L33.5,48.38V33.5H48.38l-3.29,3.28a1.51,1.51,0,0,0,2.13,2.13l5.84-5.85A1.51,1.51,0,0,0,53.39,32.57Z\"></path></g></svg>\r\n            </DragButton>\r\n            <CollapseButton onClick={handleCollapse}>×</CollapseButton>\r\n        </DragContainer>\r\n    )\r\n}\r\n\r\nexport default Draggable;","import React, {useState} from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport { colors } from '../config';\r\n\r\nconst InfoContainer = styled.div`\r\n    background: ${colors.gray};\r\n    color: ${colors.white};\r\n    padding: 0;\r\n    overflow: hidden;\r\n    display: ${props => props.active ? 'initial' : 'none'};\r\n    border-radius: 4px;\r\n    -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    box-shadow: 0 0 0 2px rgba(0,0,0,.1);\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    svg {\r\n        width: 10px;\r\n        height: 10px;\r\n        padding: 5px;\r\n        fill: ${colors.white};\r\n        display: inline;\r\n        transition: 250ms all;\r\n        cursor: pointer;\r\n    }\r\n    a {\r\n       color: ${colors.yellow}; \r\n       text-decoration:none;\r\n    }\r\n    @media (max-width:1024px) {\r\n        right:50%;\r\n        bottom:50%;\r\n        transform: translate(50%, 50%);\r\n        overflow:hidden;\r\n        -moz-box-shadow: 0 0 5px rgba(0,0,0,.2);\r\n        -webkit-box-shadow: 0 0 5px rgba(0,0,0,.2);\r\n        box-shadow: 0 0 0 5px rgba(0,0,0,.2);\r\n    }\r\n`\r\n\r\nconst PanelContainer = styled.div`\r\n    height: 100%;\r\n    position: absolute;\r\n    top: 0;\r\n    left: ${props => props.position*-100}%;\r\n    display: flex;\r\n    -ms-flex: 1;\r\n    transition: 250ms all;\r\n    width: ${props => props.panelCount*100}%;\r\n`\r\n\r\nconst Panel = styled.div`\r\n    width: 100%;\r\n    height: 100%;\r\n    padding: 20px;\r\n    box-sizing: border-box;\r\n    h3 {\r\n        margin:0;\r\n    }\r\n    p.subtitle {\r\n        font-size:75%;\r\n        padding:0;\r\n        margin:1px;\r\n    } \r\n    ul {\r\n       padding-inline-start: 15px;\r\n    }\r\n    img {\r\n        width: 25px;\r\n        height: 25px;\r\n        padding:5px 10px 0 0;\r\n        transition: 250ms all;\r\n        opacity: 0.7;\r\n    }\r\n    img:hover {\r\n        opacity:1;\r\n    }\r\n\r\n`\r\n\r\nconst DotsContainer = styled.div`\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    display: flex;\r\n    justify-content: space-around;\r\n    width: calc(100% - 60px);\r\n    height: 25px;\r\n    margin-left: 30px;\r\n    padding: 0 20px;\r\n    box-sizing: border-box;\r\n`\r\n\r\nconst Dot = styled.button`\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    &.active {\r\n        svg {\r\n            transform: scale(1.5);\r\n        }\r\n    }\r\n`\r\n\r\nconst Arrow = styled.svg`\r\n    position: absolute;\r\n    bottom:0;\r\n    &#right-arrow {\r\n        right: 0;\r\n        width: 20px;\r\n        height: 20px;\r\n    }\r\n    &#left-arrow {\r\n        left: 0;\r\n        transform: rotate(180deg);\r\n        width: 20px;\r\n        height: 20px;\r\n    }\r\n`\r\n\r\nconst InfoBox = () => {\r\n    const panelOpen = useSelector(state => state.panelState.tutorial)\r\n\r\n    const [panelPosition, setPanelPosition] = useState(0);\r\n\r\n    const panels = [\r\n        {\r\n            title:`Welcome to the US Covid Atlas v2`,\r\n            subtitle:`1/4 Notes`,\r\n            content: `Welcome to the refactored US Covid Atlas. We have greatly expanded the functionality,\r\n            usability, and portability of the Atlas by refactoring the project into the frontend framework, React.\r\n            <br/><br/>While we've worked to maintain the general structure of the Atlas, we've introduced a few new features\r\n            and interface elements we hope will make the Atlas more robust and usable for more people.`\r\n        },\r\n        {\r\n            title:`New Features`,\r\n            subtitle:`January Release Notes`,\r\n            content:`<ul>\r\n                <li>New data available: New York Times State and County Data, CDC County Data with County-Level Testing Data</li>\r\n                <li>New map view: 3D style map visualization</li>\r\n                <li>Improved line chart module: Click the line chart button by the time slider to view</li>\r\n                <li>Time range selection: You can now select a specific time range by click the time drop down in the time slider</li>\r\n                <li>Multiple selection: By holding down the Control or Command key, you can select and aggregate stats from multiple geographies</li>\r\n                <li>Improved report panel: New visual styles have been added to the report panel</li>\r\n            </ul>`\r\n        },\r\n        // {\r\n        //     title:`Getting Started`,\r\n        //     subtitle:`November Release Notes`,\r\n        //     content:`To get started, try the following:\r\n        //     <ul>\r\n        //       <li>Click the play button in the <a href=\"#\" onclick=\"highlightElement('sliderdiv', 'id')\">timeline</a> on the top of the page to see how the pandemic has unfolded</li>\r\n        //       <li>Explore <a href=\"#\" onclick=\"highlightElement('select-source', 'id')\">state level data</a> on testing positivity rates and capacities</li>\r\n        //       <li>Use the <a href=\"#\" onclick=\"highlightElement('mapboxgl-ctrl-geolocate', 'class')\">geolocation</a> function and <a href=\"#\" onclick=\"highlightElement('select-resource', 'id')\">Health Clinics layers</a> to find COVID-19 testing near you</li>\r\n        //       <li><a href=\"#\" onclick=\"highlightElement('share-container', 'id')\">Share your map</a> on Social Media, or with a colleague or community member</li>\r\n        //     </ul>`\r\n        // },\r\n        {\r\n            title:`Found a bug or have a suggestion?`,\r\n            subtitle:`November Release Notes`,\r\n            content:`The US Covid Atlas team is always working to improve the platform and its ability to generate insights.<br><br>\r\n                Please contact the team at <a href=\"mailto:contact@theuscovidatlas.org\">contact@theuscovidatlas.org</a>\r\n                or reach out on social media below.\r\n                <div class=\"social-container\">\r\n                    <a href=\"https://twitter.com/covid_atlas\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        <img src=\"${process.env.PUBLIC_URL}/icons/twitter-icon.png\" alt=\"Twitter Icon\">\r\n                    </a>\r\n                    <a href=\"https://github.com/GeoDaCenter/covid\"  target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        <img src=\"${process.env.PUBLIC_URL}/icons/github-icon.png\" alt=\"Twitter Icon\">\r\n                    </a>\r\n                </div>`\r\n        }\r\n    ]\r\n    return (\r\n        <InfoContainer active={panelOpen}>\r\n            <PanelContainer panelCount={panels.length} position={panelPosition}>\r\n                {panels.map((panel,index) => {\r\n                    return (\r\n                        <Panel key={`panel-${index}`}>\r\n                            <h3>{panel.title}</h3>\r\n                            <p className=\"subtitle\">{panel.subtitle}</p>\r\n                            <p dangerouslySetInnerHTML={{__html: panel.content}}></p>\r\n                        </Panel>\r\n                    )\r\n                })}\r\n            </PanelContainer>\r\n            <DotsContainer>\r\n                {panels.map((panel,index) => {\r\n                    return (\r\n                        <Dot key={`dot-${index}`} onClick={() => setPanelPosition(index)} className={panelPosition === index ? 'active' : ''}>\r\n                            <svg viewBox=\"0 0 100 100\" className=\"dot\"><circle cx=\"50\" cy=\"50\" r=\"40\"></circle></svg>\r\n                        </Dot>\r\n                    )\r\n                })}\r\n            </DotsContainer>\r\n            <Arrow viewBox=\"0 0 100 100\" id=\"right-arrow\" onClick={() => setPanelPosition(prev => (prev+1) % panels.length)}><g transform=\"translate(0,-952.36218)\"><path d=\"m 71.20311,1002.3622 -2.84375,-3.28121 -31.99997,-37 -7.5625,6.5624 29.15622,33.71881 -29.15622,33.7188 7.5625,6.5624 31.99997,-37 2.84375,-3.2812 z\"></path></g></Arrow>\r\n            <Arrow viewBox=\"0 0 100 100\" id=\"left-arrow\" onClick={() => setPanelPosition(prev => (prev-1) >= 0 ? prev-1 : panels.length-1)}><g transform=\"translate(0,-952.36218)\"><path d=\"m 71.20311,1002.3622 -2.84375,-3.28121 -31.99997,-37 -7.5625,6.5624 29.15622,33.71881 -29.15622,33.7188 7.5625,6.5624 31.99997,-37 2.84375,-3.2812 z\"></path></g></Arrow>\r\n        </InfoContainer>\r\n    )\r\n}\r\n\r\nexport default InfoBox;","import React from 'react';\r\nimport { Tooltip } from '../components';\r\n\r\nconst BinsList = (props) => {\r\n    let bins = props.data;\r\n\r\n    if (bins.slice(-1,)[0] === '>'+bins.slice(-2,-1)[0]) {\r\n        bins.splice(-2,1)\r\n    }\r\n    return (\r\n        (bins.map((bin, index) => \r\n            <div className=\"bin label\" key={`${bin}_${index}`}>\r\n                {bin.indexOf('tooltip') === -1 && bin}\r\n                {bin.indexOf('tooltip') !== -1 && <span>{bin.split(' tooltip:')[0]}<Tooltip id={bin.split(' tooltip:')[1]} /></span>}\r\n            </div>\r\n            )\r\n        )\r\n    )\r\n}\r\n\r\nexport default BinsList;","import React from 'react';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { useSelector } from 'react-redux';\r\nimport styled from 'styled-components';\r\nimport BinsList from './binsList';\r\n\r\nconst LegendContainer = styled.div`\r\n    width:100%;\r\n    padding:10px;\r\n    margin:0;\r\n    box-sizing: border-box;\r\n    div.MuiGrid-item {\r\n        padding:5px 5px 0 5px;\r\n    }\r\n`\r\n\r\nconst LegendTitle = styled.h3`\r\n    text-align: center;\r\n    font-family:'Playfair Display', serif;\r\n    padding:0;\r\n    font-weight:normal;\r\n    margin:0;\r\n    color:white;\r\n`\r\n\r\nconst BinLabels = styled.div`\r\n    width:100%;\r\n    display: flex;\r\n    margin-top:0px;\r\n    box-sizing: border-box;\r\n    padding: 0 ${props => props.binLength > 6 ? 100/props.binLength/2-1 : 0}%;\r\n    .bin { \r\n        height:10px;\r\n        display: inline;\r\n        border:0;\r\n        margin:0;\r\n        flex:2;\r\n        color:white;\r\n        font-size:10px;\r\n        text-align: center;\r\n    }\r\n    .bin:nth-of-type(1) {\r\n        transform: ${props => props.firstBinZero ? 'translateX(-45%)' : 'none'};\r\n    }\r\n`\r\nconst BinBars = styled.div`\r\n    width:100%;\r\n    display: flex;\r\n    margin-top:3px;\r\n    box-sizing: border-box;\r\n    .bin { \r\n        height:5px;\r\n        display: inline;\r\n        flex:1;\r\n        border:0;\r\n        margin:0;\r\n    }\r\n    .bin:nth-of-type(1) {\r\n        transform: ${props => props.firstBinZero ? 'scaleX(0.35)' : 'none'};\r\n    }\r\n`\r\n\r\n\r\nconst Legend =  () => {\r\n    \r\n    const mapParams = useSelector(state => state.mapParams)\r\n    const title = useSelector(state => state.currentVariable)\r\n\r\n    return (\r\n        <LegendContainer>\r\n            <Grid container spacing={2} id='legend-bins-container'>\r\n                <Grid item xs={12}>\r\n                    <LegendTitle>\r\n                        {title}\r\n                    </LegendTitle>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <BinBars firstBinZero={`${mapParams.colorScale[0]}` === `240,240,240` && mapParams.fixedScale === null}>\r\n                        {\r\n                            mapParams.colorScale !== undefined && \r\n                            mapParams.colorScale.map(color => <div className=\"bin color\" key={`${color[0]}${color[1]}`}style={{backgroundColor:`rgb(${color[0]},${color[1]},${color[2]})`}}></div>)\r\n                        }\r\n                    </BinBars>\r\n                    <BinLabels firstBinZero={`${mapParams.colorScale[0]}` === `240,240,240`} binLength={mapParams.bins.bins.length}>\r\n                        {(`${mapParams.colorScale[0]}` === `240,240,240` && mapParams.fixedScale === null) && <div className=\"bin firstBin\">0</div>}\r\n\r\n                        {\r\n                            mapParams.bins.bins !== undefined && \r\n                            <BinsList data={mapParams.bins.bins} />\r\n                        }\r\n                        \r\n                    </BinLabels>\r\n                </Grid>\r\n            </Grid>\r\n        </LegendContainer>\r\n    )\r\n}\r\n\r\nexport default Legend","import React, {useState} from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport {\r\n  LineChart, Line, XAxis, YAxis, ReferenceArea, \r\n  Tooltip, Label, ResponsiveContainer, Legend\r\n} from 'recharts';\r\n\r\nimport Switch from '@material-ui/core/Switch';\r\n\r\nimport styled from 'styled-components';\r\nimport { colors } from '../config';\r\nimport { setVariableParams, setDate } from '../actions';\r\n\r\nconst ChartContainer = styled.span`\r\n    span {\r\n        color:white;\r\n    }\r\n`\r\n\r\nconst StyledSwitch = styled.div`\r\n    float:left;\r\n    p {\r\n        color:white;\r\n        display:inline;\r\n    }\r\n    span.MuiSwitch-track {\r\n        background-color:${colors.lightgray};\r\n    }\r\n    .MuiSwitch-colorSecondary.Mui-checked {\r\n        color:${colors.lightblue};\r\n    }\r\n    .MuiSwitch-colorSecondary.Mui-checked + .MuiSwitch-track {\r\n        background-color: ${colors.lightblue};\r\n    }\r\n    .MuiSwitch-colorSecondary:hover {\r\n        background-color:${colors.lightblue}55;\r\n    }\r\n`\r\n\r\n\r\nconst ChartTitle = styled.h3`\r\n    text-align: center;\r\n    font-family:'Playfair Display', serif;\r\n    padding:0;\r\n    font-weight:normal;\r\n    margin:0;\r\n    color:white;\r\n`\r\n\r\nconst LegendList = styled.ul`\r\n    list-style:none;\r\n    margin-block-start: 0;\r\n    margin-block-end: 0;\r\n    padding-inline-start: 0;\r\n    text-align:center;\r\n`\r\n\r\nconst LegendItem = styled.li`\r\n    color: ${props => props.color};\r\n    font-family:'Lato', sans-serif;\r\n    line-height:1.5;\r\n    text-decoration: ${props => props.active ? 'underline' : 'none'};\r\n    display:inline;\r\n    margin-right:10px;\r\n\r\n`\r\n\r\n\r\nconst monthNames = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"June\", \"July\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\n\r\nconst millionFormatter = val => { return `${val/1000000}M` };\r\nconst thousandFormatter = val => { return `${val/1000}K` };\r\nconst dateFormatter = val => { \r\n    let tempDate = new Date(val).getMonth();\r\n    return `${monthNames[tempDate]}`\r\n};\r\n\r\nconst CustomTick = props => {\r\n    return <text {...props}>{props.labelFormatter(props.payload.value)}</text>\r\n};\r\n\r\nconst getStartDate = (range, index, data) => {\r\n    if (range === null) {\r\n        try {\r\n            return data.slice(0,1)[0].date\r\n        } catch {\r\n            return null\r\n        }\r\n    } else {\r\n        try {\r\n            return data[index-range].date\r\n        } catch {\r\n            return null\r\n        }\r\n    }\r\n}\r\n\r\nconst getEndDate = (index, data) => {\r\n    try {\r\n        return data[index].date;\r\n    } catch {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst getDateRange = ({startDate, endDate}) => {\r\n    let dateArray = [];\r\n\r\n    let years;\r\n\r\n    if (startDate.getUTCFullYear() === endDate.getUTCFullYear()) {\r\n        years = [endDate.getUTCFullYear()]\r\n    } else {\r\n        years = []\r\n        for (let i=startDate.getUTCFullYear(); i<endDate.getUTCFullYear(); i++) {\r\n            years.push(i)\r\n        }\r\n    }\r\n\r\n    for (let i=0; i<years.length; i++){\r\n        let yearStr = ''+years[i]\r\n        let n;\r\n    \r\n        if (years[i] === 2020) {\r\n            n = 2\r\n        } else {\r\n            n = 1\r\n        }\r\n        while (n<13) {\r\n            let dateString = `${n}/${1}/${yearStr.slice(-2,)}`\r\n            if (new Date(dateString) > endDate) break\r\n            dateArray.push(dateString)\r\n            n++\r\n        }\r\n    }\r\n\r\n    return dateArray;\r\n}\r\n\r\nconst CustomTooltip = props => {\r\n    if (props.active) {\r\n        let data = props.payload\r\n        return (\r\n            <div \r\n                style={{\r\n                    background:colors.darkgray,\r\n                    padding:'1px 10px',\r\n                    borderRadius:'4px',\r\n                    boxShadow: '0px 5px 5px -3px rgba(0,0,0,0.2), 0px 8px 10px 1px rgba(0,0,0,0.14), 0px 3px 14px 2px rgba(0,0,0,0.12)'\r\n            \r\n            }}> \r\n            <p style={{color:'white', padding:0,}}>{data[0].payload.date}</p>\r\n                {data.map(data => \r\n                    <p style={{color: data.color, textShadow: `2px 2px 4px ${colors.black}`, fontWeight:600}}>{data.name}: {Number.isInteger(Math.floor(data.payload[data.dataKey])) ? \r\n                        Math.floor(data.payload[data.dataKey]).toLocaleString('en') \r\n                        : data.payload[data.dataKey]}\r\n                    </p>\r\n                    \r\n                )}\r\n            </div>\r\n        )\r\n    }\r\n    return null;\r\n};\r\n\r\nconst MainLineChart = () => {\r\n    const chartData = useSelector(state => state.chartData);\r\n    const dataParams = useSelector(state => state.dataParams);\r\n    const currentVariable = useSelector(state => state.currentVariable);\r\n    const dates = useSelector(state => state.dates);\r\n    const currentData = useSelector(state => state.currentData);\r\n    const startDateIndex = useSelector(state => state.startDateIndex);\r\n    const selectionKeys = useSelector(state => state.selectionKeys);\r\n\r\n    \r\n    const [logChart, setLogChart] = useState(false);\r\n    const [strokeOpacities, setStrokeOpacities] = useState([])\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSwitch = () => {\r\n        setLogChart(prev => !prev);\r\n    }\r\n\r\n    const chartSetDate = (e) => {\r\n        if (e?.activeTooltipIndex !== undefined) handleChange(e.activeTooltipIndex+startDateIndex)\r\n    }    \r\n\r\n    const handleChange = (newValue) => {\r\n        if (dataParams.nType === \"time-series\" && dataParams.dType === \"time-series\") {\r\n            dispatch(setVariableParams({nIndex: newValue, dIndex: newValue}))\r\n        } else if (dataParams.nType === \"time-series\") {\r\n            dispatch(setVariableParams({nIndex: newValue}))\r\n        } else if (dataParams.dType === \"time-series\") {\r\n            dispatch(setVariableParams({dIndex: newValue}))\r\n        } else if (currentVariable.includes('Testing')){\r\n            dispatch(setVariableParams({nIndex: newValue}))\r\n        }\r\n        dispatch(setDate(dates[currentData][newValue]));\r\n    };\r\n\r\n    const getMax = ({ array, variables }) => {\r\n        let maxVals = {}\r\n\r\n        for (let i=0;i<array.length;i++) {\r\n            for (let n=0;n<variables.length;n++){\r\n                let tempVal = array[i][variables[n]];\r\n                if (maxVals[variables[n]]===undefined || maxVals[variables[n]] < tempVal) {\r\n                    maxVals[variables[n]] = tempVal\r\n                }\r\n            }\r\n        }\r\n\r\n        return maxVals\r\n    }\r\n\r\n    const rangeIncrement = ({ maximum, increment }) => {\r\n        let returnArray = []\r\n        \r\n        for (let i=0; i<maximum; i+=increment) {\r\n            returnArray.push(i)\r\n        }\r\n\r\n        return returnArray;\r\n    }\r\n\r\n    const summarizeChartData = ( { chartData, keys }) => {\r\n        let summarizedData = []\r\n\r\n        for (let i=0;i<chartData.length;i++) {\r\n            let tempSum = 0;\r\n            \r\n            for (let n=0; n<keys.length;n++ ) {\r\n                tempSum += chartData[i][`${keys[n]} Daily Count`]\r\n            }\r\n\r\n            summarizedData.push({\r\n                ...chartData[i],\r\n                'summarized': tempSum \r\n            })\r\n        }\r\n\r\n        return summarizedData\r\n    }\r\n\r\n    const parsedData = summarizeChartData( { chartData: chartData, keys: selectionKeys })\r\n    const maximums = getMax({array: parsedData, variables: ['count','sum']})\r\n    const dateRange = getDateRange({startDate: new Date('02/01/2020'), endDate: new Date()})\r\n    \r\n    const handleLegendHover = (o) => {\r\n        setStrokeOpacities(o.dataKey)\r\n    }\r\n\r\n    const handleLegendLeave = () => {\r\n        setStrokeOpacities(null)\r\n    }\r\n\r\n    // const renderLegend = (props) => {\r\n    //     const { payload } = props;\r\n    //     let dataArray = [];\r\n    //     for (let i=0; i<payload.length/2;i++) {\r\n    //         dataArray.push(payload[i+payload.length/2])\r\n    //         dataArray.push(payload[i])\r\n    //     }\r\n\r\n    //     return (\r\n    //       <LegendList>\r\n    //         {\r\n    //           dataArray.map((entry, index) => (\r\n    //             <LegendItem \r\n    //                 onMouseEnter={handleLegendHover}\r\n    //                 onMouseLeave={handleLegendLeave}\r\n    //                 key={`item-${index}`} \r\n    //                 color={entry.color}\r\n    //                 active={strokeOpacities.includes(entry.dataKey)}\r\n    //                 id={entry.dataKey}\r\n    //                 >\r\n    //                 {entry.value}\r\n    //             </LegendItem>\r\n    //           ))\r\n    //         }\r\n    //       </LegendList>\r\n    //     );\r\n    // }\r\n\r\n    return (\r\n        <ChartContainer>\r\n            {selectionKeys.length < 2 && \r\n                <ChartTitle>Total Cases and 7-Day Average New Cases\r\n                    {selectionKeys.length>0 && `: ${selectionKeys[0]}`}\r\n                </ChartTitle>\r\n            }\r\n            {selectionKeys.length >= 2 && \r\n                <ChartTitle>7-Day Average New Cases</ChartTitle>\r\n            }\r\n            <ResponsiveContainer width=\"100%\" height=\"80%\">\r\n                <LineChart\r\n                    data={parsedData}\r\n                    margin={{\r\n                        top: 0, right: 10, left: 10, bottom: 20,\r\n                    }}\r\n                    onClick={chartSetDate}\r\n                >\r\n                    <XAxis \r\n                        dataKey=\"date\"\r\n                        ticks={dateRange}\r\n                        tick={\r\n                            <CustomTick\r\n                            style={{\r\n                                fill: `${colors.white}88`,\r\n                                fontSize: \"10px\",\r\n                                fontFamily: \"Lato\",\r\n                                fontWeight: 600,\r\n                                transform:'translateY(10px)'\r\n                            }}\r\n                            labelFormatter={dateFormatter}\r\n                            />\r\n                        }\r\n                    />\r\n                    <YAxis yAxisId=\"left\" type=\"number\" scale={logChart ? \"log\" : \"linear\"} domain={[0.01, 'dataMax']} allowDataOverflow \r\n                        ticks={selectionKeys.length === 0 ? rangeIncrement({maximum: maximums.sum, increment: 2000000}) : []} \r\n                        tick={\r\n                            <CustomTick\r\n                            style={{\r\n                                fill: colors.lightgray,\r\n                                fontSize: \"10px\",\r\n                                fontFamily: \"Lato\",\r\n                                fontWeight: 600\r\n                            }}\r\n                            labelFormatter={selectionKeys.length === 0 ? millionFormatter : thousandFormatter}\r\n                            />\r\n                        }\r\n                        >\r\n                        <Label value=\"Total Cases\" position='insideLeft' style={{marginTop:10, fill:colors.lightgray, fontFamily: 'Lato', fontWeight: 600}} angle={-90}  />\r\n                    </YAxis>\r\n                    <YAxis yAxisId=\"right\" orientation=\"right\" scale={logChart ? \"log\" : \"linear\"} domain={[0.01, 'dataMax']} allowDataOverflow \r\n                        ticks={selectionKeys.length === 0 ? rangeIncrement({maximum: maximums.count, increment: 50000}) : []}\r\n                        tick={\r\n                            <CustomTick\r\n                                style={{\r\n                                    fill: colors.lightgray,\r\n                                    fontSize: \"10px\",\r\n                                    fontFamily: \"Lato\",\r\n                                    fontWeight: 600,\r\n                                }}\r\n                                labelFormatter={thousandFormatter}\r\n                            />\r\n                        }\r\n                        >\r\n                        <Label value=\"7-Day Average New Cases\" position='insideTopRight' style={{marginTop:10, fill:(selectionKeys.length < 2 ? colors.yellow : colors.lightgray), fontFamily: 'Lato', fontWeight: 600}} angle={-90}  />\r\n                    </YAxis>\r\n                    <Tooltip\r\n                        content={CustomTooltip}\r\n                    />\r\n                    <ReferenceArea \r\n                        yAxisId=\"left\"\r\n                        x1={getStartDate(dataParams.nRange, dataParams.nIndex-startDateIndex, parsedData)}\r\n                        x2={getEndDate(dataParams.nIndex-startDateIndex, parsedData)} \r\n                        fill=\"white\" \r\n                        fillOpacity={0.15}\r\n                        isAnimationActive={false}\r\n                    />\r\n                    {selectionKeys.length < 2 && <Line type=\"monotone\" yAxisId=\"left\" dataKey={selectionKeys.length > 0 ? selectionKeys[0] + \" Total Cases\" : \"sum\"} name=\"Total Cases\" stroke={colors.lightgray} dot={false} isAnimationActive={false} /> }\r\n                    {selectionKeys.length < 2 && <Line type=\"monotone\" yAxisId=\"right\" dataKey={selectionKeys.length > 0 ? selectionKeys[0] + \" Daily Count\": \"count\"} name=\"7-Day Average New Cases\" stroke={colors.yellow} dot={false} isAnimationActive={false} /> }\r\n                    \r\n                    {/* {selectionKeys.length !== 0 && \r\n                        selectionKeys.map((key,index) => { \r\n                            return <Line \r\n                                type=\"monotone\" \r\n                                yAxisId=\"left\" \r\n                                dataKey={key + ' Total Cases'} \r\n                                name={key + ' Total Cases'} \r\n                                stroke={colors.pairedColors.sum[index]} \r\n                                dot={false} \r\n                                isAnimationActive={false}  \r\n                                strokeOpacity={strokeOpacities.length === 0 || strokeOpacities.includes(key + ' Total Cases') ? 1 : 0.25}\r\n                            />}\r\n                        )\r\n                    } */}\r\n                    {selectionKeys.length > 1 && \r\n                            <Line \r\n                                type='monotone'\r\n                                yAxisId='right'\r\n                                dataKey='summarized' \r\n                                name='Total For Selection' \r\n                                stroke={colors.lightgray}\r\n                                strokeWidth={3} \r\n                                dot={false} \r\n                                isAnimationActive={false}  \r\n                            />\r\n                    }\r\n                    {selectionKeys.length > 1 && \r\n                        selectionKeys.map((key,index) => {\r\n                            return <Line \r\n                                type='monotone'\r\n                                yAxisId='right' \r\n                                dataKey={key + ' Daily Count'} \r\n                                name={key} \r\n                                stroke={colors.qualtitiveScale[index]} \r\n                                dot={false} \r\n                                isAnimationActive={false}  \r\n                                strokeOpacity={strokeOpacities === key + ' Daily Count' ? 1 : 0.5}\r\n                                strokeWidth={strokeOpacities === key + ' Daily Count' ? 2 : 1}\r\n                            />}\r\n                        )\r\n                    }\r\n                    <Legend \r\n                        // content={renderLegend}\r\n                        onMouseEnter={handleLegendHover} \r\n                        onMouseLeave={handleLegendLeave}\r\n                    />\r\n                </LineChart>\r\n            </ResponsiveContainer>\r\n            <StyledSwitch>\r\n                <Switch\r\n                    checked={logChart}\r\n                    onChange={handleSwitch}\r\n                    name='log chart switch'\r\n                    inputProps={{ 'aria-label': 'secondary checkbox' }}\r\n                />\r\n                <p>{logChart ? 'Log Scale' : 'Linear Scale'}</p>\r\n            </StyledSwitch>\r\n        </ChartContainer>\r\n    );\r\n}\r\n\r\nexport default MainLineChart\r\n\r\n// dataParams.nIndex-(dataParams.nRange||dataParams.nIndex)","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport styled from 'styled-components';\r\nimport {fromJS} from 'immutable';\r\nimport {find, findIndex} from 'lodash';\r\n\r\nimport DeckGL from '@deck.gl/react';\r\nimport {View, MapView, _GlobeView as GlobeView, FlyToInterpolator} from '@deck.gl/core';\r\nimport { GeoJsonLayer, PolygonLayer, ScatterplotLayer, IconLayer, TextLayer } from '@deck.gl/layers';\r\nimport {fitBounds} from '@math.gl/web-mercator';\r\n// import {SimpleMeshLayer} from '@deck.gl/mesh-layers';\r\n// import {IcoSphereGeometry} from '@luma.gl/engine';\r\n\r\nimport MapboxGLMap, {NavigationControl, GeolocateControl, LinearInterpolator } from 'react-map-gl';\r\nimport Geocoder from 'react-map-gl-geocoder';\r\n\r\nimport { MapTooltipContent } from '../components';\r\nimport { setDataSidebar, setMapLoaded, setPanelState, setSelectionData, appendSelectionData, removeSelectionData } from '../actions';\r\nimport { mapFn, dataFn, getVarId, getCSV, getCartogramCenter, getDataForCharts, getURLParams } from '../utils';\r\nimport { colors, colorScales } from '../config';\r\nimport MAP_STYLE from '../config/style.json';\r\nimport { selectRect } from '../config/svg'; \r\n\r\n// const cartoGeom = new IcoSphereGeometry({\r\n//   iterations: 1\r\n// });\r\nconst bounds = fitBounds({\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n    bounds: [[-130.14, 53.96],[-67.12, 19]]\r\n})\r\n\r\nconst hawaiiBounds = fitBounds({\r\n    width: window.innerWidth*.15,\r\n    height: window.innerHeight*.12,\r\n    bounds: [[-161.13, 23.23],[-152.75, 17.67]]\r\n})\r\n\r\nconst alaskaBounds = fitBounds({\r\n    width: window.innerWidth*.15,\r\n    height: window.innerHeight*.12,\r\n    bounds: [[-167.75, 73.59],[-132.70, 50.09]]\r\n})\r\n\r\nconst ICON_MAPPING = {\r\n    hospital: {x: 0, y: 0, width: 128, height: 128},\r\n    clinic: {x: 128, y: 0, width: 128, height: 128},\r\n  };\r\n\r\nconst MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoibGl4dW45MTAiLCJhIjoiY2locXMxcWFqMDAwenQ0bTFhaTZmbnRwaiJ9.VRNeNnyb96Eo-CorkJmIqg';\r\n\r\nconst defaultMapStyle = fromJS(MAP_STYLE);\r\n\r\nconst MapContainer = styled.div`\r\n    position:absolute;\r\n    left:0;\r\n    top:0;\r\n    width:100%;\r\n    height:calc(100% - 50px);\r\n    background:${colors.darkgray};\r\n    @media (max-width:600px) {\r\n        div.mapboxgl-ctrl-geocoder {\r\n            display:none;\r\n        }\r\n    }\r\n`\r\n\r\nconst HoverDiv = styled.div`\r\n    background:${colors.gray};\r\n    padding:20px;\r\n    color:white;\r\n    box-shadow: 0px 0px 5px rgba(0,0,0,0.7);\r\n    border-radius:0.5vh 0.5vh 0 0;\r\n    transition:0s all;\r\n    h3 {\r\n        margin:2px 0;\r\n    }\r\n`;\r\n\r\nconst NavInlineButton = styled.button`\r\n    width:29px;\r\n    height:29px;\r\n    padding:5px;\r\n    margin-bottom:10px;\r\n    display:block;\r\n    background-color: ${props => props.isActive ? colors.lightblue : colors.buttongray};\r\n    -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    box-shadow: 0 0 0 2px rgba(0,0,0,.1);\r\n    border-radius: 4px;\r\n    outline:none;\r\n    border:none;\r\n    transition:250ms all;\r\n    cursor:pointer;\r\n    &:last-of-type {\r\n        margin-top:10px;\r\n    }\r\n    :after {\r\n        opacity: ${props => props.shareNotification ? 1 : 0};\r\n        content:'Map Link Copied to Clipboard!';\r\n        background:${colors.buttongray};\r\n        -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n        -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n        box-shadow: 0 0 0 2px rgba(0,0,0,.1);\r\n        border-radius: 4px;\r\n        position: absolute;\r\n        transform:translate(-120%, -25%);\r\n        padding:5px;\r\n        width:150px;\r\n        pointer-events:none;\r\n        max-width:50vw;\r\n        transition:250ms all;\r\n    }\r\n`\r\n\r\nconst MapGeocoder = styled(Geocoder)`\r\n    @media (max-width:600px) {\r\n        display:none !important;\r\n    }\r\n`\r\n\r\nconst MapButtonContainer = styled.div`\r\n    position: absolute;\r\n    right: ${props => props.infoPanel ? 317 : 10}px;\r\n    bottom: 30px;\r\n    zIndex: 10;\r\n    transition: 250ms all;\r\n    @media (max-width:768px) {\r\n        bottom:100px;\r\n    }\r\n    @media (max-width: 400px) {\r\n        transform:scale(0.75) translate(20%, 20%);\r\n    }\r\n`\r\n\r\nconst ShareURL = styled.input`\r\n    position:fixed;\r\n    left:110%;\r\n`\r\n\r\nconst IndicatorBox = styled.div`\r\n    position:fixed;\r\n    top:${props => props.y}px;\r\n    left:${props => props.x}px;\r\n    width:${props => props.width}px;\r\n    height:${props => props.height}px;\r\n    border:1px dashed #FFCE00;\r\n    background:rgba(0,0,0,0.25);\r\n    z-index:5;\r\n`\r\n\r\nconst MainViewContainer  = styled(View)`\r\n\r\n`\r\n\r\nconst Map = () => { \r\n    \r\n    const { storedData, storedGeojson, currentData, storedLisaData,\r\n        storedCartogramData, panelState, dates, dataParams, mapParams,\r\n        currentVariable, startDateIndex, urlParams } = useSelector(state => state);\r\n\r\n    const [hoverInfo, setHoverInfo] = useState(false);\r\n    const [highlightGeog, setHighlightGeog] = useState([]);\r\n    // const [globalMap, setGlobalMap] = useState(false);\r\n    const globalMap = false;\r\n    const [mapStyle, setMapStyle] = useState(defaultMapStyle);\r\n    const [currLisaData, setCurrLisaData] = useState({})\r\n    \r\n    const [viewState, setViewState] = useState({\r\n        latitude: +urlParams.lat || bounds.latitude,\r\n        longitude: +urlParams.lon || bounds.longitude,\r\n        zoom: +urlParams.z || bounds.zoom,\r\n        bearing:0,\r\n        pitch:0\r\n    })\r\n\r\n    const [viewStates, setViewStates] = useState({\r\n        'main': {\r\n            latitude: +urlParams.lat || bounds.latitude,\r\n            longitude: +urlParams.lon || bounds.longitude,\r\n            zoom: +urlParams.z || bounds.zoom,\r\n            bearing:0,\r\n            pitch:0\r\n        },\r\n        'hawaiiMap': {\r\n            latitude: hawaiiBounds.latitude,\r\n            longitude: hawaiiBounds.longitude,\r\n            zoom: hawaiiBounds.zoom,\r\n            bearing:0,\r\n            pitch:0\r\n        },\r\n        'alaskaMap': {\r\n            latitude: alaskaBounds.latitude,\r\n            longitude: alaskaBounds.longitude,\r\n            zoom: alaskaBounds.zoom,\r\n            bearing:0,\r\n            pitch:0\r\n        }\r\n    });\r\n\r\n    const onViewStateChange = useCallback(({viewId, viewState}) => {\r\n        if (viewId === 'main') {\r\n          setViewStates(currentViewStates => ({\r\n            ...currentViewStates,\r\n            main: viewState\r\n          }));\r\n        } \r\n    }, []);\r\n\r\n    const [cartogramData, setCartogramData] = useState([]);\r\n    const [currVarId, setCurrVarId] = useState(null);\r\n    const [hospitalData, setHospitalData] = useState(null);\r\n    const [clinicData, setClinicData] = useState(null);\r\n    const [storedCenter, setStoredCenter] = useState(null);\r\n    const [shared, setShared] = useState(false);\r\n    const [multipleSelect, setMultipleSelect] = useState(false);\r\n    const [choroplethInteractive, setChoroplethInteractive] = useState(true);\r\n    const [boxSelect, setBoxSelect] = useState(false);\r\n    const [boxSelectDims, setBoxSelectDims] = useState({});\r\n    const [resetSelect, setResetSelect] = useState(null);\r\n    // const [mobilityData, setMobilityData] = useState([]);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => { \r\n        window.addEventListener('storage', () => {\r\n            // When local storage changes, dump the list to\r\n            // the console.\r\n            const SHARED_GEOID =  localStorage.getItem('SHARED_GEOID').split(',').map(d => parseInt(d))\r\n            \r\n            if (SHARED_GEOID !== null) {\r\n                setHighlightGeog(SHARED_GEOID); \r\n            }\r\n            \r\n            const SHARED_VIEW =  JSON.parse(localStorage.getItem('SHARED_VIEW'));\r\n            \r\n            if (SHARED_VIEW !== null && SHARED_VIEW.hasOwnProperty('latitude')) {\r\n                setViewState(\r\n                    prevView => ({\r\n                        ...prevView,\r\n                        longitude: SHARED_VIEW.longitude,\r\n                        latitude: SHARED_VIEW.latitude,\r\n                        zoom: SHARED_VIEW.zoom,\r\n                        transitionDuration: 1000,\r\n                        transitionInterpolator: new FlyToInterpolator()\r\n                    })\r\n                )   \r\n            }\r\n        });\r\n    },[])\r\n\r\n    useEffect(() => {\r\n        let arr = [];\r\n        if (storedData[currentData] && mapParams.vizType === 'cartogram') {\r\n            for (let i=0; i<storedData[currentData].length; i++) {\r\n                arr.push({id:i})\r\n            }\r\n        }\r\n        setCartogramData(arr)\r\n    }, [storedData, currentData, mapParams.vizType])\r\n\r\n    useEffect(() => {\r\n        setCurrVarId(getVarId(currentData, dataParams))\r\n    }, [dataParams, mapParams])\r\n\r\n\r\n    useEffect(() => {\r\n        switch(mapParams.vizType) {\r\n            case '2D': \r\n                setViewState(view => ({\r\n                    ...view,\r\n                    latitude: +urlParams.lat || bounds.latitude,\r\n                    longitude: +urlParams.lon || bounds.longitude,\r\n                    zoom: +urlParams.z || bounds.zoom,\r\n                    bearing:0,\r\n                    pitch:0\r\n                }));\r\n                setStoredCenter(null)\r\n                break\r\n            case '3D':\r\n                setViewState(view => ({\r\n                    ...view,\r\n                    latitude: +urlParams.lat || 39.8283,\r\n                    longitude: +urlParams.lon || -98.5795,\r\n                    zoom: +urlParams.z || bounds.zoom,\r\n                    bearing:-30,\r\n                    pitch:30\r\n                }));\r\n                setStoredCenter(null)\r\n                break\r\n            // case 'cartogram':\r\n            //     useCallback(() => {\r\n            //         let center = getCartogramCenter(storedCartogramData[getVarId(currentData, dataParams)])\r\n            //         setViewState(view => ({\r\n            //             ...view,\r\n            //             latitude: center[1],\r\n            //             longitude: center[0],\r\n            //             zoom: 5,\r\n            //             bearing:0,\r\n            //             pitch:0\r\n            //         }));\r\n            //     }, [cartogramData])\r\n            //     break\r\n            default:\r\n                //\r\n        }\r\n    }, [mapParams.vizType, currentData])\r\n\r\n    useEffect(() => {\r\n        let tempData = storedLisaData[getVarId(currentData, dataParams)]\r\n        if (tempData !== undefined) setCurrLisaData(tempData);\r\n    }, [storedLisaData, dataParams, mapParams])\r\n\r\n    useEffect(() => {\r\n        const defaultLayers = defaultMapStyle.get('layers');\r\n        let tempLayers;\r\n\r\n        if (mapParams.vizType === 'cartogram' || globalMap) {\r\n            tempLayers = defaultLayers.map(layer => {\r\n                return layer.setIn(['layout', 'visibility'], 'none');\r\n            });\r\n        } else if (mapParams.vizType === '3D') {\r\n            tempLayers = defaultLayers.map(layer => {\r\n                if ((layer.get('id').includes('label')) && !(layer.get('id').includes('water'))) return layer;\r\n                return layer.setIn(['layout', 'visibility'], 'none');\r\n            });\r\n        } else {\r\n            tempLayers = defaultLayers.map(layer => {\r\n                if (mapParams.resource.includes(layer.get('id')) || mapParams.overlay.includes(layer.get('id'))) {\r\n                    return layer.setIn(['layout', 'visibility'], 'visible');\r\n                } else {\r\n                    return layer;\r\n                }\r\n            });\r\n        }\r\n        setMapStyle(defaultMapStyle.set('layers', tempLayers));\r\n\r\n    }, [mapParams.overlay, mapParams.vizType])\r\n\r\n    useEffect(() => {\r\n        if (hospitalData === null) {\r\n            getCSV(`${process.env.PUBLIC_URL}/csv/us_healthcare_capacity-facility-CovidCareMap.csv`)\r\n            .then(values => setHospitalData(values))\r\n        }\r\n\r\n        if (clinicData === null) {\r\n            getCSV(`${process.env.PUBLIC_URL}/csv/health_centers.csv`)\r\n            .then(values => setClinicData(values))\r\n        }\r\n    },[])\r\n\r\n    useEffect(() => {\r\n        if (storedCartogramData[getVarId(currentData, dataParams)]){\r\n            let center = getCartogramCenter(storedCartogramData[getVarId(currentData, dataParams)])\r\n            let roundedCenter = [Math.floor(center[0]),Math.floor(center[1])]\r\n            if (storedCenter === null || roundedCenter[0] !== storedCenter[0]) {\r\n                setViewState(view => ({\r\n                    ...view,\r\n                    latitude: center[1],\r\n                    longitude: center[0],\r\n                    zoom: 5,\r\n                    bearing:0,\r\n                    pitch:0\r\n                }));\r\n                setStoredCenter(roundedCenter)\r\n            }\r\n        }\r\n    }, [storedCartogramData, currentData])\r\n\r\n    useEffect(() => {\r\n        setViewState(view => ({\r\n            ...view,\r\n            latitude: +urlParams.lat || bounds.latitude,\r\n            longitude: +urlParams.lon || bounds.longitude,\r\n            zoom: +urlParams.z || bounds.zoom,\r\n            bearing:0,\r\n            pitch:0\r\n        }));\r\n    }, [urlParams])\r\n    \r\n    const GetFillColor = (f, bins, mapType) => {\r\n        if (!bins.hasOwnProperty(\"bins\")) {\r\n            return [0,0,0]\r\n        } else if (mapType === 'lisa') {\r\n            return colorScales.lisa[currLisaData[storedGeojson[currentData]['geoidOrder'][f.properties.GEOID]]]\r\n        } else {\r\n            return mapFn(dataFn(f[dataParams.numerator], f[dataParams.denominator], dataParams), bins.breaks, mapParams.colorScale, mapParams.mapType, dataParams.numerator);\r\n        }\r\n    }\r\n    \r\n    const GetHeight = (f, bins) => bins.hasOwnProperty(\"bins\") ? dataFn(f[dataParams.numerator], f[dataParams.denominator], dataParams)*(dataParams.scale3D/((dataParams.nType === \"time-series\" && dataParams.nRange === null) ? (dataParams.nIndex-startDateIndex)/10 : 1)) : 0\r\n        \r\n    const handleGeolocate = (viewState) => {\r\n        setViewState(view => ({\r\n            ...view,\r\n            latitude: viewState.coords.latitude,\r\n            longitude: viewState.coords.longitude,\r\n            zoom: 8,\r\n            transitionInterpolator: new FlyToInterpolator(),\r\n            transitionDuration: 250,\r\n        }))\r\n    }\r\n\r\n    const getCartogramFillColor = (val, id, bins, mapType) => {\r\n        \r\n        if (!bins.hasOwnProperty(\"bins\")) {\r\n            return [0,0,0]\r\n        } else if (mapType === 'lisa') {\r\n            return colorScales.lisa[currLisaData[id]]\r\n        } else {\r\n            return mapFn(val, bins.breaks, mapParams.colorScale, mapParams.mapType, dataParams.numerator) \r\n        }\r\n    }\r\n\r\n    const mapRef = useRef();\r\n    const deckRef = useRef();\r\n    \r\n    const handleShare = async (params) => {\r\n        const shareData = {\r\n            title: 'The US Covid Atlas',\r\n            text: 'Near Real-Time Exploration of the COVID-19 Pandemic.',\r\n            url: `${window.location.href}${getURLParams(params)}`,\r\n        }\r\n\r\n        try {\r\n            await navigator.share(shareData)\r\n          } catch(err) {\r\n            let copyText = document.querySelector(\"#share-url\");\r\n            copyText.value = `${shareData.url}`;\r\n            copyText.style.display = 'block'\r\n            copyText.select();\r\n            copyText.setSelectionRange(0, 99999);\r\n            document.execCommand(\"copy\");\r\n            copyText.style.display = 'none';\r\n            setShared(true)\r\n            setTimeout(() => setShared(false), 5000);\r\n        }\r\n    }\r\n\r\n    const handleKeyDown = (e) => {\r\n        if (e.ctrlKey) setMultipleSelect(true);\r\n        if (e.shiftKey) setBoxSelect(true);\r\n    }\r\n\r\n    const handleKeyUp = (e) => {\r\n        if (!e.ctrlKey) setMultipleSelect(false);\r\n        if (!e.shiftKey) setBoxSelect(false);\r\n    }\r\n\r\n    \r\n    const handleMapHover = ({x, y, object}) => {\r\n        // let eps = 1\r\n        // if (((x-hoverInfo.x>eps||x-hoverInfo.x<-1*eps)&&(y-hoverInfo.y>eps||y-hoverInfo.y<-1*eps))||hoverInfo === false){\r\n            setHoverInfo({x, y, object})\r\n        // }\r\n    }\r\n    const Layers = [\r\n        // new SolidPolygonLayer({\r\n        //     id: 'background',\r\n        //     data: [\r\n        //       [[-180, 90], [0, 90], [180, 90], [180, -90], [0, -90], [-180, -90]]\r\n        //     ],\r\n        //     getPolygon: d => d,\r\n        //     stroked: false,\r\n        //     filled: true,\r\n        //     visible: globalMap,\r\n        //     updateTriggers: {\r\n        //         visible: globalMap\r\n        //     },\r\n        //     getFillColor: [40, 40, 40]\r\n        //   }),\r\n        new GeoJsonLayer({\r\n            id: 'choropleth',\r\n            data: {\r\n                \"type\": \"FeatureCollection\",\r\n                \"name\": currentData,\r\n                \"crs\": { \"type\": \"name\", \"properties\": { \"name\": \"urn:ogc:def:crs:OGC:1.3:CRS84\" } },\r\n                \"features\": storedData[currentData] ? storedData[currentData] : [],\r\n            },\r\n            visible: mapParams.vizType !== 'cartogram',\r\n            pickable: mapParams.vizType !== 'cartogram' && choroplethInteractive,\r\n            stroked: false,\r\n            filled: true,\r\n            wireframe: mapParams.vizType === '3D',\r\n            extruded: mapParams.vizType === '3D',\r\n            opacity: 0.8,\r\n            material:false,\r\n            getFillColor: f => GetFillColor(f, mapParams.bins, mapParams.mapType),\r\n            getElevation: f => GetHeight(f, mapParams.bins, mapParams.mapType),\r\n            // getLineColor: [255, 80, 80],\r\n            // getLineWidth:50,\r\n            // minLineWidth:20,\r\n            // lineWidthScale: 20,\r\n            // updateTriggers: {\r\n            //     data: currentData,\r\n            //     pickable: mapParams.vizType,\r\n            //     // getFillColor: [dataParams, mapParams.mapType, mapParams.bins, mapParams.binMode, mapParams.fixedScale, mapParams.vizType, mapParams.colorScale, mapParams.customScale],\r\n            //     // getElevation: [dataParams, mapParams.mapType, mapParams.bins, mapParams.binMode, mapParams.fixedScale, mapParams.vizType, mapParams.colorScale, mapParams.customScale],\r\n            // },\r\n            onHover: handleMapHover,\r\n            onClick: info => {\r\n                let dataName = info?.object?.properties?.state_abbr !== undefined ? `${info.object?.properties?.NAME}, ${info?.object?.properties?.state_abbr}` : `${info.object?.properties?.NAME}`\r\n                if (multipleSelect) {\r\n                    try {\r\n                        if (highlightGeog.indexOf(info.object.properties.GEOID) === -1) {\r\n                            let GeoidList = [...highlightGeog, info.object.properties.GEOID]\r\n                            setHighlightGeog(GeoidList); \r\n                            dispatch(\r\n                                appendSelectionData({\r\n                                    values: getDataForCharts(\r\n                                        {data: info.object}, \r\n                                        'cases', \r\n                                        startDateIndex, \r\n                                        dates[currentData], \r\n                                        dataName\r\n                                    ),\r\n                                    name: dataName,\r\n                                    index: findIndex(storedData[currentData], o => o.properties.GEOID === info.object.properties.GEOID)\r\n                                })\r\n                            );\r\n                            window.localStorage.setItem('SHARED_GEOID', GeoidList);\r\n                            window.localStorage.setItem('SHARED_VIEW', JSON.stringify(mapRef.current.props.viewState));\r\n                        } else {\r\n                            if (highlightGeog.length > 1) {\r\n                                let tempArray = [...highlightGeog];\r\n                                let geogIndex = tempArray.indexOf(info.object.properties.GEOID);\r\n                                tempArray.splice(geogIndex, 1);\r\n                                setHighlightGeog(tempArray);\r\n                                dispatch(\r\n                                    removeSelectionData({\r\n                                        name: dataName,\r\n                                        index: findIndex(storedData[currentData], o => o.properties.GEOID === info.object.properties.GEOID)\r\n                                    })\r\n                                )\r\n                                window.localStorage.setItem('SHARED_GEOID', tempArray);\r\n                                window.localStorage.setItem('SHARED_VIEW', JSON.stringify(mapRef.current.props.viewState));\r\n                            }\r\n                        }\r\n                    } catch {}\r\n                } else {\r\n                    try {\r\n                        setHighlightGeog([info.object.properties.GEOID]); \r\n                        dispatch(\r\n                            setSelectionData({\r\n                                values: getDataForCharts(\r\n                                    {data: info.object}, \r\n                                    'cases', \r\n                                    startDateIndex, \r\n                                    dates[currentData], \r\n                                    dataName\r\n                                ),\r\n                                name: dataName,\r\n                                index: findIndex(storedData[currentData], o => o.properties.GEOID === info.object.properties.GEOID)\r\n                            })\r\n                        );\r\n                        window.localStorage.setItem('SHARED_GEOID', info.object.properties.GEOID);\r\n                        window.localStorage.setItem('SHARED_VIEW', JSON.stringify(mapRef.current.props.viewState));\r\n                        // if (mapParams.overlay === \"mobility-county\") {\r\n                        //     setMobilityData(parseMobilityData(info.object.properties.GEOID, storedMobilityData.flows[info.object.properties.GEOID], storedMobilityData.centroids));\r\n                        // }\r\n                    } catch {}\r\n                }\r\n            },\r\n                // parameters: {\r\n                //     depthTest: false\r\n                // }\r\n        }),\r\n        new GeoJsonLayer({\r\n            id: 'highlightLayer',\r\n            data: {\r\n                \"type\": \"FeatureCollection\",\r\n                \"name\": currentData,\r\n                \"crs\": { \"type\": \"name\", \"properties\": { \"name\": \"urn:ogc:def:crs:OGC:1.3:CRS84\" } },\r\n                \"features\": storedData[currentData] ? storedData[currentData] : [],\r\n            },\r\n            pickable: false,\r\n            stroked: true,\r\n            filled:false,\r\n            getLineColor: f => highlightGeog.indexOf(f.properties.GEOID)!==-1 ? [0, 104, 109] : [0, 104, 109, 0], \r\n            lineWidthScale: 500,\r\n            getLineWidth: 5,\r\n            lineWidthMinPixels: 3,\r\n            lineWidthMaxPixels: 10,\r\n            parameters: {\r\n                depthTest: false\r\n            },\r\n            updateTriggers: {\r\n                data: currentData,\r\n                getLineColor: highlightGeog,\r\n            },\r\n        }),\r\n        // new LineLayer({\r\n        //     id: 'mobility flows',\r\n        //     data: mobilityData,\r\n        //     pickable: false,\r\n        //     visible: mapParams.overlay === \"mobility-county\",\r\n        //     widthUnits: 'meters',\r\n        //     widthScale: 10000,\r\n        //     getSourcePosition: d => [d[1],d[2]],\r\n        //     getTargetPosition: d => [d[3],d[4]],\r\n        //     getWidth: d => d[5] < 10 ? d[5] : 0,\r\n        //     updateTriggers: {\r\n        //         data: [mobilityData],\r\n        //         visible: [mapParams.overlay]\r\n        //     }\r\n        // }),\r\n        new IconLayer({\r\n            id: 'hospital-layer',\r\n            data: hospitalData,\r\n            pickable:true,\r\n            visible: mapParams.resource.includes('hospital'),\r\n            iconAtlas: `${process.env.PUBLIC_URL}/assets/img/icon_atlas.png`,\r\n            iconMapping: ICON_MAPPING,\r\n            getIcon: d => 'hospital',\r\n            getPosition: d => [d.Longitude, d.Latitude],\r\n            sizeUnits: 'meters',\r\n            getSize: 20000,\r\n            sizeMinPixels:12,\r\n            sizeMaxPixels:24,\r\n            updateTriggers: {\r\n                data: hospitalData,\r\n                visible: mapParams\r\n            },\r\n            onHover: handleMapHover,\r\n        }),\r\n        new IconLayer({\r\n            id: 'clinics-layer',\r\n            data: clinicData,\r\n            pickable:true,\r\n            visible: mapParams.resource.includes('clinic'),\r\n            iconAtlas: `${process.env.PUBLIC_URL}/assets/img/icon_atlas.png`,\r\n            iconMapping: ICON_MAPPING,\r\n            getIcon: d => 'clinic',\r\n            getSize: 20000,\r\n            getPosition: d => [d.lon, d.lat],\r\n            sizeUnits: 'meters',\r\n            sizeMinPixels:7,\r\n            sizeMaxPixels:20,\r\n            updateTriggers: {\r\n                data: clinicData,\r\n                visible: mapParams\r\n            },\r\n            onHover: handleMapHover,\r\n        }),\r\n        new PolygonLayer({\r\n            id: 'background',\r\n            data: [\r\n                // prettier-ignore\r\n                [[-180, 90], [0, 90], [180, 90], [180, -90], [0, -90], [-180, -90]]\r\n            ],\r\n            opacity: 1,\r\n            getPolygon: d => d,\r\n            stroked: false,\r\n            filled: true,\r\n            visible: mapParams.vizType === 'cartogram',\r\n            getFillColor: [10,10,10],\r\n            updateTriggers: {\r\n                visible: mapParams.vizType,\r\n            }\r\n        }),\r\n        new ScatterplotLayer({\r\n            id: 'cartogram layer',\r\n            data: cartogramData,\r\n            pickable:true,\r\n            visible: mapParams.vizType === 'cartogram',\r\n            getPosition: f => {\r\n                try {\r\n                    return storedCartogramData[currVarId][f.id].position;\r\n                } catch {\r\n                    return [0,0];\r\n                }\r\n            },\r\n            getFillColor: f => {\r\n                try {\r\n                    return getCartogramFillColor(storedCartogramData[currVarId][f.id].value, f.id, mapParams.bins, mapParams.mapType);\r\n                } catch {\r\n                    return [0,0,0];\r\n                }\r\n            },\r\n            getRadius: f => {\r\n                try {\r\n                    return storedCartogramData[currVarId][f.id].radius*10;\r\n                } catch {\r\n                    return 0;\r\n                }\r\n            },\r\n            // transitions: {\r\n            //     getPosition: 1,\r\n            //     getFillColor: 1,\r\n            //     getRadius: 1\r\n            // },   \r\n            onHover: f => {\r\n                try {\r\n                    setHoverInfo(\r\n                        {\r\n                            ...f,\r\n                            object: find(storedData[currentData], o => o.properties.GEOID === storedGeojson[currentData]['indexOrder'][f.object?.id]),\r\n                        }\r\n                    )\r\n                } catch {\r\n                    setHoverInfo(null)\r\n                }\r\n            },\r\n            updateTriggers: {\r\n                getPosition: [cartogramData, mapParams, dataParams, currVarId],\r\n                getFillColor: [cartogramData, mapParams, dataParams, currVarId],\r\n                getRadius: [cartogramData, mapParams, dataParams, currVarId],\r\n                visible: [cartogramData, mapParams, dataParams, currVarId]\r\n            }\r\n          }),\r\n          new TextLayer({\r\n            id: 'cartogram text layer',\r\n            data: cartogramData,\r\n            pickable:false,\r\n            visible: mapParams.vizType === 'cartogram' && currentData.includes('state'),\r\n            getPosition: f => {\r\n                try {\r\n                    return storedCartogramData[currVarId][f.id].position;\r\n                } catch {\r\n                    return [0,0];\r\n                }\r\n            },\r\n            sizeUnits: 'meters',\r\n            fontWeight: 'bold',\r\n            getTextAnchor: 'middle',\r\n            getAlignmentBaseline: 'center',\r\n            maxWidth: 500,\r\n            wordBreak: 'break-word',\r\n            getSize: f => {\r\n                try {\r\n                    return storedCartogramData[currVarId][f.id].radius*5;\r\n                } catch {\r\n                    return 0;\r\n                }\r\n            },\r\n            getText: f => {\r\n                try {\r\n                    if (currentData.includes('state')) return find(storedData[currentData], o => +o.properties.GEOID === storedGeojson[currentData].indexOrder[f.id]).properties.NAME;\r\n                    return '';\r\n                } catch {\r\n                    return '';\r\n                }\r\n            },\r\n            updateTriggers: {\r\n                getPosition: [cartogramData, mapParams, dataParams, currVarId],\r\n                getFillColor: [cartogramData, mapParams, dataParams, currVarId],\r\n                getSize: [cartogramData, mapParams, dataParams, currVarId],\r\n                getRadius: [cartogramData, mapParams, dataParams, currVarId],\r\n                visible: [cartogramData, mapParams, dataParams, currVarId]\r\n            }\r\n          }),\r\n        // new SimpleMeshLayer({\r\n        //     id: 'cartogram layer',\r\n        //     data: cartogramData,\r\n        //     // texture: 'texture.png',\r\n        //     sizeScale:10,\r\n        //     visible: mapParams.vizType === 'cartogram',\r\n        //     mesh: cartoGeom,\r\n        //     getPosition: f => {\r\n        //         try {\r\n        //             return storedCartogramData[currVarId][f.id].position;\r\n        //         } catch {\r\n        //             return [0,0];\r\n        //         }\r\n        //     },\r\n        //     getColor: f => getCartogramFillColor(storedCartogramData[currVarId][f.id].value, mapParams.bins, mapParams.mapType),\r\n        //     getScale: f => 500,\r\n        //     // getTranslation: f => getCartogramTranslation(storedCartogramData[currVarId][f.id]),\r\n        //     transitions: {\r\n        //         getPosition: 150,\r\n        //         getColor: 150,\r\n        //         getScale: 150,\r\n        //         getTranslation: 150\r\n        //     },   \r\n        //     updateTriggers: {\r\n        //         getPosition: [mapParams, dataParams, currVarId],\r\n        //         getColor: [mapParams, dataParams, currVarId],\r\n        //         getScale: [mapParams, dataParams, currVarId],\r\n        //         getTranslation: [mapParams, dataParams, currVarId]\r\n        //     }\r\n        //   })\r\n    ]\r\n\r\n    const viewGlobe = new GlobeView({id: 'globe', controller: false, resolution:1});\r\n    const view = new MapView({repeat: true});\r\n\r\n    // const views = [\r\n    //     new MapView({id: 'main', controller: true}),\r\n    //     new MapView({id: 'hawaiiMap', x: 0, y: '86%', width: '15%', height: '12%', controller: false}),\r\n    //     new MapView({id: 'alaskaMap', x: '14%', y: '86%', width: '15%', height: '12%', controller: false})\r\n    // ]\r\n\r\n    const [insetMap, setInsetMap] = useState(false)\r\n    \r\n    // try {\r\n        \r\n    // console.log(deckRef.current.pickObjects({x: 200, y: 200, width:500, height:500, layerIds: ['choropleth']}));\r\n\r\n    // } catch {\r\n\r\n    // }\r\n\r\n    const handleSelectionBoxStart = () => {\r\n        setBoxSelect(true)\r\n    }\r\n\r\n    const listener = (e) => {\r\n\r\n        setBoxSelectDims(prev => {\r\n            let x;\r\n            let y;\r\n            let width;\r\n            let height;\r\n\r\n            if (e.clientX < prev.ox) {\r\n                x = e.clientX;\r\n                width = prev.ox - e.clientX\r\n            } else {\r\n                x = prev.x;\r\n                width = e.clientX - prev.x\r\n            }\r\n\r\n            if (e.clientY < prev.oy) {\r\n                y = e.clientY;\r\n                height = prev.oy - e.clientY\r\n            } else {\r\n                y = prev.y;\r\n                height = e.clientY - prev.y\r\n            }\r\n\r\n            return { ...prev, x, y, width, height }\r\n        })\r\n    }\r\n    \r\n    const touchListener = (e) => {\r\n        // setX(e?.targetTouches[0]?.clientX-15)\r\n        // setY(e?.targetTouches[0]?.clientY-15)\r\n        console.log(e)\r\n    }\r\n\r\n    const removeListeners = () => {\r\n        window.removeEventListener('touchmove', touchListener)\r\n        window.removeEventListener('touchend', removeListeners)\r\n        window.removeEventListener('mousemove', listener)\r\n        window.removeEventListener('mouseup', removeListeners)\r\n    }\r\n\r\n    const handleBoxSelect = (e) => {\r\n        if (e.type === 'mousedown') {\r\n            setBoxSelectDims({\r\n                x:e.pageX,\r\n                y:e.pageY,\r\n                ox:e.pageX,\r\n                oy:e.pageY,\r\n                width:0,\r\n                height:0\r\n            });\r\n            window.addEventListener('touchmove', touchListener);\r\n            window.addEventListener('touchend', removeListeners);\r\n            window.addEventListener('mousemove', listener);\r\n            window.addEventListener('mouseup', removeListeners);\r\n        } else {\r\n\r\n            const {x, y, width, height } = boxSelectDims;\r\n\r\n            let layerIds = ['choropleth'];\r\n\r\n            let features = deckRef.current.pickObjects(\r\n                    {\r\n                        x, y: y-50, width, height, layerIds\r\n                    }\r\n                )\r\n\r\n            let GeoidList = [];\r\n            for (let i=0; i<features.length; i++) {\r\n                GeoidList.push(features[i].object.properties.GEOID)\r\n                let dataName = features[i]?.object?.properties?.state_abbr !== undefined ? `${features[i].object?.properties?.NAME}, ${features[i]?.object?.properties?.state_abbr}` : `${features[i].object?.properties?.NAME}`\r\n                \r\n                if (i===0){\r\n                    dispatch(\r\n                        setSelectionData({\r\n                            values: getDataForCharts(\r\n                                {data: features[i].object}, \r\n                                'cases', \r\n                                startDateIndex, \r\n                                dates[currentData], \r\n                                dataName\r\n                            ),\r\n                            name: dataName,\r\n                            index: findIndex(storedData[currentData], o => o.properties.GEOID === features[i].object.properties.GEOID)\r\n                        })\r\n                    );\r\n                } else {\r\n                    dispatch(\r\n                        appendSelectionData({\r\n                            values: getDataForCharts(\r\n                                {data: features[i].object}, \r\n                                'cases', \r\n                                startDateIndex, \r\n                                dates[currentData], \r\n                                dataName\r\n                            ),\r\n                            name: dataName,\r\n                            index: findIndex(storedData[currentData], o => o.properties.GEOID === features[i].object.properties.GEOID)\r\n                        })\r\n                    );\r\n                }\r\n            }\r\n            setHighlightGeog(GeoidList); \r\n            window.localStorage.setItem('SHARED_GEOID', GeoidList);\r\n            window.localStorage.setItem('SHARED_VIEW', JSON.stringify(mapRef.current.props.viewState));\r\n            setBoxSelectDims({});\r\n            removeListeners();\r\n            setBoxSelect(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <MapContainer\r\n            onKeyDown={handleKeyDown}\r\n            onKeyUp={handleKeyUp}\r\n            onMouseDown={e => boxSelect ? handleBoxSelect(e) : null}\r\n            onMouseUp={e => boxSelect ? handleBoxSelect(e) : null}\r\n        >\r\n            {\r\n                // boxSelectDims.hasOwnProperty('x') && \r\n                true && \r\n                <IndicatorBox \r\n                    x={boxSelectDims.x} \r\n                    y={boxSelectDims.y}\r\n                    width={boxSelectDims.width}\r\n                    height={boxSelectDims.height}>\r\n                </IndicatorBox>\r\n            }\r\n            <svg height=\"0\" width=\"0\">\r\n            <defs>\r\n                <clipPath id=\"window\">\r\n                    {!insetMap && <rect y=\"0\" x=\"0\" width={window.innerWidth} height={window.innerHeight}/>}\r\n                    <rect y=\"0\" x=\"0\" width={window.innerWidth} height={window.innerHeight*.8}/>\r\n                    <rect y={window.innerHeight*.8} x={window.innerWidth*.3} width={window.innerWidth*.7} height={window.innerHeight*.2}/>\r\n                </clipPath>\r\n            </defs>\r\n            </svg>\r\n            <DeckGL\r\n                layers={Layers}\r\n                ref={deckRef}\r\n\r\n                initialViewState={viewState}\r\n                controller={\r\n                    {\r\n                        dragRotate: !boxSelect, \r\n                        dragPan: !boxSelect, \r\n                        doubleClickZoom: !boxSelect, \r\n                        touchZoom: !boxSelect, \r\n                        touchRotate: !boxSelect, \r\n                        keyboard: true, \r\n                        scrollZoom: true\r\n                    }\r\n                }\r\n                views={view}\r\n\r\n                // onViewStateChange={onViewStateChange}\r\n                // viewState={viewStates}\r\n                // views={insetMap ? views : views[0]}\r\n            >\r\n                <MapboxGLMap\r\n                    reuseMaps\r\n                    ref={mapRef}\r\n                    mapStyle={mapStyle} //{globalMap || mapParams.vizType === 'cartogram' ? 'mapbox://styles/lixun910/ckhtcdx4b0xyc19qzlt4b5c0d' : 'mapbox://styles/lixun910/ckhkoo8ix29s119ruodgwfxec'}\r\n                    preventStyleDiffing={true}\r\n                    mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\r\n                    onViewportChange={() => setHoverInfo(false)}\r\n                    // onViewportChange={viewState  => console.log(mapRef.current.props.viewState)} \r\n                    onLoad={() => {\r\n                        dispatch(setMapLoaded(true))\r\n                    }}\r\n                    >\r\n                        \r\n                    <MapGeocoder \r\n                        mapRef={mapRef}\r\n                        id=\"geocoder\"\r\n                        onViewportChange={viewState  => setViewState(viewState)}\r\n                        mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\r\n                        position=\"top-right\"\r\n                        id=\"mapGeocoder\"\r\n                        placeholder=\"Search by Location\"\r\n                        clearAndBlurOnEsc={true}\r\n                        style={{position: 'fixed', top:'5px', right:'5px'}}\r\n                    />\r\n                        \r\n                    <MapButtonContainer \r\n                        infoPanel={panelState.info}\r\n                        onMouseEnter={() => {\r\n                            setHoverInfo(false)\r\n                            setChoroplethInteractive(false)}\r\n                        }\r\n                        onMouseLeave={() => setChoroplethInteractive(true)}\r\n                        >\r\n                        <NavInlineButton\r\n                            title=\"Selection Box\"\r\n                            isActive={boxSelect}\r\n                            onClick={() => handleSelectionBoxStart()}\r\n                        >\r\n                            {selectRect}\r\n                        </NavInlineButton>\r\n                        <GeolocateControl\r\n                            positionOptions={{enableHighAccuracy: false}}\r\n                            trackUserLocation={false}\r\n                            onGeolocate={viewState  => handleGeolocate(viewState)}\r\n                            style={{marginBottom: 10}}\r\n                        />\r\n                        <NavigationControl\r\n                            onViewportChange={viewState  => setViewState(viewState)} \r\n                        />\r\n                        \r\n                        <NavInlineButton\r\n                            title=\"Share this Map\"\r\n                            shareNotification={shared}\r\n                            onClick={() => handleShare({URLmapParams:mapParams, URLcurrentData:currentData, URLcurrentVariable:currentVariable, URLviewState: mapRef.current.props.viewState})}\r\n                        >\r\n                            <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\r\n                                <path d=\"M22.5,65c4.043,0,7.706-1.607,10.403-4.208l29.722,14.861C62.551,76.259,62.5,76.873,62.5,77.5c0,8.284,6.716,15,15,15   s15-6.716,15-15c0-8.284-6.716-15-15-15c-4.043,0-7.706,1.608-10.403,4.209L37.375,51.847C37.449,51.241,37.5,50.627,37.5,50   c0-0.627-0.051-1.241-0.125-1.847l29.722-14.861c2.698,2.601,6.36,4.209,10.403,4.209c8.284,0,15-6.716,15-15   c0-8.284-6.716-15-15-15s-15,6.716-15,15c0,0.627,0.051,1.241,0.125,1.848L32.903,39.208C30.206,36.607,26.543,35,22.5,35   c-8.284,0-15,6.716-15,15C7.5,58.284,14.216,65,22.5,65z\">\r\n                                </path>\r\n                            </svg>\r\n\r\n                        </NavInlineButton>\r\n\r\n                        <ShareURL type=\"text\" value=\"\" id=\"share-url\" />\r\n                    </MapButtonContainer>\r\n                    <div></div>\r\n                </MapboxGLMap >\r\n                \r\n                {/* <View id=\"main\" className=\"test\" style={{display:'none'}}/> */}\r\n            </DeckGL>\r\n            \r\n            {hoverInfo.object && (\r\n                <HoverDiv style={{transition: '0ms all', position: 'absolute', zIndex: 1, pointerEvents: 'none', left: hoverInfo.x, top: hoverInfo.y}}>\r\n                    <MapTooltipContent content={hoverInfo.object} index={dataParams.nIndex-startDateIndex} />\r\n                </HoverDiv>\r\n                )}\r\n        </MapContainer>\r\n    ) \r\n}\r\n\r\nexport default Map","import React from 'react';\r\n\r\n\r\n// This component handles and formats the map tooltip info. \r\n// The props passed to this component should contain an object of the hovered object (from deck, info.object by default)\r\nconst MapTooltipContent = (props) => {\r\n    // destructure the object for cleaner formatting\r\n\r\n    const { properties, cases, deaths, // county data\r\n            testing_ccpt, testing_tcap, testing_wk_pos, testing // state data\r\n     } = props.content;\r\n\r\n    // get lengths of time series data for reference below\r\n    let caseN = cases && props.index;\r\n    let deathN = deaths && props.index;\r\n    let testingN = testing && props.index;\r\n\r\n    // conditional returns for combination of information\r\n    // this is not elegant but a bit more reliable than JSX conditional rendering\r\n    if (properties && cases && deaths && testing) { // State Feature\r\n        return (\r\n            <div>\r\n                <h3>\r\n                    {properties.NAME}\r\n                </h3>\r\n                <div>\r\n                    <hr />\r\n                    Cases: {cases[caseN]?.toLocaleString('en')}<br/>\r\n                    New Cases: {(cases[caseN]-cases[caseN-1])?.toLocaleString('en')}<br/>\r\n                    Deaths: {deaths[deathN]?.toLocaleString('en')}<br/>\r\n                    New Deaths: {(deaths[deathN]-deaths[deathN-1])?.toLocaleString('en')}<br/>\r\n                    Total Testing: {(testing[testingN])?.toLocaleString('en')}<br/>\r\n                    7-Day Positivity Rate: {(testing_wk_pos[testingN]*100)?.toFixed(2)}%<br/>\r\n                    7-Day Testing Capacity: {(testing_tcap[testingN])?.toFixed(2)}<br/>\r\n                    7-Day Confirmed Cases per Testing: {(testing_ccpt[testingN]*100)?.toFixed(2)}%<br/>\r\n                    Testing Criterion: {properties.criteria}<br/>\r\n                </div>\r\n            </div>\r\n        )\r\n    } else if (properties && cases && deaths){ // County Feature\r\n        return (\r\n            <div>\r\n                <h3>\r\n                    {properties.NAME} {properties.state_name && `, ${properties.state_name}`}\r\n                </h3>\r\n                <div>\r\n                    <hr />\r\n                    Cases: {cases[caseN]?.toLocaleString('en')}<br/>\r\n                    Deaths: {deaths[deathN]?.toLocaleString('en')}<br/>\r\n                    New Cases: {(cases[caseN]-cases[caseN-1])?.toLocaleString('en')}<br/>\r\n                    New Deaths: {(deaths[deathN]-deaths[deathN-1])?.toLocaleString('en')}<br/>\r\n                </div>\r\n            </div>\r\n        )\r\n    } else if (props.content['Hospital Type']) { // Hospital Feature\r\n        return (\r\n            <div>\r\n                <h3>{props.content['Name']}</h3>\r\n                <div>\r\n                    <hr />\r\n                    {props.content['Hospital Type']}<br/>\r\n                    {props.content.Address} <br />\r\n                    {props.content.Address_2 && `${props.content.Address_2}${<br/>}`}\r\n                    {props.content.City}, {props.content.State}<br/>\r\n                    {props.content.Zipcode}<br/>\r\n                </div>\r\n            </div>\r\n        )\r\n    } else if (props.content.testing_status) { // clinic feature\r\n        return (\r\n            <div>\r\n                <h3>{props.content.name}</h3>\r\n                <div>\r\n                    <hr />\r\n                    {props.content.address}<br/>\r\n                    {props.content.city},{props.content.st_abbr} <br />\r\n                    {props.content.phone}<br/><br/>\r\n                    {props.content.testing_status === 'Yes' ? 'This location offers COVID-19 testing.' : 'Currently, this location does not offer COVID-19 testing.'}<br/>\r\n                </div>\r\n            </div>\r\n        )\r\n    \r\n    } else {\r\n        return (\r\n            <div></div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default MapTooltipContent","import React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst NavItems = styled.ul`\r\n  @media (max-width:1024px){\r\n    display:none !important;\r\n  }\r\n`\r\nconst NavBar = () => {\r\n    return (\r\n        <div className=\"navbar\">\r\n            <div className=\"nav-logo\">\r\n              <img src={`${process.env.PUBLIC_URL}/favicon/android-icon-192x192.png`} style={{height: '30px', paddingRight: '5px'}} /><a href=\"index.html\">US COVID ATLAS </a>\r\n            </div>\r\n          <NavItems> \r\n            <li><a href=\"data.html\">DATA</a></li>\r\n            <li><a href=\"api.html\">API</a></li>\r\n            <li><a href=\"methods.html\">METHODS</a></li>\r\n            <li><a href=\"faq.html\">FAQ</a></li>\r\n            <li><a href=\"about.html\">INSIGHTS</a></li>\r\n            <li><a href=\"about.html\">ABOUT</a></li>\r\n            <li><a href=\"contact.html\">CONTACT</a></li>\r\n          </NavItems>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NavBar","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport { setNotification } from '../actions'\r\nimport { colors } from '../config'\r\n\r\nconst Notification = styled.div`\r\n    width: 300px;\r\n    max-width: 90vw;\r\n    position: fixed;\r\n    left: 50%;\r\n    top: 50%;\r\n    z-index: 15;\r\n    background: ${colors.gray};\r\n    color: ${colors.white};\r\n    padding: 0;\r\n    overflow: hidden;\r\n    border-radius: 4px;\r\n    padding:20px 30px 20px 20px;\r\n    -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);\r\n    box-shadow: 0 0 0 2px rgba(0,0,0,.1);\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    transform:translate(-50%, -50%);\r\n`\r\n\r\nconst CloseTutorial = styled.button`\r\n    position: absolute;\r\n    top: 12px;\r\n    right: 10px;\r\n    font-size: 200%;\r\n    cursor: pointer;\r\n    padding:0;\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    color:white;\r\n`\r\n\r\nconst NotificationBox = () => {\r\n    const dispatch = useDispatch();\r\n    const notification = useSelector(state => state.notification);\r\n\r\n    return (\r\n        notification && \r\n        <Notification>\r\n            {notification}\r\n            <CloseTutorial onClick={() => dispatch(setNotification(null))}>×</CloseTutorial>\r\n        </Notification>\r\n    )\r\n}\r\n\r\nexport default NotificationBox","import React, { useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormLabel from '@material-ui/core/FormLabel';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Select from '@material-ui/core/Select';\r\nimport Radio from '@material-ui/core/Radio';\r\nimport RadioGroup from '@material-ui/core/RadioGroup';\r\nimport Button from '@material-ui/core/Button';\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\r\n\r\nimport styled from 'styled-components';\r\n\r\nimport { colLookup, getArrayCSV, getGzipData } from '../utils';\r\nimport Tooltip from './tooltip';\r\nimport { StyledDropDown } from '../styled_components';\r\nimport { setVariableParams, setVariableName, setMapParams, setCurrentData, setPanelState, setNotification, storeMobilityData } from '../actions';\r\nimport { fixedScales, colorScales, dataPresets, legacyVariableOrder, colors } from '../config';\r\nimport { settings } from '../config/svg';\r\n\r\nconst VariablePanelContainer = styled.div`\r\n  position:fixed;\r\n  left:0;\r\n  top:50px;\r\n  height:auto;\r\n  min-height:calc(100vh - 50px);\r\n  min-width:200px;\r\n  background-color: ${colors.gray}fa;\r\n  box-shadow: 2px 0px 5px rgba(0,0,0,0.7);\r\n  padding:0;\r\n  box-sizing: border-box;\r\n  transition:250ms all;\r\n  font: 'Lato', sans-serif;\r\n  color:white;\r\n  z-index:50;\r\n  @media (max-width:1024px) {\r\n    min-width:50vw;\r\n  }  \r\n  @media (max-width:600px) {\r\n    width:100%;\r\n    display: ${props => props.otherPanels ? 'none' : 'initial'};\r\n  }\r\n  div.noteContainer {\r\n    position: absolute;\r\n    bottom:0;\r\n    left:0;\r\n    padding:20px;\r\n    box-sizing:border-box;\r\n    background:${colors.gray};\r\n    width:calc(100%);\r\n    box-shadow: 0px -5px 10px rgba(0,0,0,0.25);\r\n    a {  \r\n      color: ${colors.yellow};\r\n      -webkit-text-decoration: none;\r\n      text-decoration: none;\r\n      }\r\n    }\r\n  }\r\n  p.note {\r\n    font-family: 'Lato', sans-serif;\r\n    font-weight:300;\r\n    font-size:90%;\r\n  }\r\n  div.poweredByGeoda {\r\n    color:white;\r\n    width:100%;\r\n    text-align:center;\r\n    @media (max-height:900px){\r\n    }\r\n    a {\r\n      color:white;\r\n      margin:0 auto;\r\n      text-decoration: none;\r\n      letter-spacing: 2px;\r\n      font-size:75%;\r\n      img {\r\n        width:23px;\r\n        height:27px;\r\n        transform: translate(-50%,40%);\r\n      }\r\n    }\r\n  }\r\n  button#showHideLeft {\r\n    position:absolute;\r\n    left:95%;\r\n    top:20px;\r\n    width:40px;\r\n    height:40px;\r\n    box-sizing:border-box;\r\n    padding:0;\r\n    margin:0;\r\n    background-color: ${colors.gray};\r\n    box-shadow: 0px 0px 6px rgba(0,0,0,1);\r\n    outline:none;\r\n    border:none;\r\n    cursor: pointer;\r\n    transition:500ms all;\r\n    svg { \r\n      width:20px;\r\n      height:20px;\r\n      margin:10px 0 0 0;\r\n      @media (max-width:600px){\r\n        width:20px;\r\n        height:20px;\r\n        margin:5px;\r\n      }\r\n      fill:white;\r\n      transform:rotate(0deg);\r\n      transition:500ms all;\r\n      .cls-1 {\r\n        fill:none;\r\n        stroke-width:6px;\r\n        stroke:white;\r\n      }\r\n    }\r\n    :after {\r\n      opacity:0;\r\n      font-weight:bold;\r\n      content: 'Variables';\r\n      color:white;\r\n      position: relative;\r\n      right:-50px;\r\n      top:-22px;\r\n      transition:500ms all;\r\n      z-index:4;\r\n    }\r\n    @media (max-width:768px){\r\n      top:120px;\r\n    }\r\n    @media (max-width:600px) {\r\n      left:90%;\r\n      width:30px;\r\n      height:30px;\r\n      top:140px;\r\n      :after {\r\n        display:none;\r\n      }\r\n    }\r\n  }\r\n  button#showHideLeft.hidden {\r\n    left:100%;\r\n    svg {\r\n      transform:rotate(90deg);\r\n    }\r\n    :after {\r\n      opacity:1;\r\n    }\r\n  }\r\n`\r\nconst StyledButtonGroup = styled(ButtonGroup)`\r\n  color:white;\r\n  padding-bottom:20px;\r\n  .MuiButtonGroup-grouped {\r\n    color:white;\r\n    border-color:${colors.white}77;\r\n    &:hover {\r\n      border-color:white;\r\n    }\r\n    &.active {\r\n      background:white;\r\n      color:${colors.gray};\r\n    }\r\n  }\r\n`\r\n\r\nconst TwoUp = styled.div`\r\n  width:100%;\r\n  .MuiFormControl-root {\r\n    width:45%;\r\n    min-width:60px;\r\n    margin-right:5px;\r\n  }\r\n`\r\n\r\nconst ControlsContainer = styled.div`\r\n  max-height:74vh;\r\n  overflow-y:visible;\r\n  box-sizing:border-box;\r\n  padding:20px;\r\n\r\n  @media (max-height:1079px){\r\n    overflow-y:scroll;\r\n    padding:20px 20px 25vh 20px;\r\n  }\r\n  \r\n  @media (max-width:600px) {\r\n    width:100%;\r\n    padding:0 10px 25vh 10px;\r\n  }\r\n`\r\n\r\nconst ListSubheader = styled(MenuItem)`\r\n  font-variant: small-caps;\r\n  font-weight:800;\r\n`\r\n\r\nconst VariablePanel = (props) => {\r\n\r\n  const getGzipAndCentroids = async (gzipUrl, centroidsUrl) => {\r\n    Promise.all([\r\n        getGzipData(gzipUrl),\r\n        getArrayCSV(centroidsUrl)\r\n      ]).then(\r\n        values => dispatch(storeMobilityData({centroids: values[1], flows: values[0]}))\r\n    )\r\n  } \r\n\r\n  const dispatch = useDispatch();    \r\n\r\n  const { cols, currentData, currentVariable, dataParams,\r\n    mapParams, panelState, urlParams, storedMobilityData } = useSelector(state => state);\r\n\r\n  const PresetVariables = {\r\n    \"HEADER:cases\":{},\r\n    \"Confirmed Count\": {\r\n        numerator: 'cases',\r\n        nType: 'time-series',\r\n        nProperty: null,\r\n        denominator: 'properties',\r\n        dType: null,\r\n        dProperty: null,\r\n        dRange:null,\r\n        dIndex:null,\r\n        scale:1,\r\n        scale3D: 100\r\n    },\r\n    \"Confirmed Count per 100K Population\": {\r\n        numerator: 'cases',\r\n        nType: 'time-series',\r\n        nProperty: null,\r\n        denominator: 'properties',\r\n        dType: 'characteristic',\r\n        dProperty: 'population',\r\n        dRange:null,\r\n        dIndex:null,\r\n        scale:100000,\r\n        scale3D: 1000\r\n    },\r\n    \"Confirmed Count per Licensed Bed\": {\r\n        numerator: 'cases',\r\n        nType: 'time-series',\r\n        nProperty: null,\r\n        denominator: 'properties',\r\n        dType: 'characteristic',\r\n        dProperty: 'beds',\r\n        dRange:null,\r\n        dIndex:null,\r\n        scale:1,\r\n        scale3D: 100000\r\n    },\r\n    \"HEADER:deaths\":{},\r\n    \"Death Count\":{\r\n      numerator: 'deaths',\r\n      nType: 'time-series',\r\n      nProperty: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      scale3D: 10000\r\n        \r\n    }, \r\n    \"Death Count per 100K Population\":{\r\n      numerator: 'deaths',\r\n      nType: 'time-series',\r\n      nProperty: null,\r\n      denominator: 'properties',\r\n      dType: 'characteristic',\r\n      dProperty: 'population',\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:100000,\r\n      scale3D: 15000\r\n\r\n    },\r\n    \"Death Count / Confirmed Count\":{\r\n      numerator: 'deaths',\r\n      nType: 'time-series',\r\n      nProperty: null,\r\n      denominator: 'cases',\r\n      dType: 'time-series',\r\n      dProperty: null,\r\n      scale:1\r\n\r\n    },\r\n    \"HEADER:community health\":{},\r\n    \"Uninsured % (Community Health Factor)\":{\r\n      numerator: 'chr_health_factors',\r\n      nType: 'characteristic',\r\n      nProperty: colLookup(cols, currentData, 'chr_health_factors', 'UnInPrc'),\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      colorScale: 'uninsured',\r\n      scale3D: 15000\r\n\r\n    },\r\n    \"Over 65 Years % (Community Health Context)\":{\r\n      numerator: 'chr_health_context',\r\n      nType: 'characteristic',\r\n      nProperty: colLookup(cols, currentData, 'chr_health_context', 'Over65YearsPrc'),\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      colorScale: 'over65',\r\n      scale3D: 15000\r\n    },\r\n    \"Life expectancy (Length and Quality of Life)\":{\r\n      numerator: 'chr_life',\r\n      nType: 'characteristic',\r\n      nProperty: colLookup(cols, currentData, 'chr_life', 'LfExpRt'),\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      colorScale: 'lifeExp',\r\n      scale3D: 1000\r\n    }\r\n  }\r\n\r\n  const CountyVariables = {\r\n    \"HEADER:forecasting\":{},\r\n    \"Forecasting (5-Day Severity Index)\": {\r\n      numerator: 'predictions',\r\n      nType: 'characteristic',\r\n      nProperty: colLookup(cols, currentData, 'predictions', 'severity_index'),\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      colorScale: 'forecasting',\r\n      fixedScale: 'forecasting',\r\n      scale3D: 50000\r\n    }\r\n  }\r\n\r\n  const StateVariables = {\r\n    \"HEADER:testing\":{},\r\n    \"7 Day Testing Positivity Rate %\": {\r\n      numerator: 'testing_wk_pos',\r\n      nType: 'characteristic',\r\n      nProperty: null,\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      fixedScale: 'testing',\r\n      colorScale: 'testing',\r\n      scale3D: 10000000\r\n    },\r\n    \"7 Day Testing Capacity\": {\r\n      numerator: 'testing_tcap',\r\n      nType: 'characteristic',\r\n      nProperty: null,\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      fixedScale: 'testingCap',\r\n      colorScale: 'testingCap',\r\n      scale3D: 3000\r\n    }, \r\n    \"7 Day Confirmed Cases per Testing %\":{\r\n      numerator: 'testing_ccpt',\r\n      nType: 'characteristic',\r\n      nProperty: null,\r\n      nRange: null,\r\n      denominator: 'properties',\r\n      dType: null,\r\n      dProperty: null,\r\n      dRange:null,\r\n      dIndex:null,\r\n      scale:1,\r\n      fixedScale: 'testing',\r\n      colorScale: 'testing',\r\n      scale3D: 10000000\r\n    },\r\n    \"HEADER:cdc vaccination\":{},\r\n    \"Vaccinations Administered per 100K Population\": {\r\n        numerator: 'vaccinesAdmin',\r\n        nType: 'time-series',\r\n        nProperty: null,\r\n        denominator: 'properties',\r\n        dType: 'characteristic',\r\n        dProperty: 'population',\r\n        dRange:null,\r\n        dIndex:null,\r\n        scale:100000,\r\n        scale3D: 1000,\r\n        colorScale: 'vaccination',\r\n    },\r\n    \"Vaccinations Distributed per 100K Population\": {\r\n        numerator: 'vaccinesDist',\r\n        nType: 'time-series',\r\n        nProperty: null,\r\n        denominator: 'properties',\r\n        dType: 'characteristic',\r\n        dProperty: 'population',\r\n        dRange:null,\r\n        dIndex:null,\r\n        scale:100000,\r\n        scale3D: 1000,\r\n        colorScale: 'vaccination',\r\n    },\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (urlParams.var) handleVariable({event: { target: { \r\n      value: legacyVariableOrder[urlParams.src||'county_usfacts.geojson'][urlParams.var]\r\n      }}})\r\n  },[])\r\n\r\n  useEffect(() => {\r\n    if (mapParams.overlay === \"mobility-county\" && storedMobilityData === {}) {\r\n      getGzipAndCentroids(\r\n        `${process.env.PUBLIC_URL}/gz/county_lex_2020-11-28.csv.gz`,\r\n        `${process.env.PUBLIC_URL}/csv/county_centroids.csv`\r\n      )\r\n      console.log('loaded mobility data')\r\n    }\r\n  },[mapParams.overlay])\r\n\r\n  const handleVariable = (event) => {\r\n    let variable = event.target.value;\r\n    let tempParams = PresetVariables[variable] || CountyVariables[variable] || StateVariables[variable] || null;\r\n    \r\n    // dispatch(variableChange({\r\n    //   variable,\r\n    //   mapParams: {\r\n    //     customScale: tempParams.colorScale || '', \r\n    //     fixedScale: tempParams.fixedScale || null\r\n    //   },\r\n    //   variableParams: {\r\n    //     ...tempParams\r\n    //   }\r\n    // }))\r\n\r\n    // transitioning from a static characteristic (null time range)\r\n    // to a time-series data set \r\n    if (dataParams.nType === 'characteristic' && tempParams.nType === 'time-series') tempParams.nRange = 7;\r\n\r\n    // if time series over time series, coordinate index and range\r\n    if (tempParams.nType === 'time-series' && tempParams.dType === 'time-series') {\r\n      tempParams.dIndex = dataParams.nIndex;\r\n      tempParams.dRange = tempParams.nRange || dataParams.nRange;\r\n    }\r\n\r\n\r\n    dispatch(setVariableParams({...tempParams}))\r\n    dispatch(setVariableName(variable))\r\n    dispatch(setMapParams({customScale: tempParams.colorScale || '', fixedScale: tempParams.fixedScale || null}))\r\n  };\r\n\r\n  const handleDataSource = (event) => {\r\n    let newDataSet = event.target.value\r\n    if ((newDataSet.includes(\"state\") && CountyVariables.hasOwnProperty(currentVariable))||(newDataSet.includes(\"county\") && StateVariables.hasOwnProperty(currentVariable))) {\r\n\r\n      // dispatch(resetVariable({\r\n      //   mapParams: {\r\n      //     customScale: '', \r\n      //     fixedScale: null\r\n      //   },\r\n      //   variableParams: {\r\n      //     ...PresetVariables[\"Confirmed Count per 100K Population\"]\r\n      //   },\r\n      //   variable: \"Confirmed Count per 100K Population\",\r\n      //   notification: `${dataPresets[newDataSet].plainName} data do not have ${currentVariable}. The Atlas will default to Confirmed Cases Per 100k People.`\r\n      // }))\r\n\r\n      dispatch(setMapParams({customScale: '', fixedScale: null}))\r\n      dispatch(setVariableParams({...PresetVariables[\"Confirmed Count per 100K Population\"]}))\r\n      dispatch(setVariableName(\"Confirmed Count per 100K Population\"))\r\n      dispatch(setNotification(`${dataPresets[newDataSet].plainName} data do not have ${currentVariable}. The Atlas will default to Confirmed Cases Per 100k People.`))  \r\n\r\n      setTimeout(() => {dispatch(setCurrentData(newDataSet))}, 250);\r\n      setTimeout(() => {dispatch(setNotification(null))},10000);\r\n    } else {\r\n      dispatch(setCurrentData(newDataSet)); \r\n    }\r\n  };\r\n\r\n\r\n  const handleMapType = (event, newValue) => {\r\n    let nBins = newValue === 'hinge15_breaks' ? 6 : 8\r\n    if (newValue === 'lisa') {\r\n      dispatch(\r\n        setMapParams(\r\n          {\r\n            mapType: newValue,\r\n            nBins: 4,\r\n            bins: fixedScales[newValue],\r\n            colorScale: colorScales[newValue]\r\n          }\r\n        )\r\n      )\r\n    } else {\r\n      dispatch(\r\n        setMapParams(\r\n          {\r\n            nBins,\r\n            mapType: newValue\r\n          }\r\n        )\r\n      )\r\n    }\r\n  }\r\n\r\n  const handleMapOverlay = (event) =>{\r\n    dispatch(\r\n      setMapParams(\r\n        {\r\n          overlay: event.target.value\r\n        }\r\n      )\r\n    )\r\n  }\r\n\r\n  const handleMapResource = (event) =>{\r\n    dispatch(\r\n      setMapParams(\r\n        {\r\n          resource: event.target.value\r\n        }\r\n      )\r\n    )\r\n  }\r\n\r\n  const handleOpenClose = () => {\r\n    if (panelState.variables) {\r\n      dispatch(setPanelState({variables:false}))\r\n    } else {\r\n      dispatch(setPanelState({variables:true}))\r\n    }\r\n  }\r\n\r\n  const handleVizTypeButton = (vizType) => {\r\n    if (mapParams.vizType !== vizType) {\r\n      dispatch(setMapParams({vizType}))\r\n    }\r\n  }\r\n  return (\r\n    <VariablePanelContainer style={{transform: (panelState.variables ? '' : 'translateX(-100%)')}} otherPanels={panelState.info}>\r\n      <ControlsContainer>\r\n        <h2>Data Sources &amp;<br/> Map Variables</h2>\r\n        <StyledDropDown>\r\n          <InputLabel htmlFor=\"data-select\">Data Source</InputLabel>\r\n          <Select  \r\n            id=\"data-select\"\r\n            value={currentData}\r\n            onChange={handleDataSource}\r\n          >\r\n            \r\n          <ListSubheader disabled>county data</ListSubheader>\r\n            <MenuItem value={'county_1p3a.geojson'} key={'county_1p3a.geojson'}>1point3acres (County)</MenuItem>\r\n            <MenuItem value={'county_nyt.geojson'} key={'county_nyt.geojson'}>New York Times (County)</MenuItem>\r\n            <MenuItem value={'county_usfacts.geojson'} key={'county_usfacts.geojson'}>USA Facts (County)</MenuItem>\r\n            <MenuItem value={'cdc.geojson'} key={'cdc.geojson'}>CDC (County)</MenuItem>\r\n          <ListSubheader disabled>state data</ListSubheader>\r\n            <MenuItem value={'state_1p3a.geojson'} key={'state_1p3a.geojson'}>1point3acres (State)</MenuItem>\r\n            <MenuItem value={'state_nyt.geojson'} key={'state_nyt.geojson'}>New York Times (State)</MenuItem>\r\n            {/* <MenuItem value={'state_usafacts.geojson'} key={'state_usafacts.geojson'}>USA Facts (State)</MenuItem> */}\r\n          {/* <ListSubheader disabled>global data</ListSubheader>\r\n            <MenuItem value={'global_jhu.geojson'} key={'global_jhu.geojson'}>John Hopkins University (Global)</MenuItem> */}\r\n            \r\n          </Select>\r\n        </StyledDropDown>\r\n        <br />\r\n        <StyledDropDown>\r\n          <InputLabel htmlFor=\"numerator-select\">Select Variable</InputLabel>\r\n          <Select \r\n            value={currentVariable} \r\n            id=\"numerator-select\"\r\n            onChange={handleVariable}\r\n          >\r\n            {\r\n              Object.keys(PresetVariables).map((variable) => {\r\n                if (variable.split(':')[0]===\"HEADER\") {\r\n                  return <ListSubheader key={variable.split(':')[1]} disabled>{variable.split(':')[1]}</ListSubheader>\r\n                } else {\r\n                  return <MenuItem value={variable} key={variable}>{variable}</MenuItem> \r\n                }\r\n              })\r\n            }\r\n            \r\n            {\r\n              currentData.includes(\"county\") && Object.keys(CountyVariables).map((variable) => {\r\n                if (variable.split(':')[0]===\"HEADER\") {\r\n                  return <ListSubheader key={variable.split(':')[1]} disabled>{variable.split(':')[1]}</ListSubheader>\r\n                } else {\r\n                  return <MenuItem value={variable} key={variable}>{variable}</MenuItem> \r\n                }\r\n              })\r\n            }\r\n            \r\n            {\r\n              (currentData.includes(\"state\")||currentData.includes(\"cdc\")) && Object.keys(StateVariables).map((variable) => {\r\n                if (variable.split(':')[0]===\"HEADER\") {\r\n                  return <ListSubheader key={variable.split(':')[1]} disabled>{variable.split(':')[1]}</ListSubheader>\r\n                } else {\r\n                  return <MenuItem value={variable} key={variable}>{variable}</MenuItem> \r\n                }\r\n              })\r\n            }\r\n          </Select>\r\n        </StyledDropDown>\r\n        <br/>\r\n        <StyledDropDown component=\"Radio\" >\r\n          <FormLabel component=\"legend\">Map Type</FormLabel>\r\n          <RadioGroup \r\n            aria-label=\"maptype\" \r\n            name=\"maptype1\" \r\n            onChange={handleMapType} \r\n            value={mapParams.mapType}\r\n            className=\"radioContainer\"\r\n            >\r\n            <FormControlLabel \r\n              value=\"natural_breaks\" \r\n              key=\"natural_breaks\" \r\n              control={<Radio />} \r\n              label=\"Natural Breaks\"\r\n            /><Tooltip id=\"NaturalBreaks\"/>\r\n            <br/>\r\n            <FormControlLabel \r\n              value=\"hinge15_breaks\" \r\n              key=\"hinge15_breaks\" \r\n              control={<Radio />} \r\n              label=\"Box Map\" \r\n            /><Tooltip id=\"BoxMap\"/>\r\n            <br/>\r\n            <FormControlLabel \r\n              value=\"lisa\" \r\n              key=\"lisa\" \r\n              control={<Radio />} \r\n              label=\"Hotspot\" \r\n            /><Tooltip id=\"Hotspot\"/>\r\n            <br/>\r\n          </RadioGroup>\r\n        </StyledDropDown>\r\n        <p>Visualization Type</p>\r\n        <StyledButtonGroup color=\"primary\" aria-label=\"text button group\">\r\n          <Button className={mapParams.vizType === '2D' ? 'active' : ''} data-val=\"2D\" key=\"2D-btn\" onClick={() => handleVizTypeButton('2D')}>2D</Button>\r\n          <Button className={mapParams.vizType === '3D' ? 'active' : ''} data-val=\"3D\" key=\"3D-btn\" onClick={() => handleVizTypeButton('3D')}>3D</Button>\r\n          <Button className={mapParams.vizType === 'cartogram' ? 'active' : ''} data-val=\"cartogram\" key=\"cartogram-btn\" onClick={() => handleVizTypeButton('cartogram')}>Cartogram</Button>\r\n        </StyledButtonGroup>\r\n        <br/>\r\n        <TwoUp>\r\n          <StyledDropDown>\r\n            <InputLabel htmlFor=\"overlay-select\">Overlay</InputLabel>\r\n            <Select  \r\n              id=\"overlay-select\"\r\n              value={mapParams.overlay}\r\n              onChange={handleMapOverlay}\r\n            >\r\n              <MenuItem value=\"\" key={'None'}>None</MenuItem> \r\n              <MenuItem value={'native_american_reservations'} key={'native_american_reservations'}>Native American Reservations</MenuItem>\r\n              <MenuItem value={'segregated_cities'} key={'segregated_cities'}>Hypersegregated Cities<Tooltip id=\"Hypersegregated\"/></MenuItem>\r\n              <MenuItem value={'blackbelt'} key={'blackbelt'}>Black Belt Counties<Tooltip id=\"BlackBelt\" /></MenuItem>\r\n              <MenuItem value={'uscongress-districts'} key={'uscongress-districts'}>US Congressional Districts <Tooltip id=\"USCongress\" /></MenuItem>\r\n              {/* <MenuItem value={'mobility-county'} key={'mobility-county'}>Mobility Flows (County) WARNING BIG DATA</MenuItem> */}\r\n            </Select>\r\n          </StyledDropDown>\r\n          <StyledDropDown>\r\n            <InputLabel htmlFor=\"resource-select\">Resource</InputLabel>\r\n            <Select  \r\n              id=\"resource-select\"\r\n              value={mapParams.resource}\r\n              onChange={handleMapResource}\r\n            >\r\n              <MenuItem value=\"\" key='None'>None</MenuItem> \r\n              <MenuItem value={'clinics_hospitals'} key={'variable1'}>Clinics and Hospitals</MenuItem>\r\n              <MenuItem value={'clinics'} key={'variable2'}>Clinics</MenuItem>\r\n              <MenuItem value={'hospitals'} key={'variable3'}>Hospitals</MenuItem>\r\n            </Select>\r\n          </StyledDropDown>\r\n        </TwoUp>        \r\n      </ControlsContainer>\r\n      <div className=\"noteContainer\">\r\n        <h3>Help us improve the Atlas!</h3>\r\n        <p>\r\n          <a href=\"https://docs.google.com/forms/d/e/1FAIpQLSf0KdYeVyvwnz0RLnZijY3kdyFe1SwXukPc--a1HFPE1NRxyw/viewform?usp=sf_link\" target=\"_blank\" rel=\"noopener noreferrer\">Take the Atlas v2 survey here </a>\r\n          or share your thoughts at <a href=\"mailto:contact@theuscovidatlas.org\" target=\"_blank\" rel=\"noopener noreferrer\">contact@theuscovidatlas.org.</a>\r\n        </p>\r\n        <hr></hr>\r\n        <p className=\"note\">\r\n          Data is updated with freshest available data at 3pm CST daily, at minimum. \r\n          In case of data discrepancy, local health departments are considered most accurate as per CDC recommendations. \r\n          More information on <a href=\"data.html\">data</a>, <a href=\"methods.html\">methods</a>, \r\n          and <a href=\"FAQ.html\">FAQ</a> at main site.\r\n        </p>\r\n        <div className=\"poweredByGeoda\">\r\n            <a href=\"https://geodacenter.github.io\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              <img src={`${process.env.PUBLIC_URL}/assets/img/geoda-logo.png`} />\r\n              POWERED BY GEODA\r\n            </a>\r\n        </div> \r\n      </div>\r\n      <button onClick={handleOpenClose} id=\"showHideLeft\" className={panelState.variables ? 'active' : 'hidden'}>{settings}</button>\r\n\r\n    </VariablePanelContainer>\r\n  );\r\n}\r\n\r\nexport default VariablePanel;","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport styled from 'styled-components';\r\nimport Popper from '@material-ui/core/Popper';\r\n\r\nimport { tooltipInfo, colors } from '../config';\r\nimport { setAnchorEl } from '../actions';\r\n\r\nconst TooltipContentDiv = styled(Popper)`\r\n    z-index:10000;\r\n    max-width:200px;\r\n    background:none;\r\n    padding:0;\r\n    margin:0;\r\n    pointer-events: none;\r\n    div.tooltipContentContainer {\r\n        background:black;\r\n        padding:1px 10px;\r\n        margin:0;\r\n        borderRadius: 4px;\r\n        color:white;\r\n        // transform:translateX(65%);\r\n        box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2), 0px 8px 10px 1px rgba(0,0,0,0.14), 0px 3px 14px 2px rgba(0,0,0,0.12);\r\n        pointer-events: all;\r\n        a {\r\n            color: ${colors.yellow};\r\n            text-decoration:none;\r\n        }\r\n    }\r\n`\r\n\r\nconst Popover = () => {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const anchorEl = useSelector(state => state.anchorEl);\r\n    const open = Boolean(anchorEl);\r\n    const id = open ? 'simple-popper' : undefined;\r\n    \r\n    const handleMouseOver = (event) => {\r\n        dispatch(setAnchorEl(anchorEl))\r\n    }\r\n\r\n    const handleMouseLeave = () => {\r\n        dispatch(setAnchorEl(null))\r\n    }\r\n    \r\n    return (\r\n        <TooltipContentDiv \r\n            id={id} \r\n            open={open} \r\n            anchorEl={anchorEl}\r\n            disablePortal={false}\r\n            modifiers={{\r\n                flip: {\r\n                enabled: true,\r\n                },\r\n                preventOverflow: {\r\n                enabled: true,\r\n                boundariesElement: 'window',\r\n                }\r\n            }}\r\n            onMouseEnter={handleMouseOver} \r\n            onMouseLeave={handleMouseLeave}\r\n            >\r\n            <div className=\"tooltipContentContainer\">\r\n                {anchorEl && tooltipInfo[anchorEl.id]}\r\n            </div>\r\n        </TooltipContentDiv>\r\n    )\r\n}\r\n\r\nexport default Popover","import React, {useState} from 'react';\r\nimport styled from 'styled-components';\r\nimport { colors } from '../config';\r\n\r\nconst PreloaderContainer = styled.div`\r\n    position:fixed;\r\n    width:100%;\r\n    height:100%;\r\n    z-index:500;\r\n    top:0;\r\n    left:0;\r\n    background:${colors.gray};\r\n    transition: 500ms opacity;\r\n    img {\r\n        width:100px;\r\n        height:86px;\r\n        position:fixed;\r\n        left:50%;\r\n        top:50%;\r\n        transform:translate(-50%, -50%);\r\n    }\r\n    @keyframes fade {\r\n        0% {fill-opacity:1};\r\n        50% {fill-opacity:0.25};\r\n        100% {fill-opacity:1};\r\n    }\r\n    &.fadeOut {\r\n        opacity:0;\r\n        pointer-events:none;\r\n    }\r\n`;\r\n\r\nconst Preloader = ( props ) => {\r\n    const [isHidden, setIsHidden] = useState(false);\r\n\r\n    if (props.loaded) {\r\n        setTimeout(() => {\r\n            setIsHidden(true)\r\n        }, 500)\r\n    }\r\n\r\n    return (\r\n        <PreloaderContainer className={props.loaded ? 'fadeOut' : ''} style={{display: (isHidden ? 'none' : 'initial')}} id=\"preloaderContainer\">\r\n            <img src={`${process.env.PUBLIC_URL}/assets/img/preloader.gif`} alt=\"Preloader\" />\r\n        </PreloaderContainer>\r\n    );\r\n};\r\n\r\nexport default Preloader;","import React, { useState, useEffect } from 'react';\r\nimport {useSelector} from 'react-redux'\r\nimport styled from 'styled-components'\r\n\r\nconst ResizeButton = styled.button`\r\n    position:absolute;\r\n    right:5px;\r\n    bottom:10px;\r\n    background:none;\r\n    outline:none;\r\n    border:none;\r\n    transform: rotate(90deg);\r\n    cursor:nw-resize;\r\n    display:${props => props.notScaleable ? 'none' : 'initial'};\r\n`\r\n\r\nconst Scaleable = (props) => {\r\n    \r\n    const [width, setWidth] = useState(props.defaultWidth);\r\n    const [height, setHeight] = useState(props.defaultHeight);\r\n    const [currXYPos, setCurrXYPos] = useState(false);\r\n\r\n    const listener = (e) => {\r\n        setWidth(prevWidth => prevWidth+e.movementX)\r\n        setHeight(prevHeight => prevHeight+e.movementY)\r\n    }\r\n\r\n    const touchListener = (e) => {\r\n        setWidth(prev => (e?.targetTouches[0]?.clientX-currXYPos[0]) || prev)\r\n        setHeight(prev => (e?.targetTouches[0]?.clientY-currXYPos[1]) || prev)\r\n    }\r\n\r\n    const removeListener = () => {\r\n        window.removeEventListener('mousemove', listener)\r\n        window.removeEventListener('mouseup', removeListener)\r\n    }\r\n\r\n    const removeTouchListener = () => {\r\n        window.removeEventListener('touchmove', touchListener);\r\n        window.removeEventListener('touchend', removeTouchListener);\r\n    }\r\n    \r\n    const handleDown = () => {\r\n        window.addEventListener('mousemove', listener)\r\n        window.addEventListener('mouseup', removeListener)\r\n    }\r\n\r\n    const handleTouch = (e) => {\r\n        setCurrXYPos([+e.target.parentNode.parentNode.parentNode.style.left.slice(0,-2), +e.target.parentNode.parentNode.parentNode.style.top.slice(0,-2)])\r\n        window.addEventListener('touchmove', touchListener)\r\n        window.addEventListener('touchend', removeTouchListener)\r\n    }\r\n    \r\n    const open = useSelector(state => state.panelState[props.title]);\r\n\r\n    useEffect(() => {\r\n        setWidth(props.defaultWidth)\r\n        setHeight(props.defaultHeight)\r\n    }, [open, props.defaultHeight, props.defaultWidth])\r\n\r\n    return (\r\n        <div style={{width: width, height: height, minHeight: props.minHeight, minWidth: props.minWidth}}>\r\n            {props.content}\r\n            <ResizeButton \r\n                id=\"resize\"\r\n                notScaleable={props.notScaleable}\r\n                onMouseDown={handleDown}\r\n                onTouchStart={handleTouch}\r\n                style={{zIndex:10}}\r\n            >\r\n                <svg height='20px' width='20px'  fill=\"white\" viewBox=\"0 0 8.4666667 8.4666667\" x=\"0px\" y=\"0px\"><g transform=\"translate(0,-288.53333)\"><path d=\"m 5.5562495,289.59166 v 0.52916 h 0.94878 l -1.665015,1.66502 0.3741367,0.37414 1.665015,-1.66502 v 0.94878 h 0.5291667 v -1.85208 z m -2.303735,3.78168 -1.665015,1.66501 v -0.94878 H 1.0583328 v 1.85209 h 1.8520834 v -0.52917 h -0.94878 l 1.665015,-1.66501 z\"></path></g></svg>\r\n            </ResizeButton>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Scaleable;","// this components houses the slider, legend, and bottom dock chart\r\nimport React from 'react';\r\n\r\nimport styled from 'styled-components';\r\n\r\nimport { DateSlider, Dock } from '../components';\r\nimport { colors } from '../config';\r\n\r\n// Styled components\r\nconst TopDrawer = styled.div`\r\n    position: fixed;\r\n    top:50px;\r\n    left:calc(50vw - 300px);\r\n    background:${colors.gray};\r\n    width:90vw;\r\n    max-width: 600px;\r\n    box-sizing: border-box;\r\n    padding:0;\r\n    margin:0;\r\n    box-shadow: 0px 0px 5px rgba(0,0,0,0.7);\r\n    border-radius:0 0 0.5vh 0.5vh ;\r\n    transition:250ms all;\r\n    hr {\r\n        opacity:0.5;\r\n    }\r\n    div.MuiGrid-item {\r\n        padding:0;\r\n    }\r\n    \r\n    @media (max-width:768px){\r\n        width:100%;\r\n        max-width:100%;\r\n        left:0;\r\n        transform:none;\r\n    }\r\n    @media (max-width:750px) and (orientation: landscape) {\r\n        // bottom all the way down for landscape phone\r\n    }\r\n`\r\nconst TopPanel = () => {\r\n    \r\n    return (\r\n        <TopDrawer>\r\n            <DateSlider />\r\n            <Dock />\r\n        </TopDrawer>\r\n    )\r\n\r\n}\r\n\r\nexport default TopPanel","import React, { useEffect, useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport * as jsgeoda from 'jsgeoda';\r\n\r\n// Helper and Utility functions //\r\n// first row: data loading\r\n// second row: data parsing for specific outputs\r\n// third row: data accessing\r\nimport { \r\n  getParseCSV, mergeData, getColumns, findDates, loadJson,\r\n  getDataForBins, getDataForCharts, getDataForLisa, \r\n  getLisaValues, getVarId, getCartogramValues } from './utils';\r\n\r\n// Actions -- Redux state manipulation following Flux architecture //\r\n// first row: data storage\r\n// second row: data and metadata handling \r\n// third row: map and variable parameters\r\nimport { \r\n  dataLoad, dataLoadExisting, storeLisaValues, storeCartogramData,\r\n  setCentroids, setMapParams, setNewBins, setUrlParams, setPanelState } from './actions';\r\n\r\nimport { Map, NavBar, VariablePanel, BottomPanel,  TopPanel, Preloader,\r\n  DataPanel, MainLineChart, Scaleable, Draggable, InfoBox,\r\n  NotificationBox, Popover } from './components';  \r\n\r\nimport { colorScales, fixedScales, dataPresets, \r\n  legacyOverlayOrder, legacyResourceOrder, legacySourceOrder } from './config';\r\n\r\n// Main function, App. This function does 2 things:\r\n// 1: App manages the majority of the side effects when the state changes.\r\n//    This takes the form of React's UseEffect hook, which listens\r\n//    for changes in the state and then performs the functions in the hook.\r\n//    App listens for different state changes and then calculates the relevant\r\n//    side effects (such as binning calculations and GeoDa functions, column parsing)\r\n//    and then dispatches new data to the store.\r\n// 2: App assembles all of the components together and sends Props down\r\n//    (as of 12/1 only Preloader uses props and is a higher order component)\r\n\r\n\r\nfunction App() {\r\n\r\n  // static variables for floating panel sizing\r\n  let [ defaultX, defaultXLong, defaultY, defaultWidth, defaultWidthLong, defaultHeight,\r\n    minHeight, minWidth] = window.innerWidth <= 1024 ? \r\n    [window.innerWidth*.1, window.innerWidth*.1, window.innerHeight*.25, window.innerWidth*.8, window.innerWidth*.8, window.innerHeight*.4, window.innerHeight*.2, window.innerWidth*.5] : \r\n    [window.innerWidth-400, window.innerWidth-575, 75, 300, 450, 300, 200, 200]\r\n\r\n\r\n  // These selectors access different pieces of the store. While App mainly\r\n  // dispatches to the store, we need checks to make sure side effects\r\n  // are OK to trigger. Issues arise with missing data, columns, etc.\r\n  const {storedData, storedGeojson, storedLisaData, storedCartogramData,\r\n    currentData, cols, dates, mapParams, dataParams, \r\n    startDateIndex, mapLoaded } = useSelector(state => state);\r\n  \r\n  // gda_proxy is the WebGeoda proxy class. Generally, having a non-serializable\r\n  // data in the state is poor for performance, but the App component state only\r\n  // contains gda_proxy.\r\n  const [gda_proxy, set_gda_proxy] = useState(null);\r\n  const dispatch = useDispatch();  \r\n  \r\n  // // Dispatch helper functions for side effects and data handling\r\n  // Get centroid data for cartogram\r\n  // const getCentroids = (geojson, gda_proxy) =>  dispatch(setCentroids(gda_proxy.GetCentroids(geojson), geojson))\r\n  \r\n  // Main data loader\r\n  // This functions asynchronously accesses the Geojson data and CSVs\r\n  //   then performs a join and loads the data into the store\r\n  const loadData = async (params, gda_proxy) => {\r\n    // destructure parameters\r\n    const { geojson, csvs, joinCols, tableNames, accumulate } = params\r\n\r\n    // promise all data fetching - CSV and Json\r\n    const csvPromises = csvs.map(csv => \r\n      getParseCSV(\r\n        `${process.env.PUBLIC_URL}/csv/${csv}.csv`, \r\n        joinCols[1], \r\n        accumulate.includes(csv)\r\n      ).then(result => {return result}))\r\n\r\n    Promise.all([\r\n      loadJson(`${process.env.PUBLIC_URL}/geojson/${geojson}`, gda_proxy).then(result => {return result}),\r\n      ...csvPromises\r\n    ]).then(values => {\r\n      // store geojson lookup table\r\n      // merge data and get results\r\n      let tempData = mergeData(values[0]['data'], joinCols[0], values.slice(1,), tableNames, joinCols[1]);\r\n      let ColNames = getColumns(values.slice(1,), tableNames);\r\n      let tempDates = findDates(ColNames[tableNames[0]]);\r\n      let chartData = getDataForCharts(tempData,'cases',tempDates[1],tempDates[0]);\r\n      let binData = getDataForBins(tempData, {...dataParams, nIndex: null});\r\n      // calculate breaks\r\n      let nb = gda_proxy.custom_breaks(\r\n        geojson, \r\n        mapParams.mapType,\r\n        mapParams.nBins,\r\n        null, \r\n        binData\r\n      );\r\n\r\n      // store data, data name, and column names\r\n      dispatch(\r\n        dataLoad({\r\n          storeData: {\r\n            data: tempData, \r\n            name: geojson\r\n          },\r\n          currentData: geojson,\r\n          columnNames: {\r\n            data: ColNames,\r\n            name: geojson\r\n          },\r\n          storeGeojson: {\r\n            data: values[0]['geoidIndex'],\r\n            name: geojson\r\n          },\r\n          chartData: chartData,\r\n          mapParams: {\r\n            bins: {\r\n              bins: mapParams.mapType === \"natural_breaks\" ? nb.bins : ['Lower Outlier','< 25%','25-50%','50-75%','>75%','Upper Outlier'],\r\n              breaks: [-Math.pow(10, 12), ...nb.breaks.slice(1,-1), Math.pow(10, 12)]\r\n            },\r\n            colorScale: colorScales[mapParams.customScale || mapParams.mapType]\r\n          },\r\n          dates: {\r\n            data:tempDates[0],\r\n            name:geojson\r\n          },\r\n          currDate: tempDates[0][tempDates.length-1],\r\n          startDateIndex: tempDates[1],\r\n          variableParams: {\r\n            nIndex: ColNames['cases'].length-1,\r\n            binIndex: ColNames['cases'].length-1\r\n          }\r\n        })\r\n      )\r\n    })\r\n  }\r\n\r\n  const updateBins = () => {\r\n    if (gda_proxy !== null && storedData.hasOwnProperty(currentData) && mapParams.mapType !== \"lisa\" && mapParams.binMode !== 'dynamic'){\r\n      if (mapParams.fixedScale === null || mapParams.mapType !== 'natural_breaks') {\r\n        let nb = gda_proxy.custom_breaks(\r\n          currentData, \r\n          mapParams.mapType, \r\n          mapParams.nBins, \r\n          null, \r\n          getDataForBins( storedData[currentData], {...dataParams, nIndex: null} )\r\n        )\r\n        \r\n        dispatch(\r\n          setMapParams({\r\n            bins: {\r\n              bins: mapParams.mapType === 'natural_breaks' ? nb.bins : ['Lower Outlier','< 25%','25-50%','50-75%','>75%','Upper Outlier'],\r\n              breaks: [-Math.pow(10, 12), ...nb.breaks.slice(1,-1), Math.pow(10, 12)]\r\n            },\r\n            colorScale: mapParams.mapType === 'natural_breaks' ? colorScales[mapParams.customScale || mapParams.mapType] : colorScales[mapParams.mapType || mapParams.customScale]\r\n          })\r\n        )\r\n      } else {\r\n        dispatch(\r\n          setMapParams({\r\n            bins: fixedScales[mapParams.fixedScale],\r\n            colorScale: colorScales[mapParams.fixedScale]\r\n          })\r\n        )\r\n      }\r\n    }\r\n  }\r\n  // After runtime is initialized, this loads in gda_proxy to the state\r\n  // TODO: Recompile WebGeoda and load it into a worker\r\n  useEffect(() => {\r\n    \r\n    let paramsDict = {}; \r\n    const queryString = window.location.search;\r\n    const urlParams = new URLSearchParams(queryString);\r\n    for (const [key, value] of urlParams ) { paramsDict[key] = value; }\r\n\r\n    dispatch(\r\n      setUrlParams({\r\n        currentData: paramsDict['src'] ? legacySourceOrder[decodeURI(paramsDict['src'])] : 'county_1p3a.geojson',\r\n        paramsDict,\r\n        mapParams: {\r\n          vizType: paramsDict['cartogram'] ? 'cartogram' : paramsDict['3d'] ? '3D' : '2D',\r\n          mapType: paramsDict['mthd'] ? decodeURI(paramsDict['mthd']) : 'natural_breaks',\r\n          overlay: paramsDict['ovr'] !== undefined ? legacyOverlayOrder[paramsDict['ovr']] : '',\r\n          resource: paramsDict['res'] !== undefined ? legacyResourceOrder[paramsDict['res']] : ''\r\n        }\r\n      })\r\n    );\r\n\r\n    if (window.innerWidth <= 1024) {\r\n      dispatch(setPanelState({\r\n        variables:false,\r\n        info:false,\r\n        tutorial:false,\r\n        lineChart: false\r\n      }))\r\n    }\r\n\r\n    const newGeoda = async () => {\r\n      let geoda = await jsgeoda.New();\r\n      set_gda_proxy(geoda);\r\n    }\r\n\r\n    newGeoda()\r\n  },[])\r\n\r\n\r\n  // On initial load and after gda_proxy has been initialized, this loads in the default data sets (USA Facts)\r\n  // Otherwise, this side-effect loads the selected data.\r\n  // Each conditions checks to make sure gda_proxy is working.\r\n  useEffect(() => {\r\n    if (gda_proxy === null) {\r\n      return;\r\n    } else if (storedData === {}) {\r\n      loadData(\r\n        dataPresets[currentData],\r\n        gda_proxy\r\n      )\r\n    } else if (storedData[currentData] === undefined) {\r\n      loadData(\r\n        dataPresets[currentData],\r\n        gda_proxy\r\n      )\r\n    } else if (cols[currentData] !== undefined) {\r\n      let dateIndex = findDates(cols[currentData][dataPresets[currentData]['tableNames'][0]])[1];\r\n      let dataLength = cols[currentData][dataPresets[currentData]['tableNames'][0]].length;\r\n\r\n      dispatch(\r\n        dataLoadExisting({\r\n          currDate: dates[currentData][dates[currentData].length-1],\r\n          startDateIndex: dateIndex,\r\n          variableParams: {\r\n            nIndex: dataLength-1,\r\n            binIndex: dataLength-1\r\n          },\r\n          chartData: getDataForCharts(storedData[currentData],'cases',dateIndex,dates[currentData]),\r\n        })\r\n      )\r\n      \r\n      updateBins();\r\n    }\r\n  },[gda_proxy, currentData])\r\n\r\n  // This listens for gda_proxy events for LISA and Cartogram calculations\r\n  // Both of these are computationally heavy.\r\n  useEffect(() => {\r\n    if (gda_proxy !== null && mapParams.mapType === \"lisa\"){\r\n      let tempId = getVarId(currentData, dataParams)\r\n      if (!(storedLisaData.hasOwnProperty(tempId))) {\r\n        dispatch(\r\n          storeLisaValues(\r\n            getLisaValues(\r\n              gda_proxy, \r\n              currentData, \r\n              getDataForLisa(\r\n                storedData[currentData], \r\n                dataParams,\r\n                storedGeojson[currentData].indexOrder\r\n              )\r\n            ),\r\n            tempId\r\n          )\r\n        )\r\n      }\r\n    } \r\n    if (gda_proxy !== null && mapParams.vizType === 'cartogram'){\r\n      let tempId = getVarId(currentData, dataParams)\r\n      if (!(storedCartogramData.hasOwnProperty(tempId))) {\r\n        dispatch(\r\n          storeCartogramData(\r\n            getCartogramValues(\r\n              gda_proxy, \r\n              currentData, \r\n              getDataForLisa( storedData[currentData], dataParams, storedGeojson[currentData].indexOrder )\r\n            ),\r\n            tempId\r\n          )\r\n        )\r\n      }\r\n    }\r\n  }, [dataParams, mapParams])\r\n\r\n  // Trigger on parameter change for metric values\r\n  // Gets bins and sets map parameters\r\n  useEffect(() => {\r\n    updateBins();\r\n  }, [currentData, dataParams.numerator, dataParams.nProperty, \r\n    dataParams.nRange, dataParams.denominator, dataParams.dProperty,\r\n    dataParams.dRange, dataParams.scale, mapParams.mapType]\r\n  )\r\n\r\n  // trigger on date (index) change for dynamic binning\r\n  useEffect(() => {\r\n    if (gda_proxy !== null && mapParams.binMode === 'dynamic' && currentData !== '' && mapParams.mapType !== 'lisa'){\r\n      let nb = gda_proxy.custom_breaks(\r\n        currentData, \r\n        mapParams.mapType,\r\n        mapParams.nBins,\r\n        null, \r\n        getDataForBins( storedData[currentData], dataParams ), \r\n      );\r\n      dispatch(\r\n        setNewBins({\r\n          mapParams: {\r\n            bins: {\r\n              bins: mapParams.mapType === \"natural_breaks\" ? nb.bins : ['Lower Outlier','< 25%','25-50%','50-75%','>75%','Upper Outlier'],\r\n              breaks: [-Math.pow(10, 12), ...nb.breaks.slice(1,-1), Math.pow(10, 12)]\r\n            },\r\n            colorScale: colorScales[mapParams.customScale || mapParams.mapType]\r\n          },\r\n          variableParams: {\r\n            binIndex: dataParams.nIndex, \r\n          }\r\n        })\r\n      )\r\n    }\r\n\r\n  }, [dataParams.nIndex, dataParams.dIndex, mapParams.binMode])\r\n  \r\n\r\n  // default width handlers on resize\r\n  useEffect(() => {\r\n    [ defaultX, defaultXLong, defaultY, defaultWidth, defaultWidthLong, defaultHeight,\r\n      minHeight, minWidth] = window.innerWidth <= 1024 ? \r\n      [window.innerWidth*.1, window.innerWidth*.1, window.innerHeight*.25, window.innerWidth*.8, window.innerWidth*.8, window.innerHeight*.4, window.innerHeight*.2, window.innerWidth*.5] : \r\n      [window.innerWidth-400, window.innerWidth-575, 75, 300, 450, 300, 200, 200]\r\n  }, [window.innerHeight, window.innerWidth])\r\n  // const dragHandlers = {onStart: this.onStart, onStop: this.onStop};\r\n\r\n  const renderLoader = () => <p>Loading</p>;\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Preloader loaded={mapLoaded} />\r\n      <NavBar />\r\n      <header className=\"App-header\" style={{position:'fixed', left: '20vw', top:'100px', zIndex:10}}>\r\n        {/* <button onClick={() => console.log(getDataForBins( storedData[currentData], {...dataParams, nIndex: null} ))}>data for bins</button> */}\r\n        {/* <button onClick={() => console.log(dataParams)}>data params</button> */}\r\n      </header>\r\n      <div id=\"mainContainer\">\r\n        <Map />\r\n        <TopPanel />\r\n        <BottomPanel />\r\n        <VariablePanel />\r\n        <DataPanel />\r\n        <Popover /> \r\n        <NotificationBox />  \r\n        <Draggable \r\n          z={9}\r\n          defaultX={defaultXLong}\r\n          defaultY={defaultY}\r\n          title=\"lineChart\"\r\n          content={\r\n          <Scaleable \r\n            content={\r\n              <MainLineChart />\r\n            } \r\n            title=\"lineChart\"\r\n            defaultWidth={defaultWidthLong}\r\n            defaultHeight={defaultHeight}\r\n            minHeight={minHeight}\r\n            minWidth={minWidth} />\r\n        }/>      \r\n        <Draggable \r\n          z={10}\r\n          defaultX={defaultX}\r\n          defaultY={defaultY+20}\r\n          title=\"tutorial\"\r\n          content={\r\n          <Scaleable \r\n            notScaleable={true}\r\n            content={\r\n              <InfoBox />\r\n            } \r\n            title=\"tutorial\"\r\n            defaultWidth={defaultWidth}\r\n            defaultHeight={defaultHeight}\r\n            minHeight={minHeight}\r\n            minWidth={minWidth} />\r\n        }/>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","export const INITIAL_STATE = {\r\n  geodaProxy: null,\r\n  storedData: {},\r\n  storedGeojson: {},\r\n  storedLisaData: {},\r\n  storedCartogramData: {},\r\n  storedCSV: {},\r\n  storedMobilityData: {},\r\n  cols: {},\r\n  currentData: 'county_1p3a.geojson',\r\n  chartData: [{}],\r\n  selectionKeys: [],\r\n  selectionIndex: [],\r\n  centroids: {},\r\n  dates: {},\r\n  currDate: '',\r\n  currDateIndex: '',\r\n  startDateIndex: '',\r\n  currentVariable: 'Confirmed Count per 100K Population',\r\n  currentMethod: 'natural_breaks',\r\n  currentOverlay: '',\r\n  currentResource: '',\r\n  dataParams: {\r\n    numerator: 'cases',\r\n    nType: 'time-series',\r\n    nProperty: null,\r\n    nRange: 7,\r\n    nIndex:null,\r\n    denominator: 'properties',\r\n    dType: 'characteristic',\r\n    dProperty: 'population',\r\n    dRange:null,\r\n    dIndex:null,\r\n    scale:100000,\r\n    binIndex: '',\r\n    scale3D: 1000\r\n  },\r\n  mapParams: {\r\n    mapType: 'natural_breaks',\r\n    bins: {\r\n      bins: [],\r\n      breaks: []\r\n    },\r\n    binMode: '',\r\n    fixedScale: null,\r\n    nBins: 8,\r\n    vizType: '2D',\r\n    activeGeoid: '',\r\n    overlay: '',\r\n    resource: '',\r\n    colorScale: [\r\n      [240,240,240],\r\n      [255,255,204],\r\n      [255,237,160],\r\n      [254,217,118],\r\n      [254,178,76],\r\n      [253,141,60],\r\n      [252,78,42],\r\n      [227,26,28],\r\n      [177,0,38],\r\n    ],\r\n  },\r\n  panelState: {\r\n    variables:true,\r\n    info:false,\r\n    tutorial:true,\r\n    lineChart:false,\r\n  },\r\n  storedRange: null,\r\n  currentGeoid: '',\r\n  sidebarData: {},\r\n  anchorEl: null,\r\n  mapLoaded: false,\r\n  notification: null,\r\n  urlParams: {}\r\n};","import { INITIAL_STATE } from '../constants/defaults';\r\n\r\nvar reducer = (state = INITIAL_STATE, action) => {\r\n    switch(action.type) {\r\n        case 'DATA_LOAD':\r\n            // main new data loading reducer\r\n            // I: Destructure payload (load) object\r\n            let { storeData, currentData, columnNames, \r\n                storeGeojson, chartData, mapParams, \r\n                dates, currDate, startDateIndex, variableParams} = action.payload.load;\r\n\r\n            // II: Create copies of existing state objects.\r\n            // This is necessary to avoid mutating the state\r\n            let [\r\n                    dataObj, colDataObj, geoDataObj, \r\n                    mapParamsDataObj, datesDataObj, \r\n                    variableParamsDataObj, panelsDataObj\r\n                ] = [\r\n                    {\r\n                    ...state.storedData\r\n                }, {\r\n                    ...state.cols\r\n                }, {\r\n                    ...state.storedGeojson,\r\n                }, {\r\n                    ...state.mapParams,\r\n                    ...mapParams\r\n                }, {\r\n                    ...state.dates\r\n                }, {\r\n                    ...state.dataParams,\r\n                    ...variableParams\r\n                }, {\r\n                    ...state.panelState,\r\n                    info: false\r\n                }];\r\n\r\n                dataObj[storeData.name] = storeData.data;\r\n                colDataObj[columnNames.name] = columnNames.data;\r\n                geoDataObj[storeGeojson.name] = storeGeojson.data;\r\n                datesDataObj[dates.name] = dates.data;\r\n            return {\r\n                ...state,\r\n                storedData: dataObj,\r\n                cols: colDataObj,\r\n                storedGeojson: geoDataObj,\r\n                mapParams: mapParamsDataObj,\r\n                dates: datesDataObj,\r\n                dataParams: variableParamsDataObj,\r\n                currentData,\r\n                selectionKeys: [],\r\n                selectionIndex: [],\r\n                chartData,\r\n                currDate,\r\n                startDateIndex,\r\n                sidebarData: {},\r\n                panelState: panelsDataObj\r\n\r\n            };\r\n        case 'DATA_LOAD_EXISTING':\r\n            \r\n            let [ variableParamsExDataObj, panelsExDataObj ] \r\n                = [\r\n                    {\r\n                    ...state.dataParams,\r\n                    ...action.payload.load.variableParams\r\n                }, {\r\n                    ...state.panelState,\r\n                    info: false\r\n                }];\r\n\r\n            return {\r\n                ...state,\r\n                dataParams: variableParamsExDataObj,\r\n                chartData: action.payload.load.chartData,\r\n                currDate: action.payload.load.currDate,\r\n                startDateIndex: action.payload.load.startDateIndex,\r\n                sidebarData: {},\r\n                selectionKeys: [],\r\n                selectionIndex: [],\r\n                panelState: panelsExDataObj\r\n\r\n            };\r\n        case 'SET_NEW_BINS':\r\n            let [ binsVariableParams, binsMapParams] \r\n                = [{\r\n                    ...state.dataParams,\r\n                    ...action.payload.load.variableParams\r\n                },{\r\n                    ...state.mapParams,\r\n                    ...action.payload.load.mapParams\r\n                }]\r\n            return {\r\n                ...state,\r\n                dataParams: binsVariableParams,\r\n                mapParams: binsMapParams\r\n            }\r\n        case 'SET_GEOID': \r\n            return {\r\n                ...state,\r\n                currentGeoid: action.payload.geoid\r\n            };\r\n        case 'SET_STORED_DATA':\r\n            let obj = {\r\n                ...state.storedData,\r\n            }\r\n            obj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                storedData: obj\r\n            };\r\n        case 'SET_STORED_GEOJSON':\r\n            let geojsonObj = {\r\n                ...state.storedGeojson,\r\n            }\r\n            geojsonObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                storedGeojson: geojsonObj\r\n            };\r\n        case 'SET_STORED_LISA_DATA':\r\n            let lisaObj = {\r\n                ...state.storedLisaData,\r\n            }\r\n            lisaObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                storedLisaData: lisaObj\r\n            };\r\n        case 'SET_STORED_CARTOGRAM_DATA':\r\n            let cartoObj = {\r\n                ...state.storedCartogramData,\r\n            }\r\n            cartoObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                storedCartogramData: cartoObj\r\n            };\r\n        case 'SET_STORED_MOBILITY_DATA':\r\n            return {\r\n                ...state,\r\n                storedMobilityData: action.payload.data\r\n            }\r\n        case 'SET_CENTROIDS':\r\n            let centroidsObj = {\r\n                ...state.centroids,\r\n            }\r\n            centroidsObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                centroids: centroidsObj\r\n            };\r\n        case 'SET_CURRENT_DATA':\r\n            return {\r\n                ...state,\r\n                currentData: action.payload.data\r\n            }\r\n        case 'SET_GEODA_PROXY':\r\n            return {\r\n                ...state,\r\n                geodaProxy: action.payload.proxy\r\n            }\r\n        case 'SET_DATES':\r\n            let datesObj = {\r\n                ...state.dates\r\n            }\r\n            datesObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                dates: datesObj\r\n            }\r\n        case 'SET_DATA_FUNCTION':\r\n            return {\r\n                ...state,\r\n                currentDataFn: action.payload.fn\r\n            }\r\n        case 'SET_COLUMN_NAMES':\r\n            let colObj = {\r\n                ...state.cols\r\n            }\r\n            colObj[action.payload.name] = action.payload.data\r\n            return {\r\n                ...state,\r\n                cols: colObj\r\n            }\r\n        case 'SET_CURR_DATE':\r\n            return {\r\n                ...state,\r\n                currDate: action.payload.date\r\n            }\r\n        case 'SET_DATE_INDEX':\r\n            return {\r\n                ...state,\r\n                currDateIndex: action.payload.index\r\n            }\r\n        case 'SET_START_DATE_INDEX':\r\n            return {\r\n                ...state,\r\n                startDateIndex: action.payload.index\r\n            }\r\n        case 'SET_BINS':\r\n            let binsObj = {};\r\n            binsObj['bins'] =  action.payload.bins;\r\n            binsObj['breaks'] =  action.payload.breaks;\r\n            return {\r\n                ...state,\r\n                bins: binsObj\r\n            }\r\n        case 'SET_3D':\r\n            return {\r\n                ...state,\r\n                use3D: !state.use3D\r\n            }\r\n        case 'SET_DATA_SIDEBAR':\r\n            return {\r\n                ...state,\r\n                sidebarData: action.payload.data\r\n            }\r\n        case 'INCREMENT_DATE':\r\n            let dateObj = {\r\n                ...state.dataParams\r\n            }\r\n            if (action.payload.index+state.dataParams.nIndex > state.dates[state.currentData].length) {\r\n                dateObj.nIndex = state.startDateIndex;\r\n                dateObj.dIndex = state.startDateIndex;\r\n                return {\r\n                    ...state,\r\n                    dataParams:dateObj\r\n                }\r\n            } else {\r\n                dateObj.nIndex = dateObj.nIndex + action.payload.index;\r\n                dateObj.dIndex = dateObj.dIndex + action.payload.index;\r\n                return {\r\n                    ...state,\r\n                    dataParams:dateObj\r\n                }\r\n            }\r\n        case 'SET_VARIABLE_PARAMS':\r\n            let paramObj = {\r\n                ...state.dataParams,\r\n                ...action.payload.params\r\n            }\r\n\r\n            if (paramObj.nType === 'time-series' && paramObj.nIndex === null) {\r\n                paramObj.nIndex = state.storedIndex;\r\n                paramObj.nRange = state.storedRange;\r\n            }\r\n            if (paramObj.dType === 'time-series' && paramObj.dIndex === null) {\r\n                paramObj.dIndex = state.storedIndex;\r\n                paramObj.dRange = state.storedRange;\r\n            }\r\n            if (paramObj.nType === 'characteristic' && state.dataParams.nType === 'time-series') {\r\n                return {\r\n                    ...state,\r\n                    storedIndex: state.dataParams.nIndex,\r\n                    storedRange: state.dataParams.nRange,\r\n                    dataParams: paramObj,\r\n                }\r\n            } else {\r\n                return {\r\n                    ...state,\r\n                    dataParams: paramObj \r\n                }\r\n            }\r\n        case 'SET_MAP_PARAMS':\r\n            let mapParamObj = {\r\n                ...state.mapParams,\r\n                ...action.payload.params\r\n            }\r\n            return {\r\n                ...state,\r\n                mapParams: mapParamObj \r\n            }\r\n        case 'SET_PANELS':\r\n            let panelsObj = {\r\n                ...state.panelState,\r\n                ...action.payload.params\r\n            }\r\n            return {\r\n                ...state,\r\n                panelState: panelsObj \r\n            }\r\n        case 'SET_VARIABLE_NAME':\r\n            return {\r\n                ...state,\r\n                currentVariable: action.payload.name\r\n            }\r\n        case 'SET_SELECTION_DATA':\r\n            return {\r\n                ...state,\r\n                chartData: action.payload.data.values,\r\n                selectionKeys: [action.payload.data.name],\r\n                selectionIndex: [action.payload.data.index]\r\n            }\r\n        case 'APPEND_SELECTION_DATA':\r\n            let appendedChartData = state.chartData;\r\n            let countCol = action.payload.data.name + ' Daily Count'\r\n            let sumCol = action.payload.data.name + ' Total Cases'\r\n\r\n            for (let i=0; i<appendedChartData.length;i++) {\r\n                appendedChartData[i][countCol] = action.payload.data.values[i][countCol]\r\n                appendedChartData[i][sumCol] = action.payload.data.values[i][sumCol]\r\n            }\r\n\r\n            let appendedSelectionNames = [action.payload.data.name, ...state.selectionKeys];\r\n            let appendedSelectionIndex = [action.payload.data.index, ...state.selectionIndex];\r\n\r\n            return {\r\n                ...state,\r\n                chartData: appendedChartData,\r\n                selectionKeys: appendedSelectionNames,\r\n                selectionIndex: appendedSelectionIndex,\r\n            }\r\n        case 'REMOVE_SELECTION_DATA':\r\n            let removedSelectionNames = [...state.selectionKeys]\r\n            let tempRemoveIndex = removedSelectionNames.indexOf(action.payload.data.name)\r\n            removedSelectionNames.splice(tempRemoveIndex, 1)\r\n\r\n            let removedSelectionIndex = [...state.selectionIndex]\r\n            tempRemoveIndex = removedSelectionIndex.indexOf(action.payload.data.index)\r\n            removedSelectionIndex.splice(tempRemoveIndex, 1)\r\n\r\n\r\n            return {\r\n                ...state,\r\n                selectionKeys: removedSelectionNames,\r\n                selectionIndex: removedSelectionIndex,\r\n            }\r\n        case 'SET_ANCHOR_EL':\r\n            return {\r\n                ...state,\r\n                anchorEl: action.payload.anchorEl\r\n            }\r\n        case 'SET_MAP_LOADED':\r\n            return {\r\n                ...state,\r\n                mapLoaded: action.payload.loaded\r\n            }\r\n        case 'SET_NOTIFICATION':\r\n            return {\r\n                ...state,\r\n                notification: action.payload.info\r\n            }\r\n        case 'SET_URL_PARAMS':\r\n            let urlMapParamsObj = {\r\n                ...state.mapParams,\r\n                ...action.payload.load.mapParams\r\n            }\r\n            return {\r\n                ...state,\r\n                currentData: action.payload.load.currentData,\r\n                urlParams: action.payload.load.paramsDict,\r\n                mapParams: urlMapParamsObj\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default reducer;","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === \"localhost\" ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === \"[::1]\" ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener(\"load\", () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            \"This web app is being served cache-first by a service \" +\r\n              \"worker. To learn more, visit https://goo.gl/SC7cgQ\"\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === \"installed\") {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log(\"New content is available; please refresh.\");\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log(\"Content is cached for offline use.\");\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error(\"Error during service worker registration:\", error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get(\"content-type\").indexOf(\"javascript\") === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        \"No internet connection found. App is running in offline mode.\"\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if (\"serviceWorker\" in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport { createStore} from 'redux';\r\nimport reducer from './reducers';\r\nimport { Provider } from 'react-redux';\r\nimport './index.css';\r\nimport './mapbox.css';\r\nimport WebFont from 'webfontloader';\r\nimport registerServiceWorker from \"./registerServiceWorker\";\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n);\r\n\r\n\r\nWebFont.load({\r\n  google: {\r\n    families: ['Lato:300,400,700,900', 'Playfair Display:ital', 'sans-serif']\r\n  }\r\n});\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n\r\nregisterServiceWorker();\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals"],"sourceRoot":""}